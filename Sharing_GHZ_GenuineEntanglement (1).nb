(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1303548,      35410]
NotebookOptionsPosition[   1289679,      35003]
NotebookOutlinePosition[   1290201,      35022]
CellTagsIndexPosition[   1290158,      35019]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Svelitchny", " ", "inequality"}], "*)"}], 
  RowBox[{"(", 
   RowBox[{"1", "SDI"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.772498109410095*^9, 3.772498118192129*^9}, {
  3.786950390488312*^9, 3.7869503994395742`*^9}, {3.789200524996521*^9, 
  3.789200530300755*^9}},
 ExpressionUUID -> "62343cd9-2110-427c-8685-447c02a8cbfb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "1"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.772446638561953*^9, 3.772446646056519*^9}},
 ExpressionUUID -> "68bb99e2-ea09-453a-b951-640b269cda59"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z31", "[", 
    RowBox[{"k3_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]1", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]1"}], ")"}], "\[Sigma]0"}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"x1", "[", 
        RowBox[{"i1", ",", "a1"}], "]"}], ",", 
       RowBox[{"y2", "[", 
        RowBox[{"j2", ",", "b1"}], "]"}], ",", 
       RowBox[{"z31", "[", 
        RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ".", "\[Rho]GHZ"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k3_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c1", "*", 
      RowBox[{"P", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Cq", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
    RowBox[{"Cq", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
    RowBox[{"Cq", "[", 
     RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.772249304786038*^9, 3.772249354497417*^9}, {
   3.77224949108958*^9, 3.7722495229535418`*^9}, {3.772249629057231*^9, 
   3.772249703745123*^9}, {3.7722498511526957`*^9, 3.7722499324246893`*^9}, {
   3.772250062745041*^9, 3.772250215826823*^9}, {3.772250732542162*^9, 
   3.772250769421821*^9}, {3.772250822806221*^9, 3.772251074295411*^9}, {
   3.7722511125279703`*^9, 3.772251121807487*^9}, {3.7722670603525257`*^9, 
   3.7722670859434032`*^9}, {3.772267914142321*^9, 3.772267916862372*^9}, {
   3.7722681477508593`*^9, 3.772268160286553*^9}, {3.772268281246937*^9, 
   3.7722683946062183`*^9}, {3.772270190310521*^9, 3.772270191852511*^9}, {
   3.772270281151112*^9, 3.772270358164688*^9}, {3.7722709870442057`*^9, 
   3.772271001203815*^9}, 3.772271458947505*^9, {3.7722720106598167`*^9, 
   3.7722720242355423`*^9}, 3.772273528346916*^9, {3.77227456708317*^9, 
   3.77227457745658*^9}, {3.77227585425636*^9, 3.772275855120398*^9}, {
   3.7722831618567123`*^9, 3.772283241096567*^9}, 3.772364438973338*^9, {
   3.7723692103922586`*^9, 3.7723692410165443`*^9}, {3.772376986154726*^9, 
   3.772377036306695*^9}, {3.7724367623101463`*^9, 3.7724367996877413`*^9}, {
   3.772438526534863*^9, 3.772438621567161*^9}, {3.7869366561363287`*^9, 
   3.786936731824226*^9}, {3.788417100149597*^9, 3.788417109273864*^9}, {
   3.788417141873987*^9, 3.788417157526743*^9}, 3.789126879739934*^9, {
   3.789201548282918*^9, 3.789201555521261*^9}},
 ExpressionUUID -> "e60da0c8-8f0d-4206-acc6-20a034d815bf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cq", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cq", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cq", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cq", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cq", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cq", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cq", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cq", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]31", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "1", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.772277240367087*^9, 3.772277241176442*^9}, {
   3.772277272472238*^9, 3.772277280256024*^9}, 3.772369044610169*^9, {
   3.772369074812305*^9, 3.772369076572365*^9}, {3.786936760375462*^9, 
   3.786936777080893*^9}, {3.786936857082547*^9, 3.786936864739764*^9}, {
   3.7869372995448647`*^9, 3.7869374655866127`*^9}, {3.7869375246943913`*^9, 
   3.7869375328124237`*^9}, {3.786937614399789*^9, 3.786937616230981*^9}, {
   3.786937744835943*^9, 3.7869377936489067`*^9}, {3.786937860480073*^9, 
   3.7869378720870333`*^9}, {3.7869382189377413`*^9, 3.786938233143304*^9}, {
   3.7884172004007883`*^9, 3.788417262642941*^9}, {3.7884173258049994`*^9, 
   3.788417340982079*^9}, {3.788417371630183*^9, 3.7884173763712473`*^9}, {
   3.7884174144023027`*^9, 3.7884175139503098`*^9}, {3.788417599472311*^9, 
   3.788417641833292*^9}, 3.7891249524594307`*^9, {3.789125414867772*^9, 
   3.789125415262849*^9}, 3.7891254590347633`*^9, {3.7891254954153013`*^9, 
   3.7891255679578743`*^9}, {3.789125600690076*^9, 3.7891256742064247`*^9}, 
   3.789125723586081*^9, {3.789126036463284*^9, 3.7891260406674147`*^9}, {
   3.789126084822382*^9, 3.789126086361705*^9}, {3.7891263922814217`*^9, 
   3.7891264173935013`*^9}, {3.7891264564149637`*^9, 3.789126481940578*^9}, {
   3.789126560224777*^9, 3.78912659171522*^9}, {3.789126623020281*^9, 
   3.7891266716356773`*^9}, {3.789126738566307*^9, 3.789126739858264*^9}},
 ExpressionUUID -> "72619116-c849-4150-959d-c9025bb50b20"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.6568518553143985`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[Rule]", 
      "1.5701282288428478`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[Rule]", "1.570791570870994`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[Rule]", 
      "1.5700080193588806`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[Rule]", 
      "3.1408019996483345`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7869376193427753`*^9, 3.7869377977922277`*^9, 3.7869378737268877`*^9, {
   3.786938224727763*^9, 3.786938238293248*^9}, 3.7884031881151342`*^9, 
   3.7884173438397503`*^9, 3.7884173775846767`*^9, {3.7884174313312798`*^9, 
   3.788417495331128*^9}, 3.788417534648202*^9, 3.788417643671256*^9, 
   3.7885048378626757`*^9, 3.789125387229253*^9, 3.78912546075771*^9, 
   3.789125574100071*^9, 3.789125607708239*^9, 3.789125675707131*^9, {
   3.789126048503737*^9, 3.789126069934043*^9}, 3.7891264201665487`*^9, 
   3.789126505499166*^9, 3.789126677814377*^9, 3.789126766603627*^9, 
   3.7891268750137377`*^9, 3.789201568155346*^9},
 ExpressionUUID -> "0a8b65b1-09b9-40e2-becc-b722bc064a3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "1.570796311143975`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "1.570796311143975`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "1.570796311143975`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "3.14159262938204`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cq", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cq", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cq", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cq", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cq", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cq", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cq", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cq", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.772271102181653*^9, 3.7722712123236637`*^9}, {
   3.7722712431075087`*^9, 3.772271330403552*^9}, {3.772271360748274*^9, 
   3.772271370994335*^9}, 3.772271442557098*^9, {3.772438684015664*^9, 
   3.772438690015732*^9}, {3.78693815054286*^9, 3.786938206805768*^9}, {
   3.786949964473905*^9, 3.786950003655738*^9}, 3.788417705662813*^9, 
   3.7885048466603117`*^9, {3.7891268104201307`*^9, 3.789126857756481*^9}},
 ExpressionUUID -> "c053c7ca-5ab4-4774-a120-25593424b786"],

Cell[BoxData["5.656854249492378`"], "Output",
 CellChangeTimes->{{3.772271317019206*^9, 3.772271371608739*^9}, {
   3.7722714444306726`*^9, 3.7722714614577713`*^9}, {3.772377052184189*^9, 
   3.7723770678275757`*^9}, {3.7724386759228153`*^9, 
   3.7724386916198997`*^9}, {3.786938212130825*^9, 3.78693824175529*^9}, {
   3.786949974138298*^9, 3.786950004386189*^9}, 3.788403195265222*^9, 
   3.788417707637377*^9, 3.788504848582254*^9, 3.789126909962224*^9, 
   3.7892015724814463`*^9},
 ExpressionUUID -> "4a396a1c-1d3c-49fb-852b-3a3419c56a53"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"2", "/", 
   RowBox[{"(", 
    RowBox[{"4", 
     SqrtBox["2"]}], ")"}]}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.789201360531335*^9, 3.789201398305584*^9}, {
  3.789894051859336*^9, 3.7898940534995747`*^9}}],

Cell[BoxData["0.35355339059327373`"], "Output",
 CellChangeTimes->{{3.7892013709455233`*^9, 3.789201399290103*^9}, 
   3.789894054629108*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "2", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.772446609960565*^9, 
  3.77244663048814*^9}},ExpressionUUID->"3f249075-4a36-4214-9bcf-\
23cb9f7f6769"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k3_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7724396794898357`*^9, 3.7724397060260468`*^9}, {
  3.772440724815703*^9, 3.772440742543221*^9}, {3.7724409586980553`*^9, 
  3.77244096752039*^9}, {3.772444178684898*^9, 3.772444211812797*^9}, {
  3.772444537327029*^9, 3.7724445533573008`*^9}, {3.772444588189095*^9, 
  3.772444606004141*^9}, {3.772444671189715*^9, 3.772444702020938*^9}, {
  3.772444995707638*^9, 3.7724450008014936`*^9}, {3.7724453428234167`*^9, 
  3.772445360766842*^9}, {3.772445426351858*^9, 3.7724454327582607`*^9}},
 ExpressionUUID -> "2e644b95-b627-4079-adb2-1073c02aa249"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.77228212089924*^9, 3.7722822685852947`*^9}, {
  3.772282331266062*^9, 3.7722823318570957`*^9}, {3.772283463545506*^9, 
  3.77228349209052*^9}, {3.772283973641814*^9, 3.772283974411016*^9}},
 ExpressionUUID -> "b91787a4-d4c2-4ce5-8b44-c015bd8a8408"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]2", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]2"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c2_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}], ".", 
        RowBox[{"\[Rho]C", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
         "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq1", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k3_", ",", "k32_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c2", "*", 
      RowBox[{"P1", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k3", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c2"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k32_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq1", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "k32"}], "]"}], "+", 
      RowBox[{"Cq1", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "k32"}], "]"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7722839012647943`*^9, 3.772283977561111*^9}, {
   3.772284048121008*^9, 3.772284054048564*^9}, {3.772284087168202*^9, 
   3.772284088034628*^9}, {3.772284118360495*^9, 3.7722842019765167`*^9}, {
   3.772284253521983*^9, 3.7722843123126793`*^9}, {3.7722843547692547`*^9, 
   3.772284497593048*^9}, {3.7722845668810177`*^9, 3.772284648655345*^9}, {
   3.772284698048359*^9, 3.7722847759044867`*^9}, {3.772285010010169*^9, 
   3.772285045658825*^9}, {3.7722850761293716`*^9, 3.7722850960199213`*^9}, 
   3.772285178523724*^9, {3.77236447619662*^9, 3.7723645043822403`*^9}, {
   3.772364551064343*^9, 3.772364556213101*^9}, {3.772364601277505*^9, 
   3.772364614932653*^9}, {3.772364721701075*^9, 3.772364745892701*^9}, {
   3.7723654726780863`*^9, 3.7723656214619417`*^9}, 3.772365682158434*^9, {
   3.772368149215102*^9, 3.772368149564683*^9}, {3.772368990526123*^9, 
   3.772369009502626*^9}, {3.772369152968285*^9, 3.772369191208866*^9}, {
   3.772369270426837*^9, 3.7723692825048933`*^9}, {3.772370920799974*^9, 
   3.772370991798862*^9}, {3.772371046990074*^9, 3.772371068092149*^9}, {
   3.772371621786759*^9, 3.772371624106864*^9}, {3.772371947539008*^9, 
   3.772372102130176*^9}, {3.772376543946974*^9, 3.772376565306912*^9}, {
   3.772376674553438*^9, 3.772376690540468*^9}, {3.77237673847546*^9, 
   3.7723767616748953`*^9}, {3.772376828676401*^9, 3.772376910123201*^9}, {
   3.772436966608683*^9, 3.772436991934647*^9}, {3.772437088384615*^9, 
   3.7724371779271383`*^9}, {3.772437263415668*^9, 3.772437271287508*^9}, {
   3.772438707944784*^9, 3.7724389669530373`*^9}, {3.7724389991700687`*^9, 
   3.7724390125135593`*^9}, {3.7724393895462713`*^9, 3.772439398305973*^9}, {
   3.772439675603006*^9, 3.7724397014515657`*^9}, {3.7724397922900877`*^9, 
   3.772439795707053*^9}, 3.77244017684429*^9, {3.772440377162609*^9, 
   3.7724404581790733`*^9}, {3.7724455967282953`*^9, 3.772445640254805*^9}},
 ExpressionUUID -> "7955b6a1-3ecc-4f17-8df8-6064c711ff32"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   RowBox[{"(", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"2", 
       SqrtBox["2"]}], ")"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "1.570796311143975`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "1.570796311143975`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "1.570796311143975`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "3.14159262938204`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"(", 
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cqa", "[", 
         RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
        RowBox[{"Cqa", "[", 
         RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
        RowBox[{"Cqa", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
        RowBox[{"Cqa", "[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cqa", "[", 
         RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
        RowBox[{"Cqa", "[", 
         RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
        RowBox[{"Cqa", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
        RowBox[{"Cqa", "[", 
         RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.772364525316143*^9, 3.77236452609298*^9}, {
   3.772372396937315*^9, 3.772372415001383*^9}, 3.77237311796066*^9, {
   3.7723737007755613`*^9, 3.7723737188240967`*^9}, {3.7723737525118113`*^9, 
   3.772373756559065*^9}, {3.772374940164611*^9, 3.7723749406118917`*^9}, {
   3.772375107172915*^9, 3.772375113276558*^9}, {3.772375341936801*^9, 
   3.772375342736553*^9}, {3.772375380288937*^9, 3.772375390719099*^9}, {
   3.772375893528729*^9, 3.7723759026335583`*^9}, {3.772376296394185*^9, 
   3.7723763437138243`*^9}, {3.7723763970667267`*^9, 3.772376404770289*^9}, {
   3.772377406392981*^9, 3.772377416216053*^9}, {3.772377466377136*^9, 
   3.772377490000616*^9}, {3.772377650720331*^9, 3.772377652744091*^9}, {
   3.7724405909234343`*^9, 3.772440591298102*^9}, {3.7724463631857977`*^9, 
   3.772446363385128*^9}, {3.772446401881209*^9, 3.7724464062492533`*^9}, {
   3.772446499817471*^9, 3.772446502425023*^9}, 3.786951480919549*^9, {
   3.786951537191986*^9, 3.786951538009397*^9}, 3.788417740188807*^9, {
   3.788417773965372*^9, 3.788417790324458*^9}, {3.7885048672307796`*^9, 
   3.7885048691674833`*^9}, {3.788505178119609*^9, 3.788505197999449*^9}, {
   3.7891276527324142`*^9, 3.789127692981007*^9}, {3.7891277362071657`*^9, 
   3.789127787406282*^9}, {3.789201412777628*^9, 3.789201424288886*^9}},
 ExpressionUUID -> "0125a8ee-e2ea-4440-9c38-93c8958d717e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]32", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]32", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]32", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]32", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]32", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]32", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]32", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]32", "[", "1", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.772372354097027*^9, 3.77237236233624*^9}, {
   3.772372443194384*^9, 3.772372474312592*^9}, {3.7723731354007673`*^9, 
   3.772373151055459*^9}, {3.7723732098316793`*^9, 3.772373229199974*^9}, {
   3.772375054196787*^9, 3.772375060108384*^9}, {3.772375288094521*^9, 
   3.77237529634181*^9}, {3.7869515679472923`*^9, 3.78695160437245*^9}, 
   3.7891278076069603`*^9},
 ExpressionUUID -> "10b86dda-618e-4330-8d42-45d0e7c462f8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.474175855161144`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]32", "[", "0", "]"}], "\[Rule]", 
      "1.5700844466032873`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]32", "[", "0", "]"}], "\[Rule]", "1.570791568291128`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]32", "[", "1", "]"}], "\[Rule]", 
      "1.5699671768240369`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]32", "[", "1", "]"}], "\[Rule]", 
      "3.140761145451623`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.772372229656629*^9, 3.772372427272305*^9, 3.772372475519308*^9, 
   3.7723732602921667`*^9, 3.772373482983139*^9, {3.772373704251555*^9, 
   3.772373721980921*^9}, 3.772373761250647*^9, 3.772374945591619*^9, 
   3.772375079772977*^9, 3.7723752442666407`*^9, {3.772375334703947*^9, 
   3.772375394957336*^9}, 3.772375957103389*^9, 3.772376359270447*^9, 
   3.772376919121994*^9, 3.77237709215241*^9, 3.772436894880805*^9, 
   3.7724370010461493`*^9, 3.772437194065012*^9, {3.772438480686203*^9, 
   3.772438502038825*^9}, 3.7724390377592154`*^9, 3.772441650660499*^9, {
   3.772444252492063*^9, 3.772444281576799*^9}, 3.772444872222376*^9, {
   3.7724450183494797`*^9, 3.7724450242489843`*^9}, 3.7724461857781763`*^9, 
   3.772446304043872*^9, 3.772446369438727*^9, 3.772446440792738*^9, 
   3.786951608251514*^9, 3.788403285562394*^9, 3.789127820756001*^9, 
   3.789201604891946*^9},
 ExpressionUUID -> "a4a8fab4-0d2d-429e-95a0-7fa722c07e3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   RowBox[{"(", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"2", 
       SqrtBox["2"]}], ")"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cqa", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.772436873702003*^9, 3.7724368822296553`*^9}, {
   3.7724468352123613`*^9, 3.772446844388261*^9}, {3.772447111884777*^9, 
   3.7724471174607687`*^9}, {3.7724978712333593`*^9, 3.772497912648322*^9}, {
   3.78695169401723*^9, 3.786951733669908*^9}, {3.788417850822073*^9, 
   3.788417875162993*^9}, {3.7885048984081087`*^9, 3.78850490022124*^9}, {
   3.7885049637432623`*^9, 3.788504971943903*^9}, {3.789127867692544*^9, 
   3.789127950712708*^9}, 3.789201500170311*^9},
 ExpressionUUID -> "e7486f23-b82d-49ce-8ab4-4d276ac7a06c"],

Cell[BoxData["5.474178435810778`"], "Output",
 CellChangeTimes->{3.7891279515492697`*^9, 3.78912799433313*^9, 
  3.789201510569392*^9, 3.789201616259034*^9},
 ExpressionUUID -> "d1ca54bd-1e84-4267-a1f1-da4fbab9df15"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"2", "/", "5.47418"}]], "Input",
 CellChangeTimes->{{3.789201628882614*^9, 3.7892016341749687`*^9}}],

Cell[BoxData["0.3653515229678235`"], "Output",
 CellChangeTimes->{3.7892016363295593`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "3", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 
  3.772446673256187*^9}},ExpressionUUID->"ed85c150-8aae-46f6-a609-\
15e722a46d32"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.7885268286539927`*^9, 
  3.7885268367000723`*^9}, {3.788527947492606*^9, 3.788527998438003*^9}},
 ExpressionUUID -> "5882f9e6-48d1-4d7d-9563-2e3271f5db5a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 ExpressionUUID -> "e37cd598-5761-4cfd-8269-c6d70f1c8ab2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]3", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]3"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}], ".", 
        RowBox[{"\[Rho]C2", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
          "c1", ",", "c2"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq2", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_"}], "]"}],
    ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c3", "*", 
      RowBox[{"P2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c3"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa2", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k33_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "4"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "0", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "1", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "0", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "1", ",", "k33"}], "]"}]}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
  3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
  3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
  3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
  3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
  3.772497266889743*^9, 3.772497283714591*^9}},
 ExpressionUUID -> "dd369b2b-3d98-4c18-827e-7050691d1ffc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.36535"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", 
      SqrtBox["2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]33", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]33", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]33", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]33", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]33", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]33", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]33", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]33", "[", "1", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
   3.772497498585828*^9, 3.7724974998972387`*^9}, 3.786951827168229*^9, {
   3.786952027605308*^9, 3.786952028120904*^9}, {3.788417977574526*^9, 
   3.788418005292028*^9}, {3.788505016828611*^9, 3.788505040850543*^9}, {
   3.788505347529038*^9, 3.788505387256744*^9}, {3.7885075593287783`*^9, 
   3.788507563502396*^9}, {3.788525437822459*^9, 3.788525456217333*^9}, {
   3.788525604031497*^9, 3.788525609764406*^9}, {3.78852673271002*^9, 
   3.7885267373254757`*^9}, {3.788526877907447*^9, 3.788526878688282*^9}, 
   3.7891281352614107`*^9, {3.789128176897237*^9, 3.7891281929650917`*^9}, {
   3.789128223328335*^9, 3.789128281199205*^9}, {3.789128314461021*^9, 
   3.7891283242772913`*^9}, {3.789201661319869*^9, 3.789201677648622*^9}},
 ExpressionUUID -> "5cacf892-67b8-4b5b-99d6-63000be3e699"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.291176389377117`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]33", "[", "0", "]"}], "\[Rule]", 
      "1.5700234722584134`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]33", "[", "0", "]"}], "\[Rule]", "1.5707915736863978`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]33", "[", "1", "]"}], "\[Rule]", 
      "1.569912001371363`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]33", "[", "1", "]"}], "\[Rule]", 
      "3.140705975883269`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.786952030445326*^9, 3.788403509990912*^9, 3.788418009243689*^9, 
   3.788505109315648*^9, 3.788505389461739*^9, 3.7885075669729567`*^9, 
   3.78852545903231*^9, {3.788525586124011*^9, 3.788525612342093*^9}, 
   3.78852673984638*^9, 3.788526857613781*^9, {3.7885268927658863`*^9, 
   3.788526909185995*^9}, 3.78852803314091*^9, 3.789128267549741*^9, 
   3.789128329835527*^9, 3.7892016897127028`*^9},
 ExpressionUUID -> "5c154501-67f0-4825-b78f-b3eaf9b14e3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"2", "/", "5.29118"}]], "Input",
 CellChangeTimes->{{3.789201695383573*^9, 3.789201700209749*^9}}],

Cell[BoxData["0.3779875188521275`"], "Output",
 CellChangeTimes->{3.789201701275964*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.36535"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", 
      SqrtBox["2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa2", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa2", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.789128415124468*^9, 3.7891284625482807`*^9}, {
  3.789128515068514*^9, 3.789128529975288*^9}, {3.78920172172537*^9, 
  3.789201725245249*^9}},
 ExpressionUUID -> "ccf26a95-5d9e-4135-a069-aba3bb0227a7"],

Cell[BoxData["5.291179253964527`"], "Output",
 CellChangeTimes->{3.789128548173873*^9, 3.789201734535872*^9},
 ExpressionUUID -> "719aad22-e164-4b1c-adba-b53b1ed41f56"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "4", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 3.772446673256187*^9}, {
  3.78850552085009*^9, 
  3.788505521009758*^9}},ExpressionUUID->"1ee07560-416d-4bb6-a524-\
70f0098ef26e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.788505542371722*^9, 
  3.788505605029366*^9}, {3.788505642928162*^9, 3.7885057368340693`*^9}, {
  3.78850579391327*^9, 3.788505806595009*^9}, {3.788505890359621*^9, 
  3.7885058904771748`*^9}, {3.788505951296496*^9, 3.788505954015854*^9}, {
  3.7885072816982727`*^9, 3.7885072830730047`*^9}, {3.7885078381511087`*^9, 
  3.7885078473793573`*^9}, {3.788528048196356*^9, 3.7885281019585457`*^9}},
 ExpressionUUID -> "547fd919-72b2-45be-b707-9afc0399edc4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 ExpressionUUID -> "3158528c-8abb-44ff-afd9-bd83bf70b92a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]4", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]4"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}], ".", 
        RowBox[{"\[Rho]C3", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
          "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_"}], 
    "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c4", "*", 
      RowBox[{"P3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c4"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa3", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k34_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "8"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "k34"}], 
       "]"}]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
   3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
   3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
   3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
   3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
   3.772497266889743*^9, 3.772497283714591*^9}, {3.7885059332211246`*^9, 
   3.7885060376788197`*^9}, {3.788506090352417*^9, 3.788506124005931*^9}, {
   3.788506157241295*^9, 3.788506237809791*^9}, {3.7885063054913387`*^9, 
   3.788506309646616*^9}, {3.788506397431932*^9, 3.788506608133604*^9}, {
   3.788507413570815*^9, 3.788507476866868*^9}, {3.788507524353386*^9, 
   3.788507532318859*^9}, {3.78850775211344*^9, 3.788507819111685*^9}, 
   3.788525024995199*^9, {3.78852510891088*^9, 3.788525150041354*^9}, 
   3.788526026332473*^9, {3.788526935212297*^9, 3.788526945977172*^9}},
 ExpressionUUID -> "eb83097c-9ea2-4dbc-9510-2461dd33ca2c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.378"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.36535"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", 
      SqrtBox["2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa3", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa3", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa3", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa3", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa3", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa3", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa3", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa3", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]34", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]34", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]34", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]34", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]34", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]34", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]34", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]34", "[", "1", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
   3.772497498585828*^9, 3.7724974998972387`*^9}, 3.786951827168229*^9, {
   3.786952027605308*^9, 3.786952028120904*^9}, {3.788417977574526*^9, 
   3.788418005292028*^9}, {3.788505016828611*^9, 3.788505040850543*^9}, {
   3.788505347529038*^9, 3.788505387256744*^9}, {3.788507619185297*^9, 
   3.788507648252692*^9}, {3.788507684220276*^9, 3.7885077214691772`*^9}, {
   3.788507868300164*^9, 3.7885078865728292`*^9}, {3.78850810106927*^9, 
   3.788508105479485*^9}, {3.78852518365519*^9, 3.788525247917734*^9}, {
   3.788525287512992*^9, 3.788525291032343*^9}, 3.788526044406982*^9, {
   3.788526129122316*^9, 3.788526150362542*^9}, {3.788526767555501*^9, 
   3.788526807188422*^9}, {3.788526988003459*^9, 3.788526997686419*^9}, {
   3.7891286478268633`*^9, 3.789128723092886*^9}, {3.789128777222559*^9, 
   3.789128858171595*^9}, {3.789201775774825*^9, 3.789201802095421*^9}},
 ExpressionUUID -> "04e08467-cbf8-4da2-9b95-ae98daaf964e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.088903635612832`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]34", "[", "0", "]"}], "\[Rule]", 
      "1.5694994873924717`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]34", "[", "0", "]"}], "\[Rule]", "1.5712296742410834`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]34", "[", "1", "]"}], "\[Rule]", 
      "1.5702222457551471`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]34", "[", "1", "]"}], "\[Rule]", 
      "3.141139765757086`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.789128731106352*^9, {3.7891288341937437`*^9, 3.789128863869629*^9}, 
   3.7892018366613703`*^9},
 ExpressionUUID -> "1a4479c0-4e2d-4142-af30-f5764ab37752"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"2", "/", "5.0889"}]], "Input",
 CellChangeTimes->{{3.7892018526460953`*^9, 3.789201855941959*^9}}],

Cell[BoxData["0.3930122423313486`"], "Output",
 CellChangeTimes->{3.7892018580186462`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.378"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.36535"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", 
      SqrtBox["2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa3", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa3", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cqa3", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa3", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa3", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa3", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa3", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa3", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.789128942956366*^9, 3.789129034772654*^9}, 
   3.789201848503668*^9},
 ExpressionUUID -> "c3ff25fb-e298-4b91-9411-ecaead5a464a"],

Cell[BoxData["5.0889066943619845`"], "Output",
 CellChangeTimes->{3.7891290308383703`*^9, 3.78912906625397*^9, 
  3.789201899080274*^9},
 ExpressionUUID -> "d978c7d3-09be-44fe-9948-e34e12c6a7cd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "5", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.788526338083778*^9, 
  3.788526339620455*^9}},ExpressionUUID->"a58030dd-5466-44aa-8266-\
45352408fca3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.788505542371722*^9, 
  3.788505605029366*^9}, {3.788505642928162*^9, 3.7885057368340693`*^9}, {
  3.78850579391327*^9, 3.788505806595009*^9}, {3.788505890359621*^9, 
  3.7885058904771748`*^9}, {3.788505951296496*^9, 3.788505954015854*^9}, {
  3.7885072816982727`*^9, 3.7885072830730047`*^9}, {3.7885078381511087`*^9, 
  3.7885078473793573`*^9}, {3.788526350589307*^9, 3.78852646328999*^9}, {
  3.788528161658049*^9, 3.788528278750496*^9}},
 ExpressionUUID -> "0cad7bec-353e-461b-99e4-b9ed22656db0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 ExpressionUUID -> "a896f892-3fc4-446d-b415-1d4dee8d7ec3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]5", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]5"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}], ".", 
        RowBox[{"\[Rho]C4", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], 
         "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c5", "*", 
      RowBox[{"P4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "a1", ",", "b1", ",", "c5"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa4", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k35_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "16"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "k35"}], 
       "]"}]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
   3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
   3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
   3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
   3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
   3.772497266889743*^9, 3.772497283714591*^9}, {3.7885059332211246`*^9, 
   3.7885060376788197`*^9}, {3.788506090352417*^9, 3.788506124005931*^9}, {
   3.788506157241295*^9, 3.788506237809791*^9}, {3.7885063054913387`*^9, 
   3.788506309646616*^9}, {3.788506397431932*^9, 3.788506608133604*^9}, {
   3.788507413570815*^9, 3.788507476866868*^9}, {3.788507524353386*^9, 
   3.788507532318859*^9}, {3.78850775211344*^9, 3.788507819111685*^9}, 
   3.788525024995199*^9, {3.78852510891088*^9, 3.788525150041354*^9}, 
   3.788526026332473*^9, {3.788526477828945*^9, 3.788526596457444*^9}, {
   3.788527079592304*^9, 3.7885273464525337`*^9}, {3.788527620600141*^9, 
   3.78852762070826*^9}},
 ExpressionUUID -> "8103f362-5303-4bb9-91be-de396a645742"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.378"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.36535"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", 
      SqrtBox["2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa4", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa4", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa4", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa4", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa4", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa4", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa4", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa4", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]35", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]35", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]35", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]35", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]35", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]35", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]35", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]35", "[", "1", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
   3.772497498585828*^9, 3.7724974998972387`*^9}, 3.786951827168229*^9, {
   3.786952027605308*^9, 3.786952028120904*^9}, {3.788417977574526*^9, 
   3.788418005292028*^9}, {3.788505016828611*^9, 3.788505040850543*^9}, {
   3.788505347529038*^9, 3.788505387256744*^9}, {3.788507619185297*^9, 
   3.788507648252692*^9}, {3.788507684220276*^9, 3.7885077214691772`*^9}, {
   3.788507868300164*^9, 3.7885078865728292`*^9}, {3.78850810106927*^9, 
   3.788508105479485*^9}, {3.78852518365519*^9, 3.788525247917734*^9}, {
   3.788525287512992*^9, 3.788525291032343*^9}, 3.788526044406982*^9, {
   3.788526129122316*^9, 3.788526150362542*^9}, {3.788527357013254*^9, 
   3.788527425793359*^9}, {3.788527528334896*^9, 3.788527538093656*^9}, {
   3.789129199721053*^9, 3.789129281906986*^9}, {3.789129313341147*^9, 
   3.789129324130516*^9}, {3.789201955257555*^9, 3.789201973825642*^9}},
 ExpressionUUID -> "07f38fb7-8e1f-41c8-9add-209018c56b00"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.8841731523742045`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]35", "[", "0", "]"}], "\[Rule]", 
      "1.5694994873924717`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]35", "[", "0", "]"}], "\[Rule]", "1.5712296742410834`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]35", "[", "1", "]"}], "\[Rule]", 
      "1.5702222457551471`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]35", "[", "1", "]"}], "\[Rule]", 
      "3.141139765757086`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.788527385584641*^9, 3.788527448082528*^9, 
  3.788527563169582*^9, 3.788527645336762*^9, 3.788528318045309*^9, 
  3.7891293080616627`*^9, 3.789129347847287*^9, 3.789202099362299*^9},
 ExpressionUUID -> "13f9a6cc-2e03-4fb9-8c1a-93b5b892b544"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"2", "/", "4.88417"}]], "Input",
 CellChangeTimes->{{3.789202151777416*^9, 3.7892021619069433`*^9}}],

Cell[BoxData["0.409486156296771`"], "Output",
 CellChangeTimes->{3.789202162699729*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.378"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.36535"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", 
      SqrtBox["2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa4", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa4", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cqa4", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa4", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa4", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa4", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa4", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa4", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.789129375049038*^9, 3.789129397779313*^9}, 
   3.789202143232339*^9},
 ExpressionUUID -> "a6e9bc58-8d71-43e2-845b-d9f1d2f8f6c3"],

Cell[BoxData["4.884176088064234`"], "Output",
 CellChangeTimes->{3.7891294253814573`*^9, 3.789129467978674*^9, 
  3.789202286433806*^9},
 ExpressionUUID -> "04593086-1470-4769-b169-c509cff6e95d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "6", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.788526338083778*^9, 3.788526339620455*^9}, {
  3.788527725308695*^9, 
  3.78852772634177*^9}},ExpressionUUID->"84f055c8-0ca9-4a7c-a6ee-\
8761c77be87d"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]0", "=", 
     RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]1", "=", 
     RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]2", "=", 
     RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]3", "=", 
     RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1"},
        {"0"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d", "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0"},
        {"1"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]GHZ", "=", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"x1", "[", 
      RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"\[Sigma]0", "+", 
        RowBox[{"a1", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
           "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
           "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
            "\[Sigma]3"}]}], ")"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"y2", "[", 
      RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"\[Sigma]0", "+", 
        RowBox[{"b1", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
           "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
           "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
            "\[Sigma]3"}]}], ")"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zR31", "[", 
      RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c1", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"c1", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zR32", "[", 
      RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c2", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"c2", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zR33", "[", 
      RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c3", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"c3", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zR34", "[", 
      RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c4", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"c4", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zR35", "[", 
      RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "+", "\[Lambda]5"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c5", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "-", "\[Lambda]5"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"c5", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
      "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"x1", "[", 
           RowBox[{"i1", ",", "a1"}], "]"}], ",", 
          RowBox[{"y2", "[", 
           RowBox[{"j2", ",", "b1"}], "]"}], ",", 
          RowBox[{"zR31", "[", 
           RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", 
       "\[Rho]GHZ", ".", 
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"x1", "[", 
           RowBox[{"i1", ",", "a1"}], "]"}], ",", 
          RowBox[{"y2", "[", 
           RowBox[{"j2", ",", "b1"}], "]"}], ",", 
          RowBox[{"zR31", "[", 
           RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", 
       ",", "c1_", ",", "c2_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR32", "[", 
           RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
       RowBox[{"\[Rho]ABC1", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], "]"}],
        ".", 
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR32", "[", 
           RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", 
       ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR33", "[", 
           RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
       RowBox[{"\[Rho]ABC2", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
         "c1", ",", "c2"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR33", "[", 
           RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", 
       "c4_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR34", "[", 
           RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
       RowBox[{"\[Rho]ABC3", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
         "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR34", "[", 
           RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", 
       "c3_", ",", "c4_", ",", "c5_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR35", "[", 
           RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
       RowBox[{"\[Rho]ABC4", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}],
        ".", 
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR35", "[", 
           RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.788505542371722*^9, 
  3.788505605029366*^9}, {3.788505642928162*^9, 3.7885057368340693`*^9}, {
  3.78850579391327*^9, 3.788505806595009*^9}, {3.788505890359621*^9, 
  3.7885058904771748`*^9}, {3.788505951296496*^9, 3.788505954015854*^9}, {
  3.7885072816982727`*^9, 3.7885072830730047`*^9}, {3.7885078381511087`*^9, 
  3.7885078473793573`*^9}, {3.788526350589307*^9, 3.78852646328999*^9}, {
  3.788527735676673*^9, 3.788527853571287*^9}, {3.788528330826366*^9, 
  3.788528373028413*^9}, {3.7885293082994843`*^9, 3.788529319073097*^9}, {
  3.78913328387868*^9, 3.7891332968518763`*^9}, {3.7891965320218477`*^9, 
  3.789196539338902*^9}},
 ExpressionUUID -> "b0be8cd5-2d2e-4e6f-ac1b-74c53686f4fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.789131074462988*^9},
 ExpressionUUID -> "ff9e4b7b-3739-4d2a-97b7-f2e5aa1aa8fa"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]BC5", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", 
       "c3_", ",", "c4_", ",", "c5_"}], "]"}], ":=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"TraceSystem", "[", 
       RowBox[{
        RowBox[{"\[Rho]ABC5", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
          "c4", ",", "c5"}], "]"}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]C5", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", 
       "c3_", ",", "c4_", ",", "c5_"}], "]"}], ":=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"TraceSystem", "[", 
       RowBox[{
        RowBox[{"\[Rho]BC5", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
          "c4", ",", "c5"}], "]"}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"z36", "[", 
      RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Lambda]6", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c6", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Lambda]6"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P5", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c6_"}], "]"}], 
     ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"z36", "[", 
           RowBox[{"k36", ",", "c6"}], "]"}], ".", 
          RowBox[{"\[Rho]C5", "[", 
           RowBox[{
           "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", 
            ",", "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3",
             ",", "c4", ",", "c5"}], "]"}]}], "]"}], ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"c1", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c2", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c3", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c4", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c5", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Cq5", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "k36_"}], "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"a1", "*", "b1", "*", "c6", "*", 
        RowBox[{"P5", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c6"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"a1", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b1", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c6", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cqa5", "[", 
     RowBox[{"i1_", ",", "j2_", ",", "k36_"}], "]"}], ":=", 
    RowBox[{
     FractionBox["1", "32"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "1", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
         ",", "k36"}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.789133324180932*^9, 3.789133594576436*^9}, {
   3.789133649072295*^9, 3.789133786176893*^9}, {3.789133859006772*^9, 
   3.7891338599195623`*^9}, 3.789133998990376*^9, {3.789134111251547*^9, 
   3.789134112017708*^9}},
 ExpressionUUID -> "257abe9b-e931-4eb9-a931-30bb0bc4200a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]6", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.4095"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.378"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.36535"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", 
      SqrtBox["2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa5", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa5", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa5", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa5", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa5", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa5", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa5", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa5", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]36", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]36", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]36", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]36", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]36", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]36", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]36", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]36", "[", "1", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7891295918724337`*^9, 3.789129614184042*^9}, {
  3.789129648751705*^9, 3.7891297072878428`*^9}, {3.789130966787888*^9, 
  3.789130993011643*^9}, {3.789202180904571*^9, 3.789202200837268*^9}},
 ExpressionUUID -> "18c1dc2b-4432-46f7-8c0e-e2b81363d0c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.670026866797201`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]36", "[", "0", "]"}], "\[Rule]", 
      "1.5694994873924717`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]36", "[", "0", "]"}], "\[Rule]", "1.5712296742410834`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]36", "[", "1", "]"}], "\[Rule]", 
      "1.5702222457551471`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]36", "[", "1", "]"}], "\[Rule]", 
      "3.141139765757086`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.789134221141021*^9, 3.789196512871078*^9, 
  3.7891966709404697`*^9, 3.789202802928125*^9},
 ExpressionUUID -> "a833fac5-bf6c-4213-adca-255fc67a3eb0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"2", "/", "4.67003"}]], "Input",
 CellChangeTimes->{{3.78920403633204*^9, 3.789204043469187*^9}}],

Cell[BoxData["0.4282627734725473`"], "Output",
 CellChangeTimes->{3.789204044362965*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.4095"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.378"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.36535"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", 
      SqrtBox["2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa5", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa5", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cqa5", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa5", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa5", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa5", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa5", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa5", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
   3.772497498585828*^9, 3.7724974998972387`*^9}, 3.786951827168229*^9, {
   3.786952027605308*^9, 3.786952028120904*^9}, {3.788417977574526*^9, 
   3.788418005292028*^9}, {3.788505016828611*^9, 3.788505040850543*^9}, {
   3.788505347529038*^9, 3.788505387256744*^9}, {3.788507619185297*^9, 
   3.788507648252692*^9}, {3.788507684220276*^9, 3.7885077214691772`*^9}, {
   3.788507868300164*^9, 3.7885078865728292`*^9}, {3.78850810106927*^9, 
   3.788508105479485*^9}, {3.78852518365519*^9, 3.788525247917734*^9}, {
   3.788525287512992*^9, 3.788525291032343*^9}, 3.788526044406982*^9, {
   3.788526129122316*^9, 3.788526150362542*^9}, {3.788527357013254*^9, 
   3.788527425793359*^9}, {3.788527528334896*^9, 3.788527538093656*^9}, {
   3.78852882073094*^9, 3.7885288663222523`*^9}, {3.788529044845997*^9, 
   3.78852904685413*^9}, {3.789134303851954*^9, 3.78913433798516*^9}, 
   3.7892022217414017`*^9},
 ExpressionUUID -> "1b88c73a-0d70-4f33-95cf-d69196c9b35f"],

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"3.3024727676373877`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "\[Lambda]6"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.7885289630170527`*^9, 3.788529154284326*^9, 
  3.7885294786060457`*^9, 3.788606088526307*^9, 3.789134489557469*^9},
 ExpressionUUID -> "0239d94f-f99d-44dc-870b-64cde6f96905"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "7", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{
  3.789134520774382*^9},ExpressionUUID->"2b77d486-babc-4cf7-9b2f-\
b312cebf0e62"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
       "c4", ",", "c5"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.789134517362254*^9, 3.789134517710101*^9}, {
  3.789187678806168*^9, 3.789187833832885*^9}, {3.7891967033315*^9, 
  3.789196711008957*^9}, {3.7891973520229197`*^9, 3.78919736265625*^9}, {
  3.789215494320846*^9, 3.7892155025170403`*^9}},
 ExpressionUUID -> "60db60f0-d67e-47a9-9dbc-cc1ced66ad66"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.789131074462988*^9},
 ExpressionUUID -> "ff9e4b7b-3739-4d2a-97b7-f2e5aa1aa8fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC6", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
        "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC6", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
        "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z37", "[", 
    RowBox[{"k37_", ",", "c7_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]7", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]7"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}], ".", 
        RowBox[{"\[Rho]C6", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",",
           "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c6", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c7", "*", 
      RowBox[{"P6", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c7"}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c7", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa6", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k37_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "64"], 
    RowBox[{"(", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Cq6", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "k35", ",", "k36", ",", "k37"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k36", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.789133324180932*^9, 3.789133594576436*^9}, {
   3.789133649072295*^9, 3.789133786176893*^9}, {3.789133859006772*^9, 
   3.7891338599195623`*^9}, 3.789133998990376*^9, {3.789134111251547*^9, 
   3.789134112017708*^9}, {3.7891878739003153`*^9, 3.789187924341144*^9}, {
   3.789195477998372*^9, 3.789195740139311*^9}, {3.789195787459426*^9, 
   3.789195802733355*^9}, {3.7891958612415257`*^9, 3.789195861742977*^9}, {
   3.789196737698279*^9, 3.789196766154516*^9}, {3.789197272428116*^9, 
   3.789197318382045*^9}, {3.789215475699445*^9, 3.7892154763622*^9}},
 ExpressionUUID -> "257abe9b-e931-4eb9-a931-30bb0bc4200a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]7", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]6", "=", "0.4283"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.4095"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.378"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.36535"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", 
      SqrtBox["2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "\[Pi]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa6", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa6", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa6", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa6", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa6", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa6", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa6", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa6", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]37", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]37", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]37", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]37", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]37", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]37", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]37", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]37", "[", "1", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7891958717324867`*^9, 3.789195878630331*^9}, {
   3.789195922867941*^9, 3.7891960289598*^9}, 3.789196309359455*^9, {
   3.7891974475824537`*^9, 3.789197470656755*^9}, 3.789202231443412*^9, {
   3.7892040893976307`*^9, 3.789204095513348*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.445017039950185`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]37", "[", "0", "]"}], "\[Rule]", 
      "1.5694994873924717`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]37", "[", "0", "]"}], "\[Rule]", "1.5712296742410834`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]37", "[", "1", "]"}], "\[Rule]", 
      "1.5702222457551471`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]37", "[", "1", "]"}], "\[Rule]", 
      "3.141139765757086`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.789196032595972*^9, 3.7891960448776293`*^9}, 
   3.789197214353155*^9, 3.789197896942819*^9, 3.789204100690227*^9, 
   3.789206389557777*^9, 3.789217537610989*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"2", "/", "4.44502"}]], "Input",
 CellChangeTimes->{{3.789212903821063*^9, 3.789212907503084*^9}}],

Cell[BoxData["0.4499417325456353`"], "Output",
 CellChangeTimes->{3.789212909555287*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "8", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{
  3.789134520774382*^9, {3.789201275527461*^9, 3.789201276166449*^9}},
 ExpressionUUID -> "2b77d486-babc-4cf7-9b2f-b312cebf0e62"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR37", "[", 
    RowBox[{"k37_", ",", "c7_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
       "c4", ",", "c5"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC6", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
       "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.789134517362254*^9, 3.789134517710101*^9}, {
  3.789187678806168*^9, 3.789187833832885*^9}, {3.7891967033315*^9, 
  3.789196711008957*^9}, {3.7891973520229197`*^9, 3.78919736265625*^9}, {
  3.789215245896907*^9, 3.789215355924212*^9}},
 ExpressionUUID -> "60db60f0-d67e-47a9-9dbc-cc1ced66ad66"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.789131074462988*^9},
 ExpressionUUID -> "ff9e4b7b-3739-4d2a-97b7-f2e5aa1aa8fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
     "c7_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC7", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", ",", 
        "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC7", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", ",", 
        "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z38", "[", 
    RowBox[{"k38_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]8", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]8"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
     "b1_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z38", "[", 
         RowBox[{"k38", ",", "c8"}], "]"}], ".", 
        RowBox[{"\[Rho]C7", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", 
          ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], 
         "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c6", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c7", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c8", "*", 
      RowBox[{"P7", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", "b1", ",", 
        "c8"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c8", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa7", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k38_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "128"], 
    RowBox[{"(", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Cq7", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "k35", ",", "k36", ",", "k37", ",", "k38"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k36", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k37", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.789133324180932*^9, 3.789133594576436*^9}, {
   3.789133649072295*^9, 3.789133786176893*^9}, {3.789133859006772*^9, 
   3.7891338599195623`*^9}, 3.789133998990376*^9, {3.789134111251547*^9, 
   3.789134112017708*^9}, {3.7891878739003153`*^9, 3.789187924341144*^9}, {
   3.789195477998372*^9, 3.789195740139311*^9}, {3.789195787459426*^9, 
   3.789195802733355*^9}, {3.7891958612415257`*^9, 3.789195861742977*^9}, {
   3.789196737698279*^9, 3.789196766154516*^9}, {3.789197272428116*^9, 
   3.789197318382045*^9}, {3.7892153664456244`*^9, 3.789215464936296*^9}, {
   3.78921553607436*^9, 3.789215676101594*^9}},
 ExpressionUUID -> "257abe9b-e931-4eb9-a931-30bb0bc4200a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]8", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]7", "=", "0.445"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]6", "=", "0.4283"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.4095"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.378"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.36535"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", 
      SqrtBox["2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "\[Pi]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]37", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]37", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]37", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]37", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa7", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa7", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa7", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa7", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa7", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa7", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa7", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa7", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]38", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]38", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]38", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]38", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]38", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]38", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]38", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]38", "[", "1", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7891958717324867`*^9, 3.789195878630331*^9}, {
   3.789195922867941*^9, 3.7891960289598*^9}, 3.789196309359455*^9, {
   3.7891974475824537`*^9, 3.789197470656755*^9}, {3.789212959112823*^9, 
   3.789212965390922*^9}, {3.7892179716291103`*^9, 3.789218050302862*^9}, {
   3.789226416171389*^9, 3.789226423183323*^9}, {3.789226486691704*^9, 
   3.78922653788387*^9}, {3.7892285570788403`*^9, 3.789228561095709*^9}}],

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "4.212835371629546`", ",", "True", ",", "True", ",", "True", ",", 
     "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.5707963077751086`", ",", "1.5707963077751086`", ",", 
     "1.5707963077751086`", ",", "3.1415926319484364`"}], "}"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.789196032595972*^9, 3.7891960448776293`*^9}, 
   3.789197214353155*^9, 3.789197896942819*^9, 3.7892149710417137`*^9, 
   3.7892179620117207`*^9, 3.7892261635529537`*^9, 3.789227575608354*^9, 
   3.78923653348635*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"2", "/", "4.21284"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.7892603009001827`*^9, 3.7892603057107563`*^9}, {
  3.78989434853409*^9, 3.789894349870109*^9}}],

Cell[BoxData["0.4747391308475993`"], "Output",
 CellChangeTimes->{3.789894350928084*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "9", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{
  3.789134520774382*^9, {3.789201275527461*^9, 3.789201276166449*^9}, {
   3.789215879095402*^9, 3.7892158797427683`*^9}},
 ExpressionUUID -> "2b77d486-babc-4cf7-9b2f-b312cebf0e62"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR37", "[", 
    RowBox[{"k37_", ",", "c7_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR38", "[", 
    RowBox[{"k38_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]8"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]8"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
       "c4", ",", "c5"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC6", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
       "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC8", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
     "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", 
     "c6_", ",", "c7_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR38", "[", 
         RowBox[{"k38", ",", "c8"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC7", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", ",", 
       "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR38", "[", 
         RowBox[{"k38", ",", "c8"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.789134517362254*^9, 3.789134517710101*^9}, {
  3.789187678806168*^9, 3.789187833832885*^9}, {3.7891967033315*^9, 
  3.789196711008957*^9}, {3.7891973520229197`*^9, 3.78919736265625*^9}, {
  3.789215245896907*^9, 3.789215355924212*^9}, {3.7892158888139553`*^9, 
  3.7892159752292643`*^9}},
 ExpressionUUID -> "60db60f0-d67e-47a9-9dbc-cc1ced66ad66"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.789131074462988*^9},
 ExpressionUUID -> "ff9e4b7b-3739-4d2a-97b7-f2e5aa1aa8fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC8", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
     "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", 
     "c6_", ",", "c7_", ",", "c8_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC8", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", 
        "c7", ",", "c8"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C8", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
     "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", 
     "c6_", ",", "c7_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC8", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", 
        "c7", ",", "c8"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z39", "[", 
    RowBox[{"k39_", ",", "c9_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]9", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c9", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]9"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P8", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "a1_", ",", "b1_", ",", "c9_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z39", "[", 
         RowBox[{"k39", ",", "c9"}], "]"}], ".", 
        RowBox[{"\[Rho]C8", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", "b1", 
          ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", 
          ",", "c7", ",", "c8"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c6", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c7", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c8", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq8", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_"}], "]"}],
    ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c9", "*", 
      RowBox[{"P8", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "a1", ",",
         "b1", ",", "c9"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c9", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa8", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k39_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "256"], 
    RowBox[{"(", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Cq8", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39"}], "]"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k36", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k37", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k38", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.789133324180932*^9, 3.789133594576436*^9}, {
   3.789133649072295*^9, 3.789133786176893*^9}, {3.789133859006772*^9, 
   3.7891338599195623`*^9}, 3.789133998990376*^9, {3.789134111251547*^9, 
   3.789134112017708*^9}, {3.7891878739003153`*^9, 3.789187924341144*^9}, {
   3.789195477998372*^9, 3.789195740139311*^9}, {3.789195787459426*^9, 
   3.789195802733355*^9}, {3.7891958612415257`*^9, 3.789195861742977*^9}, {
   3.789196737698279*^9, 3.789196766154516*^9}, {3.789197272428116*^9, 
   3.789197318382045*^9}, {3.7892153664456244`*^9, 3.789215464936296*^9}, {
   3.78921553607436*^9, 3.789215676101594*^9}, {3.789215981466035*^9, 
   3.789216193110113*^9}},
 ExpressionUUID -> "257abe9b-e931-4eb9-a931-30bb0bc4200a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]9", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]8", "=", "0.475"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]7", "=", "0.445"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]6", "=", "0.4283"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.4095"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.378"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.36535"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", 
      SqrtBox["2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "\[Pi]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]37", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]37", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]37", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]37", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]38", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]38", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]38", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]38", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa8", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa8", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa8", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa8", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa8", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa8", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa8", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa8", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]39", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]39", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]39", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]39", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]39", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]39", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]39", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]39", "[", "1", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7891958717324867`*^9, 3.789195878630331*^9}, {
   3.789195922867941*^9, 3.7891960289598*^9}, 3.789196309359455*^9, {
   3.7891974475824537`*^9, 3.789197470656755*^9}, {3.789212959112823*^9, 
   3.789212965390922*^9}, {3.78921807162753*^9, 3.7892181818692207`*^9}, {
   3.7892264533848267`*^9, 3.789226462779965*^9}, {3.789228641924471*^9, 
   3.789228643304844*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.9600329481689682`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]39", "[", "0", "]"}], "\[Rule]", 
      "1.5694994873924717`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]39", "[", "0", "]"}], "\[Rule]", "1.5712296742410834`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]39", "[", "1", "]"}], "\[Rule]", 
      "1.5702222457551471`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]39", "[", "1", "]"}], "\[Rule]", 
      "3.141139765757086`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.789196032595972*^9, 3.7891960448776293`*^9}, 
   3.789197214353155*^9, 3.789197896942819*^9, 3.7892149710417137`*^9, 
   3.7892264460871143`*^9, 3.789268948241166*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"2", "/", "3.9600329481689682`"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.7898943923518744`*^9, 3.789894397894853*^9}}],

Cell[BoxData["0.5050463029416853`"], "Output",
 CellChangeTimes->{3.789894398734942*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "10", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{
  3.789134520774382*^9, {3.789201275527461*^9, 3.789201276166449*^9}, {
   3.789215879095402*^9, 3.7892158797427683`*^9}, {3.789228705806182*^9, 
   3.7892287077168913`*^9}},
 ExpressionUUID -> "2b77d486-babc-4cf7-9b2f-b312cebf0e62"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR37", "[", 
    RowBox[{"k37_", ",", "c7_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR38", "[", 
    RowBox[{"k38_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]8"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]8"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR39", "[", 
    RowBox[{"k39_", ",", "c9_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]9"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c9", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]9"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c9", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
       "c4", ",", "c5"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC6", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
       "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC8", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
     "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", 
     "c6_", ",", "c7_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR38", "[", 
         RowBox[{"k38", ",", "c8"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC7", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", ",", 
       "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR38", "[", 
         RowBox[{"k38", ",", "c8"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC9", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", 
     "c5_", ",", "c6_", ",", "c7_", ",", "c8_", ",", "c9_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR39", "[", 
         RowBox[{"k39", ",", "c9"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC8", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7",
        ",", "c8"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR39", "[", 
         RowBox[{"k39", ",", "c9"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.789134517362254*^9, 3.789134517710101*^9}, {
  3.789187678806168*^9, 3.789187833832885*^9}, {3.7891967033315*^9, 
  3.789196711008957*^9}, {3.7891973520229197`*^9, 3.78919736265625*^9}, {
  3.789215245896907*^9, 3.789215355924212*^9}, {3.7892158888139553`*^9, 
  3.7892159752292643`*^9}, {3.789228717833894*^9, 3.7892288113849*^9}},
 ExpressionUUID -> "60db60f0-d67e-47a9-9dbc-cc1ced66ad66"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.789131074462988*^9},
 ExpressionUUID -> "ff9e4b7b-3739-4d2a-97b7-f2e5aa1aa8fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC9", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", 
     "c5_", ",", "c6_", ",", "c7_", ",", "c8_", ",", "c9_"}], "]"}], ":=", 
   " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC9", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "a1", ",",
         "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", 
        "c6", ",", "c7", ",", "c8", ",", "c9"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C9", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", 
     "c5_", ",", "c6_", ",", "c7_", ",", "c8_", ",", "c9_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC9", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "a1", ",",
         "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", 
        "c6", ",", "c7", ",", "c8", ",", "c9"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z310", "[", 
    RowBox[{"k310_", ",", "c10_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]10", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c10", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]10"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P9", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "k310_", ",", "a1_", ",", "b1_", ",", "c10_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z310", "[", 
         RowBox[{"k310", ",", "c10"}], "]"}], ".", 
        RowBox[{"\[Rho]C9", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "a1", 
          ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", 
          ",", "c6", ",", "c7", ",", "c8", ",", "c9"}], "]"}]}], "]"}], ")"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c6", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c7", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c8", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c9", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq9", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "k10_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c10", "*", 
      RowBox[{"P9", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "k10", 
        ",", "a1", ",", "b1", ",", "c10"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c10", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa9", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k310_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "512"], 
    RowBox[{"(", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Cq9", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "k310"}],
         "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k36", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k37", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k38", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k39", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.789133324180932*^9, 3.789133594576436*^9}, {
   3.789133649072295*^9, 3.789133786176893*^9}, {3.789133859006772*^9, 
   3.7891338599195623`*^9}, 3.789133998990376*^9, {3.789134111251547*^9, 
   3.789134112017708*^9}, {3.7891878739003153`*^9, 3.789187924341144*^9}, {
   3.789195477998372*^9, 3.789195740139311*^9}, {3.789195787459426*^9, 
   3.789195802733355*^9}, {3.7891958612415257`*^9, 3.789195861742977*^9}, {
   3.789196737698279*^9, 3.789196766154516*^9}, {3.789197272428116*^9, 
   3.789197318382045*^9}, {3.7892153664456244`*^9, 3.789215464936296*^9}, {
   3.78921553607436*^9, 3.789215676101594*^9}, {3.789215981466035*^9, 
   3.789216193110113*^9}, {3.789228818340843*^9, 3.7892290609345913`*^9}, {
   3.7892694749754763`*^9, 3.7892694759007072`*^9}},
 ExpressionUUID -> "257abe9b-e931-4eb9-a931-30bb0bc4200a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]10", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]9", "=", "0.505"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]8", "=", "0.475"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]7", "=", "0.445"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]6", "=", "0.4283"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.4095"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.378"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.36535"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", 
      SqrtBox["2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "\[Pi]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]37", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]37", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]37", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]37", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]38", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]38", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]38", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]38", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]39", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]39", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]39", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]39", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa9", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa9", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa9", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa9", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa9", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa9", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa9", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa9", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]310", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]310", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]310", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]310", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]310", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]310", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]310", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]310", "[", "1", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7891958717324867`*^9, 3.789195878630331*^9}, {
   3.789195922867941*^9, 3.7891960289598*^9}, 3.789196309359455*^9, {
   3.7891974475824537`*^9, 3.789197470656755*^9}, {3.789212959112823*^9, 
   3.789212965390922*^9}, {3.78921807162753*^9, 3.7892181818692207`*^9}, {
   3.7892264533848267`*^9, 3.789226462779965*^9}, {3.789228641924471*^9, 
   3.789228643304844*^9}, {3.7892290789133883`*^9, 3.7892290800134363`*^9}, {
   3.789229119471352*^9, 3.789229176339799*^9}, {3.78922923345968*^9, 
   3.789229256599001*^9}, {3.789269509630807*^9, 3.789269510432486*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.689006992029942`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]310", "[", "0", "]"}], "\[Rule]", 
      "1.5694994873924717`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]310", "[", "0", "]"}], "\[Rule]", 
      "1.5712296742410834`"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]310", "[", "1", "]"}], "\[Rule]", 
      "1.5702222457551471`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]310", "[", "1", "]"}], "\[Rule]", 
      "3.141139765757086`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.789196032595972*^9, 3.7891960448776293`*^9}, 
   3.789197214353155*^9, 3.789197896942819*^9, 3.7892149710417137`*^9, 
   3.7892264460871143`*^9, 3.78926946945888*^9, 3.7892695060369673`*^9, 
   3.7894084098490553`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"2", "/", "3.68901"}]], "Input",
 CellChangeTimes->{{3.789439486177649*^9, 3.789439492071548*^9}}],

Cell[BoxData["0.5421508751670502`"], "Output",
 CellChangeTimes->{3.789439493832909*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "11", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{
  3.789134520774382*^9, {3.789201275527461*^9, 3.789201276166449*^9}, {
   3.789215879095402*^9, 3.7892158797427683`*^9}, {3.789228705806182*^9, 
   3.7892287077168913`*^9}, {3.789439563365775*^9, 3.789439563457107*^9}},
 ExpressionUUID -> "2b77d486-babc-4cf7-9b2f-b312cebf0e62"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR37", "[", 
    RowBox[{"k37_", ",", "c7_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR38", "[", 
    RowBox[{"k38_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]8"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]8"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR39", "[", 
    RowBox[{"k39_", ",", "c9_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]9"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c9", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]9"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c9", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR310", "[", 
    RowBox[{"k310_", ",", "c10_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]10"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c10", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]10"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c10", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
       "c4", ",", "c5"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC6", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
       "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC8", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
     "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", 
     "c6_", ",", "c7_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR38", "[", 
         RowBox[{"k38", ",", "c8"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC7", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", ",", 
       "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR38", "[", 
         RowBox[{"k38", ",", "c8"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC9", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", 
     "c5_", ",", "c6_", ",", "c7_", ",", "c8_", ",", "c9_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR39", "[", 
         RowBox[{"k39", ",", "c9"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC8", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7",
        ",", "c8"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR39", "[", 
         RowBox[{"k39", ",", "c9"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC10", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "k310_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",",
      "c4_", ",", "c5_", ",", "c6_", ",", "c7_", ",", "c8_", ",", "c9_", ",", 
     "c10_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR310", "[", 
         RowBox[{"k310", ",", "c10"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC9", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6",
        ",", "c7", ",", "c8", ",", "c9"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR310", "[", 
         RowBox[{"k310", ",", "c10"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.789134517362254*^9, 3.789134517710101*^9}, {
  3.789187678806168*^9, 3.789187833832885*^9}, {3.7891967033315*^9, 
  3.789196711008957*^9}, {3.7891973520229197`*^9, 3.78919736265625*^9}, {
  3.789215245896907*^9, 3.789215355924212*^9}, {3.7892158888139553`*^9, 
  3.7892159752292643`*^9}, {3.789228717833894*^9, 3.7892288113849*^9}, {
  3.789439575752646*^9, 3.789439683284628*^9}},
 ExpressionUUID -> "60db60f0-d67e-47a9-9dbc-cc1ced66ad66"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.789131074462988*^9},
 ExpressionUUID -> "ff9e4b7b-3739-4d2a-97b7-f2e5aa1aa8fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC10", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "k310_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",",
      "c4_", ",", "c5_", ",", "c6_", ",", "c7_", ",", "c8_", ",", "c9_", ",", 
     "c10_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC10", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "k10", 
        ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",",
         "c5", ",", "c6", ",", "c7", ",", "c8", ",", "c9", ",", "c10"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C10", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "k310_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",",
      "c4_", ",", "c5_", ",", "c6_", ",", "c7_", ",", "c8_", ",", "c9_", ",", 
     "c10_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC10", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "k310", 
        ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",",
         "c5", ",", "c6", ",", "c7", ",", "c8", ",", "c9", ",", "c10"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z311", "[", 
    RowBox[{"k311_", ",", "c11_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]11", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c11", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]311", "[", "k311", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]311", "[", "k311", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]311", "[", "k311", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]311", "[", "k311", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]311", "[", "k311", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]11"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P10", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "k310_", ",", "k311_", ",", "a1_", ",", "b1_", ",", "c11_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z311", "[", 
         RowBox[{"k311", ",", "c11"}], "]"}], ".", 
        RowBox[{"\[Rho]C10", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "k310",
           ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4", 
          ",", "c5", ",", "c6", ",", "c7", ",", "c8", ",", "c9", ",", "c10"}],
          "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c6", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c7", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c8", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c9", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c10", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq10", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "k310_", ",", "k311_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c11", "*", 
      RowBox[{"P10", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "k310", 
        ",", "k311", ",", "a1", ",", "b1", ",", "c11"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c11", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa10", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k311_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "1024"], 
    RowBox[{"(", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Cq10", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "k310", 
         ",", "k311"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k36", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k37", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k38", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k39", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k310", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.789133324180932*^9, 3.789133594576436*^9}, {
   3.789133649072295*^9, 3.789133786176893*^9}, {3.789133859006772*^9, 
   3.7891338599195623`*^9}, 3.789133998990376*^9, {3.789134111251547*^9, 
   3.789134112017708*^9}, {3.7891878739003153`*^9, 3.789187924341144*^9}, {
   3.789195477998372*^9, 3.789195740139311*^9}, {3.789195787459426*^9, 
   3.789195802733355*^9}, {3.7891958612415257`*^9, 3.789195861742977*^9}, {
   3.789196737698279*^9, 3.789196766154516*^9}, {3.789197272428116*^9, 
   3.789197318382045*^9}, {3.7892153664456244`*^9, 3.789215464936296*^9}, {
   3.78921553607436*^9, 3.789215676101594*^9}, {3.789215981466035*^9, 
   3.789216193110113*^9}, {3.789228818340843*^9, 3.7892290609345913`*^9}, {
   3.7892694749754763`*^9, 3.7892694759007072`*^9}, {3.78943970349183*^9, 
   3.789439831840719*^9}, {3.789439871229525*^9, 3.7894398715548887`*^9}, {
   3.789439909342721*^9, 3.789440099836495*^9}},
 ExpressionUUID -> "257abe9b-e931-4eb9-a931-30bb0bc4200a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]10", "=", "0.5422"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]9", "=", "0.505"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]8", "=", "0.475"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]7", "=", "0.445"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]6", "=", "0.4283"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.4095"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.378"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.36535"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"2", 
      SqrtBox["2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "\[Pi]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]37", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]37", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]37", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]37", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]38", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]38", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]38", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]38", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]39", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]39", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]39", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]39", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]310", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]310", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]310", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]310", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]311", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]311", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]311", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]311", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa10", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa10", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cqa10", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa10", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa10", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa10", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa10", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa10", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7891958717324867`*^9, 3.789195878630331*^9}, {
   3.789195922867941*^9, 3.7891960289598*^9}, 3.789196309359455*^9, {
   3.7891974475824537`*^9, 3.789197470656755*^9}, {3.789212959112823*^9, 
   3.789212965390922*^9}, {3.78921807162753*^9, 3.7892181818692207`*^9}, {
   3.7892264533848267`*^9, 3.789226462779965*^9}, {3.789228641924471*^9, 
   3.789228643304844*^9}, {3.7892290789133883`*^9, 3.7892290800134363`*^9}, {
   3.789229119471352*^9, 3.789229176339799*^9}, {3.78922923345968*^9, 
   3.789229256599001*^9}, {3.789269509630807*^9, 3.789269510432486*^9}, {
   3.789440122647831*^9, 3.789440241482766*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.689006992029942`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]310", "[", "0", "]"}], "\[Rule]", 
      "1.5694994873924717`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]310", "[", "0", "]"}], "\[Rule]", 
      "1.5712296742410834`"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]310", "[", "1", "]"}], "\[Rule]", 
      "1.5702222457551471`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]310", "[", "1", "]"}], "\[Rule]", 
      "3.141139765757086`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.789196032595972*^9, 3.7891960448776293`*^9}, 
   3.789197214353155*^9, 3.789197896942819*^9, 3.7892149710417137`*^9, 
   3.7892264460871143`*^9, 3.78926946945888*^9, 3.7892695060369673`*^9, 
   3.7894084098490553`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"2", "/", "3.68901"}]], "Input",
 CellChangeTimes->{{3.789439486177649*^9, 3.789439492071548*^9}}],

Cell[BoxData["0.5421508751670502`"], "Output",
 CellChangeTimes->{3.789439493832909*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Svelitchny", " ", "inequality"}], "*)"}], 
  RowBox[{"(", 
   RowBox[{"2", "SDI"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.772498109410095*^9, 3.772498118192129*^9}, {
  3.786950390488312*^9, 3.7869503994395742`*^9}, {3.789200524996521*^9, 
  3.789200530300755*^9}, {3.789200607317148*^9, 3.789200608140785*^9}},
 ExpressionUUID -> "62343cd9-2110-427c-8685-447c02a8cbfb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "1"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.772446638561953*^9, 3.772446646056519*^9}},
 ExpressionUUID -> "68bb99e2-ea09-453a-b951-640b269cda59"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z31", "[", 
    RowBox[{"k3_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]1", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]1"}], ")"}], "\[Sigma]0"}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"x1", "[", 
        RowBox[{"i1", ",", "a1"}], "]"}], ",", 
       RowBox[{"y2", "[", 
        RowBox[{"j2", ",", "b1"}], "]"}], ",", 
       RowBox[{"z31", "[", 
        RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ".", "\[Rho]GHZ"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k3_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c1", "*", 
      RowBox[{"P", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Cq", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
    RowBox[{"Cq", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
    RowBox[{"Cq", "[", 
     RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.772249304786038*^9, 3.772249354497417*^9}, {
   3.77224949108958*^9, 3.7722495229535418`*^9}, {3.772249629057231*^9, 
   3.772249703745123*^9}, {3.7722498511526957`*^9, 3.7722499324246893`*^9}, {
   3.772250062745041*^9, 3.772250215826823*^9}, {3.772250732542162*^9, 
   3.772250769421821*^9}, {3.772250822806221*^9, 3.772251074295411*^9}, {
   3.7722511125279703`*^9, 3.772251121807487*^9}, {3.7722670603525257`*^9, 
   3.7722670859434032`*^9}, {3.772267914142321*^9, 3.772267916862372*^9}, {
   3.7722681477508593`*^9, 3.772268160286553*^9}, {3.772268281246937*^9, 
   3.7722683946062183`*^9}, {3.772270190310521*^9, 3.772270191852511*^9}, {
   3.772270281151112*^9, 3.772270358164688*^9}, {3.7722709870442057`*^9, 
   3.772271001203815*^9}, 3.772271458947505*^9, {3.7722720106598167`*^9, 
   3.7722720242355423`*^9}, 3.772273528346916*^9, {3.77227456708317*^9, 
   3.77227457745658*^9}, {3.77227585425636*^9, 3.772275855120398*^9}, {
   3.7722831618567123`*^9, 3.772283241096567*^9}, 3.772364438973338*^9, {
   3.7723692103922586`*^9, 3.7723692410165443`*^9}, {3.772376986154726*^9, 
   3.772377036306695*^9}, {3.7724367623101463`*^9, 3.7724367996877413`*^9}, {
   3.772438526534863*^9, 3.772438621567161*^9}, {3.7869366561363287`*^9, 
   3.786936731824226*^9}, {3.788417100149597*^9, 3.788417109273864*^9}, {
   3.788417141873987*^9, 3.788417157526743*^9}, 3.789126879739934*^9, {
   3.789200713516707*^9, 3.789200721003685*^9}},
 ExpressionUUID -> "e60da0c8-8f0d-4206-acc6-20a034d815bf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
    RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cq", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cq", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cq", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cq", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cq", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cq", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cq", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cq", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]2", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]2", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]2", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]2", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]31", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "1", "]"}], ",", 
     RowBox[{"\[Theta]2", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]2", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]2", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]2", "[", "1", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.772277240367087*^9, 3.772277241176442*^9}, {
   3.772277272472238*^9, 3.772277280256024*^9}, 3.772369044610169*^9, {
   3.772369074812305*^9, 3.772369076572365*^9}, {3.786936760375462*^9, 
   3.786936777080893*^9}, {3.786936857082547*^9, 3.786936864739764*^9}, {
   3.7869372995448647`*^9, 3.7869374655866127`*^9}, {3.7869375246943913`*^9, 
   3.7869375328124237`*^9}, {3.786937614399789*^9, 3.786937616230981*^9}, {
   3.786937744835943*^9, 3.7869377936489067`*^9}, {3.786937860480073*^9, 
   3.7869378720870333`*^9}, {3.7869382189377413`*^9, 3.786938233143304*^9}, {
   3.7884172004007883`*^9, 3.788417262642941*^9}, {3.7884173258049994`*^9, 
   3.788417340982079*^9}, {3.788417371630183*^9, 3.7884173763712473`*^9}, {
   3.7884174144023027`*^9, 3.7884175139503098`*^9}, {3.788417599472311*^9, 
   3.788417641833292*^9}, 3.7891249524594307`*^9, {3.789125414867772*^9, 
   3.789125415262849*^9}, 3.7891254590347633`*^9, {3.7891254954153013`*^9, 
   3.7891255679578743`*^9}, {3.789125600690076*^9, 3.7891256742064247`*^9}, 
   3.789125723586081*^9, {3.789126036463284*^9, 3.7891260406674147`*^9}, {
   3.789126084822382*^9, 3.789126086361705*^9}, {3.7891263922814217`*^9, 
   3.7891264173935013`*^9}, {3.7891264564149637`*^9, 3.789126481940578*^9}, {
   3.789126560224777*^9, 3.78912659171522*^9}, {3.789126623020281*^9, 
   3.7891266716356773`*^9}, {3.789126738566307*^9, 3.789126739858264*^9}, {
   3.7892006397844687`*^9, 3.789200704227303*^9}, {3.789200768929018*^9, 
   3.789200842707819*^9}},
 ExpressionUUID -> "72619116-c849-4150-959d-c9025bb50b20"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.656854157105892`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[Rule]", 
      "1.5706348982571203`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[Rule]", "0.3620961120117059`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[Rule]", 
      "1.570682055344346`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[Rule]", "1.9328899503529438`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "0", "]"}], "\[Rule]", 
      "1.5706808644773673`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "0", "]"}], "\[Rule]", "0.42330083909282695`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "1", "]"}], "\[Rule]", 
      "1.5706830444038582`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "1", "]"}], "\[Rule]", 
      "1.9940935893322262`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7869376193427753`*^9, 3.7869377977922277`*^9, 3.7869378737268877`*^9, {
   3.786938224727763*^9, 3.786938238293248*^9}, 3.7884031881151342`*^9, 
   3.7884173438397503`*^9, 3.7884173775846767`*^9, {3.7884174313312798`*^9, 
   3.788417495331128*^9}, 3.788417534648202*^9, 3.788417643671256*^9, 
   3.7885048378626757`*^9, 3.789125387229253*^9, 3.78912546075771*^9, 
   3.789125574100071*^9, 3.789125607708239*^9, 3.789125675707131*^9, {
   3.789126048503737*^9, 3.789126069934043*^9}, 3.7891264201665487`*^9, 
   3.789126505499166*^9, 3.789126677814377*^9, 3.789126766603627*^9, 
   3.7891268750137377`*^9, 3.789200734080039*^9, {3.789200775513345*^9, 
   3.7892007966520443`*^9}, {3.7892008286336718`*^9, 3.789200844392254*^9}},
 ExpressionUUID -> "0a8b65b1-09b9-40e2-becc-b722bc064a3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "1.570796311143975`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "0.362096"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "1.570796311143975`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "1.93289"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cq", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cq", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cq", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cq", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cq", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cq", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cq", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cq", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.772271102181653*^9, 3.7722712123236637`*^9}, {
   3.7722712431075087`*^9, 3.772271330403552*^9}, {3.772271360748274*^9, 
   3.772271370994335*^9}, 3.772271442557098*^9, {3.772438684015664*^9, 
   3.772438690015732*^9}, {3.78693815054286*^9, 3.786938206805768*^9}, {
   3.786949964473905*^9, 3.786950003655738*^9}, 3.788417705662813*^9, 
   3.7885048466603117`*^9, {3.7891268104201307`*^9, 3.789126857756481*^9}, {
   3.789200893235826*^9, 3.789200936239526*^9}, {3.789201052542837*^9, 
   3.7892010604109087`*^9}},
 ExpressionUUID -> "c053c7ca-5ab4-4774-a120-25593424b786"],

Cell[BoxData["5.157563294227618`"], "Output",
 CellChangeTimes->{{3.772271317019206*^9, 3.772271371608739*^9}, {
   3.7722714444306726`*^9, 3.7722714614577713`*^9}, {3.772377052184189*^9, 
   3.7723770678275757`*^9}, {3.7724386759228153`*^9, 
   3.7724386916198997`*^9}, {3.786938212130825*^9, 3.78693824175529*^9}, {
   3.786949974138298*^9, 3.786950004386189*^9}, 3.788403195265222*^9, 
   3.788417707637377*^9, 3.788504848582254*^9, 3.789126909962224*^9, 
   3.789200938702175*^9, 3.7892010614012327`*^9},
 ExpressionUUID -> "4a396a1c-1d3c-49fb-852b-3a3419c56a53"]
}, Closed]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "2", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.772446609960565*^9, 3.77244663048814*^9}},
 ExpressionUUID -> "3f249075-4a36-4214-9bcf-23cb9f7f6769"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k3_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7724396794898357`*^9, 3.7724397060260468`*^9}, {
  3.772440724815703*^9, 3.772440742543221*^9}, {3.7724409586980553`*^9, 
  3.77244096752039*^9}, {3.772444178684898*^9, 3.772444211812797*^9}, {
  3.772444537327029*^9, 3.7724445533573008`*^9}, {3.772444588189095*^9, 
  3.772444606004141*^9}, {3.772444671189715*^9, 3.772444702020938*^9}, {
  3.772444995707638*^9, 3.7724450008014936`*^9}, {3.7724453428234167`*^9, 
  3.772445360766842*^9}, {3.772445426351858*^9, 3.7724454327582607`*^9}},
 ExpressionUUID -> "2e644b95-b627-4079-adb2-1073c02aa249"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.77228212089924*^9, 3.7722822685852947`*^9}, {
  3.772282331266062*^9, 3.7722823318570957`*^9}, {3.772283463545506*^9, 
  3.77228349209052*^9}, {3.772283973641814*^9, 3.772283974411016*^9}},
 ExpressionUUID -> "b91787a4-d4c2-4ce5-8b44-c015bd8a8408"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]2", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]2"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c2_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}], ".", 
        RowBox[{"\[Rho]C", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
         "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq1", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k3_", ",", "k32_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c2", "*", 
      RowBox[{"P1", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k3", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c2"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k32_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq1", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "k32"}], "]"}], "+", 
      RowBox[{"Cq1", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "k32"}], "]"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7722839012647943`*^9, 3.772283977561111*^9}, {
   3.772284048121008*^9, 3.772284054048564*^9}, {3.772284087168202*^9, 
   3.772284088034628*^9}, {3.772284118360495*^9, 3.7722842019765167`*^9}, {
   3.772284253521983*^9, 3.7722843123126793`*^9}, {3.7722843547692547`*^9, 
   3.772284497593048*^9}, {3.7722845668810177`*^9, 3.772284648655345*^9}, {
   3.772284698048359*^9, 3.7722847759044867`*^9}, {3.772285010010169*^9, 
   3.772285045658825*^9}, {3.7722850761293716`*^9, 3.7722850960199213`*^9}, 
   3.772285178523724*^9, {3.77236447619662*^9, 3.7723645043822403`*^9}, {
   3.772364551064343*^9, 3.772364556213101*^9}, {3.772364601277505*^9, 
   3.772364614932653*^9}, {3.772364721701075*^9, 3.772364745892701*^9}, {
   3.7723654726780863`*^9, 3.7723656214619417`*^9}, 3.772365682158434*^9, {
   3.772368149215102*^9, 3.772368149564683*^9}, {3.772368990526123*^9, 
   3.772369009502626*^9}, {3.772369152968285*^9, 3.772369191208866*^9}, {
   3.772369270426837*^9, 3.7723692825048933`*^9}, {3.772370920799974*^9, 
   3.772370991798862*^9}, {3.772371046990074*^9, 3.772371068092149*^9}, {
   3.772371621786759*^9, 3.772371624106864*^9}, {3.772371947539008*^9, 
   3.772372102130176*^9}, {3.772376543946974*^9, 3.772376565306912*^9}, {
   3.772376674553438*^9, 3.772376690540468*^9}, {3.77237673847546*^9, 
   3.7723767616748953`*^9}, {3.772376828676401*^9, 3.772376910123201*^9}, {
   3.772436966608683*^9, 3.772436991934647*^9}, {3.772437088384615*^9, 
   3.7724371779271383`*^9}, {3.772437263415668*^9, 3.772437271287508*^9}, {
   3.772438707944784*^9, 3.7724389669530373`*^9}, {3.7724389991700687`*^9, 
   3.7724390125135593`*^9}, {3.7724393895462713`*^9, 3.772439398305973*^9}, {
   3.772439675603006*^9, 3.7724397014515657`*^9}, {3.7724397922900877`*^9, 
   3.772439795707053*^9}, 3.77244017684429*^9, {3.772440377162609*^9, 
   3.7724404581790733`*^9}, {3.7724455967282953`*^9, 3.772445640254805*^9}},
 ExpressionUUID -> "7955b6a1-3ecc-4f17-8df8-6064c711ff32"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "1.570796311143975`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "1.570796311143975`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "1.570796311143975`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "3.14159262938204`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"(", 
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cqa", "[", 
         RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
        RowBox[{"Cqa", "[", 
         RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
        RowBox[{"Cqa", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
        RowBox[{"Cqa", "[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cqa", "[", 
         RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
        RowBox[{"Cqa", "[", 
         RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
        RowBox[{"Cqa", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
        RowBox[{"Cqa", "[", 
         RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.772364525316143*^9, 3.77236452609298*^9}, {
   3.772372396937315*^9, 3.772372415001383*^9}, 3.77237311796066*^9, {
   3.7723737007755613`*^9, 3.7723737188240967`*^9}, {3.7723737525118113`*^9, 
   3.772373756559065*^9}, {3.772374940164611*^9, 3.7723749406118917`*^9}, {
   3.772375107172915*^9, 3.772375113276558*^9}, {3.772375341936801*^9, 
   3.772375342736553*^9}, {3.772375380288937*^9, 3.772375390719099*^9}, {
   3.772375893528729*^9, 3.7723759026335583`*^9}, {3.772376296394185*^9, 
   3.7723763437138243`*^9}, {3.7723763970667267`*^9, 3.772376404770289*^9}, {
   3.772377406392981*^9, 3.772377416216053*^9}, {3.772377466377136*^9, 
   3.772377490000616*^9}, {3.772377650720331*^9, 3.772377652744091*^9}, {
   3.7724405909234343`*^9, 3.772440591298102*^9}, {3.7724463631857977`*^9, 
   3.772446363385128*^9}, {3.772446401881209*^9, 3.7724464062492533`*^9}, {
   3.772446499817471*^9, 3.772446502425023*^9}, 3.786951480919549*^9, {
   3.786951537191986*^9, 3.786951538009397*^9}, 3.788417740188807*^9, {
   3.788417773965372*^9, 3.788417790324458*^9}, {3.7885048672307796`*^9, 
   3.7885048691674833`*^9}, {3.788505178119609*^9, 3.788505197999449*^9}, {
   3.7891276527324142`*^9, 3.789127692981007*^9}, {3.7891277362071657`*^9, 
   3.789127787406282*^9}},
 ExpressionUUID -> "0125a8ee-e2ea-4440-9c38-93c8958d717e"],

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{
   RowBox[{"2.96535956900712`*^-9", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Theta]32", "[", "0", "]"}], "]"}]}], "+", 
   RowBox[{"2.9653594579848175`*^-9", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Theta]32", "[", "1", "]"}], "]"}]}], "-", 
   RowBox[{"1.6212515774327585`*^-9", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Phi]32", "[", "0", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]32", "[", "0", "]"}], "]"}]}], "-", 
   RowBox[{"2.6389584337646834`", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"\[Phi]32", "[", "1", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]32", "[", "1", "]"}], "]"}]}], "+", 
   RowBox[{"2.6389584337646834`", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]32", "[", "0", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Phi]32", "[", "0", "]"}], "]"}]}], "+", 
   RowBox[{"1.6212515774327585`*^-9", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Theta]32", "[", "1", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Phi]32", "[", "1", "]"}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.786951539526147*^9, 3.788403283284645*^9, 3.788417753093202*^9, 
   3.788417792003619*^9, 3.788504876709836*^9, 3.788505198571817*^9, 
   3.788527914385002*^9, {3.789127750644786*^9, 3.7891277770833282`*^9}},
 ExpressionUUID -> "8800ef9a-f483-48c8-aa38-e6a32f39fefa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]32", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]32", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]32", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]32", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]32", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]32", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]32", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]32", "[", "1", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.772372354097027*^9, 3.77237236233624*^9}, {
   3.772372443194384*^9, 3.772372474312592*^9}, {3.7723731354007673`*^9, 
   3.772373151055459*^9}, {3.7723732098316793`*^9, 3.772373229199974*^9}, {
   3.772375054196787*^9, 3.772375060108384*^9}, {3.772375288094521*^9, 
   3.77237529634181*^9}, {3.7869515679472923`*^9, 3.78695160437245*^9}, 
   3.7891278076069603`*^9},
 ExpressionUUID -> "10b86dda-618e-4330-8d42-45d0e7c462f8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.277916867529364`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]32", "[", "0", "]"}], "\[Rule]", 
      "1.5707963077751086`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]32", "[", "0", "]"}], "\[Rule]", "1.5707963102540259`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]32", "[", "1", "]"}], "\[Rule]", 
      "1.5707963047692408`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]32", "[", "1", "]"}], "\[Rule]", 
      "3.141592616929849`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.772372229656629*^9, 3.772372427272305*^9, 3.772372475519308*^9, 
   3.7723732602921667`*^9, 3.772373482983139*^9, {3.772373704251555*^9, 
   3.772373721980921*^9}, 3.772373761250647*^9, 3.772374945591619*^9, 
   3.772375079772977*^9, 3.7723752442666407`*^9, {3.772375334703947*^9, 
   3.772375394957336*^9}, 3.772375957103389*^9, 3.772376359270447*^9, 
   3.772376919121994*^9, 3.77237709215241*^9, 3.772436894880805*^9, 
   3.7724370010461493`*^9, 3.772437194065012*^9, {3.772438480686203*^9, 
   3.772438502038825*^9}, 3.7724390377592154`*^9, 3.772441650660499*^9, {
   3.772444252492063*^9, 3.772444281576799*^9}, 3.772444872222376*^9, {
   3.7724450183494797`*^9, 3.7724450242489843`*^9}, 3.7724461857781763`*^9, 
   3.772446304043872*^9, 3.772446369438727*^9, 3.772446440792738*^9, 
   3.786951608251514*^9, 3.788403285562394*^9, 3.789127820756001*^9},
 ExpressionUUID -> "a4a8fab4-0d2d-429e-95a0-7fa722c07e3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cqa", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.772436873702003*^9, 3.7724368822296553`*^9}, {
  3.7724468352123613`*^9, 3.772446844388261*^9}, {3.772447111884777*^9, 
  3.7724471174607687`*^9}, {3.7724978712333593`*^9, 3.772497912648322*^9}, {
  3.78695169401723*^9, 3.786951733669908*^9}, {3.788417850822073*^9, 
  3.788417875162993*^9}, {3.7885048984081087`*^9, 3.78850490022124*^9}, {
  3.7885049637432623`*^9, 3.788504971943903*^9}, {3.789127867692544*^9, 
  3.789127950712708*^9}},
 ExpressionUUID -> "e7486f23-b82d-49ce-8ab4-4d276ac7a06c"],

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"5.277916867529365`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "\[Lambda]2"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.7891279515492697`*^9, 3.78912799433313*^9},
 ExpressionUUID -> "d1ca54bd-1e84-4267-a1f1-da4fbab9df15"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "3", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 3.772446673256187*^9}},
 ExpressionUUID -> "ed85c150-8aae-46f6-a609-15e722a46d32"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.7885268286539927`*^9, 
  3.7885268367000723`*^9}, {3.788527947492606*^9, 3.788527998438003*^9}},
 ExpressionUUID -> "5882f9e6-48d1-4d7d-9563-2e3271f5db5a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 ExpressionUUID -> "e37cd598-5761-4cfd-8269-c6d70f1c8ab2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]3", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]3"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}], ".", 
        RowBox[{"\[Rho]C2", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
          "c1", ",", "c2"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq2", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_"}], "]"}],
    ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c3", "*", 
      RowBox[{"P2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c3"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa2", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k33_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "4"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "0", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "1", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "0", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "1", ",", "k33"}], "]"}]}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
  3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
  3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
  3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
  3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
  3.772497266889743*^9, 3.772497283714591*^9}},
 ExpressionUUID -> "dd369b2b-3d98-4c18-827e-7050691d1ffc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", ".5359"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]33", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]33", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]33", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]33", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]33", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]33", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]33", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]33", "[", "1", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
   3.772497498585828*^9, 3.7724974998972387`*^9}, 3.786951827168229*^9, {
   3.786952027605308*^9, 3.786952028120904*^9}, {3.788417977574526*^9, 
   3.788418005292028*^9}, {3.788505016828611*^9, 3.788505040850543*^9}, {
   3.788505347529038*^9, 3.788505387256744*^9}, {3.7885075593287783`*^9, 
   3.788507563502396*^9}, {3.788525437822459*^9, 3.788525456217333*^9}, {
   3.788525604031497*^9, 3.788525609764406*^9}, {3.78852673271002*^9, 
   3.7885267373254757`*^9}, {3.788526877907447*^9, 3.788526878688282*^9}, 
   3.7891281352614107`*^9, {3.789128176897237*^9, 3.7891281929650917`*^9}, {
   3.789128223328335*^9, 3.789128281199205*^9}, {3.789128314461021*^9, 
   3.7891283242772913`*^9}},
 ExpressionUUID -> "5cacf892-67b8-4b5b-99d6-63000be3e699"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.895588729576019`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]33", "[", "0", "]"}], "\[Rule]", 
      "1.5707962669258666`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]33", "[", "0", "]"}], "\[Rule]", "1.5707963327202843`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]33", "[", "1", "]"}], "\[Rule]", 
      "1.5707963153687352`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]33", "[", "1", "]"}], "\[Rule]", 
      "3.1415926319484364`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.786952030445326*^9, 3.788403509990912*^9, 3.788418009243689*^9, 
   3.788505109315648*^9, 3.788505389461739*^9, 3.7885075669729567`*^9, 
   3.78852545903231*^9, {3.788525586124011*^9, 3.788525612342093*^9}, 
   3.78852673984638*^9, 3.788526857613781*^9, {3.7885268927658863`*^9, 
   3.788526909185995*^9}, 3.78852803314091*^9, 3.789128267549741*^9, 
   3.789128329835527*^9},
 ExpressionUUID -> "5c154501-67f0-4825-b78f-b3eaf9b14e3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]2", "=", ".5359"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa2", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa2", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.789128415124468*^9, 3.7891284625482807`*^9}, {
  3.789128515068514*^9, 3.789128529975288*^9}},
 ExpressionUUID -> "ccf26a95-5d9e-4135-a069-aba3bb0227a7"],

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"4.895588729576011`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "\[Lambda]3"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.789128548173873*^9},
 ExpressionUUID -> "719aad22-e164-4b1c-adba-b53b1ed41f56"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "4", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 3.772446673256187*^9}, {
  3.78850552085009*^9, 3.788505521009758*^9}},
 ExpressionUUID -> "1ee07560-416d-4bb6-a524-70f0098ef26e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.788505542371722*^9, 
  3.788505605029366*^9}, {3.788505642928162*^9, 3.7885057368340693`*^9}, {
  3.78850579391327*^9, 3.788505806595009*^9}, {3.788505890359621*^9, 
  3.7885058904771748`*^9}, {3.788505951296496*^9, 3.788505954015854*^9}, {
  3.7885072816982727`*^9, 3.7885072830730047`*^9}, {3.7885078381511087`*^9, 
  3.7885078473793573`*^9}, {3.788528048196356*^9, 3.7885281019585457`*^9}},
 ExpressionUUID -> "547fd919-72b2-45be-b707-9afc0399edc4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 ExpressionUUID -> "3158528c-8abb-44ff-afd9-bd83bf70b92a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]4", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]4"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}], ".", 
        RowBox[{"\[Rho]C3", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
          "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_"}], 
    "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c4", "*", 
      RowBox[{"P3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c4"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa3", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k34_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "8"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "k34"}], 
       "]"}]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
   3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
   3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
   3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
   3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
   3.772497266889743*^9, 3.772497283714591*^9}, {3.7885059332211246`*^9, 
   3.7885060376788197`*^9}, {3.788506090352417*^9, 3.788506124005931*^9}, {
   3.788506157241295*^9, 3.788506237809791*^9}, {3.7885063054913387`*^9, 
   3.788506309646616*^9}, {3.788506397431932*^9, 3.788506608133604*^9}, {
   3.788507413570815*^9, 3.788507476866868*^9}, {3.788507524353386*^9, 
   3.788507532318859*^9}, {3.78850775211344*^9, 3.788507819111685*^9}, 
   3.788525024995199*^9, {3.78852510891088*^9, 3.788525150041354*^9}, 
   3.788526026332473*^9, {3.788526935212297*^9, 3.788526945977172*^9}},
 ExpressionUUID -> "eb83097c-9ea2-4dbc-9510-2461dd33ca2c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", ".5778"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", ".5359"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa3", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa3", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa3", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa3", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa3", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa3", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa3", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa3", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]34", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]34", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]34", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]34", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]34", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]34", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]34", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]34", "[", "1", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
   3.772497498585828*^9, 3.7724974998972387`*^9}, 3.786951827168229*^9, {
   3.786952027605308*^9, 3.786952028120904*^9}, {3.788417977574526*^9, 
   3.788418005292028*^9}, {3.788505016828611*^9, 3.788505040850543*^9}, {
   3.788505347529038*^9, 3.788505387256744*^9}, {3.788507619185297*^9, 
   3.788507648252692*^9}, {3.788507684220276*^9, 3.7885077214691772`*^9}, {
   3.788507868300164*^9, 3.7885078865728292`*^9}, {3.78850810106927*^9, 
   3.788508105479485*^9}, {3.78852518365519*^9, 3.788525247917734*^9}, {
   3.788525287512992*^9, 3.788525291032343*^9}, 3.788526044406982*^9, {
   3.788526129122316*^9, 3.788526150362542*^9}, {3.788526767555501*^9, 
   3.788526807188422*^9}, {3.788526988003459*^9, 3.788526997686419*^9}, {
   3.7891286478268633`*^9, 3.789128723092886*^9}, {3.789128777222559*^9, 
   3.789128858171595*^9}},
 ExpressionUUID -> "04e08467-cbf8-4da2-9b95-ae98daaf964e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.41965387169347`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]34", "[", "0", "]"}], "\[Rule]", 
      "1.5707963053047411`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]34", "[", "0", "]"}], "\[Rule]", "1.570796321614194`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]34", "[", "1", "]"}], "\[Rule]", 
      "1.570796286199058`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]34", "[", "1", "]"}], "\[Rule]", 
      "3.1415926289601117`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.789128731106352*^9, {3.7891288341937437`*^9, 3.789128863869629*^9}},
 ExpressionUUID -> "1a4479c0-4e2d-4142-af30-f5764ab37752"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]3", "=", ".5778"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", ".5359"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa3", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa3", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cqa3", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa3", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa3", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa3", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa3", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa3", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.789128942956366*^9, 3.789129034772654*^9}},
 ExpressionUUID -> "c3ff25fb-e298-4b91-9411-ecaead5a464a"],

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"4.419653871693471`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "\[Lambda]4"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.7891290308383703`*^9, 3.78912906625397*^9},
 ExpressionUUID -> "d978c7d3-09be-44fe-9948-e34e12c6a7cd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "5", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.788526338083778*^9, 3.788526339620455*^9}},
 ExpressionUUID -> "a58030dd-5466-44aa-8266-45352408fca3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.788505542371722*^9, 
  3.788505605029366*^9}, {3.788505642928162*^9, 3.7885057368340693`*^9}, {
  3.78850579391327*^9, 3.788505806595009*^9}, {3.788505890359621*^9, 
  3.7885058904771748`*^9}, {3.788505951296496*^9, 3.788505954015854*^9}, {
  3.7885072816982727`*^9, 3.7885072830730047`*^9}, {3.7885078381511087`*^9, 
  3.7885078473793573`*^9}, {3.788526350589307*^9, 3.78852646328999*^9}, {
  3.788528161658049*^9, 3.788528278750496*^9}},
 ExpressionUUID -> "0cad7bec-353e-461b-99e4-b9ed22656db0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 ExpressionUUID -> "a896f892-3fc4-446d-b415-1d4dee8d7ec3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]5", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]5"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}], ".", 
        RowBox[{"\[Rho]C4", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], 
         "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c5", "*", 
      RowBox[{"P4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "a1", ",", "b1", ",", "c5"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa4", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k35_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "16"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "k35"}], 
       "]"}]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
   3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
   3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
   3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
   3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
   3.772497266889743*^9, 3.772497283714591*^9}, {3.7885059332211246`*^9, 
   3.7885060376788197`*^9}, {3.788506090352417*^9, 3.788506124005931*^9}, {
   3.788506157241295*^9, 3.788506237809791*^9}, {3.7885063054913387`*^9, 
   3.788506309646616*^9}, {3.788506397431932*^9, 3.788506608133604*^9}, {
   3.788507413570815*^9, 3.788507476866868*^9}, {3.788507524353386*^9, 
   3.788507532318859*^9}, {3.78850775211344*^9, 3.788507819111685*^9}, 
   3.788525024995199*^9, {3.78852510891088*^9, 3.788525150041354*^9}, 
   3.788526026332473*^9, {3.788526477828945*^9, 3.788526596457444*^9}, {
   3.788527079592304*^9, 3.7885273464525337`*^9}, {3.788527620600141*^9, 
   3.78852762070826*^9}},
 ExpressionUUID -> "8103f362-5303-4bb9-91be-de396a645742"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", ".6399"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", ".5778"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", ".5359"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa4", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa4", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa4", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa4", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa4", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa4", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa4", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa4", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]35", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]35", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]35", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]35", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]35", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]35", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]35", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]35", "[", "1", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
   3.772497498585828*^9, 3.7724974998972387`*^9}, 3.786951827168229*^9, {
   3.786952027605308*^9, 3.786952028120904*^9}, {3.788417977574526*^9, 
   3.788418005292028*^9}, {3.788505016828611*^9, 3.788505040850543*^9}, {
   3.788505347529038*^9, 3.788505387256744*^9}, {3.788507619185297*^9, 
   3.788507648252692*^9}, {3.788507684220276*^9, 3.7885077214691772`*^9}, {
   3.788507868300164*^9, 3.7885078865728292`*^9}, {3.78850810106927*^9, 
   3.788508105479485*^9}, {3.78852518365519*^9, 3.788525247917734*^9}, {
   3.788525287512992*^9, 3.788525291032343*^9}, 3.788526044406982*^9, {
   3.788526129122316*^9, 3.788526150362542*^9}, {3.788527357013254*^9, 
   3.788527425793359*^9}, {3.788527528334896*^9, 3.788527538093656*^9}, {
   3.789129199721053*^9, 3.789129281906986*^9}, {3.789129313341147*^9, 
   3.789129324130516*^9}},
 ExpressionUUID -> "07f38fb7-8e1f-41c8-9add-209018c56b00"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.9079865434998524`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]35", "[", "0", "]"}], "\[Rule]", 
      "1.5707963067935353`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]35", "[", "0", "]"}], "\[Rule]", "1.570796313492113`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]35", "[", "1", "]"}], "\[Rule]", 
      "1.570796303405606`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]35", "[", "1", "]"}], "\[Rule]", 
      "3.1415926190846193`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.788527385584641*^9, 3.788527448082528*^9, 
  3.788527563169582*^9, 3.788527645336762*^9, 3.788528318045309*^9, 
  3.7891293080616627`*^9, 3.789129347847287*^9},
 ExpressionUUID -> "13f9a6cc-2e03-4fb9-8c1a-93b5b892b544"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]4", "=", ".6399"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", ".5778"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", ".5359"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa4", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa4", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cqa4", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa4", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa4", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa4", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa4", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa4", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.789129375049038*^9, 3.789129397779313*^9}},
 ExpressionUUID -> "a6e9bc58-8d71-43e2-845b-d9f1d2f8f6c3"],

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"3.9079865434998524`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "\[Lambda]5"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.7891294253814573`*^9, 3.789129467978674*^9},
 ExpressionUUID -> "04593086-1470-4769-b169-c509cff6e95d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "6", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.788526338083778*^9, 3.788526339620455*^9}, {
  3.788527725308695*^9, 3.78852772634177*^9}},
 ExpressionUUID -> "84f055c8-0ca9-4a7c-a6ee-8761c77be87d"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]0", "=", 
     RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]1", "=", 
     RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]2", "=", 
     RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]3", "=", 
     RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1"},
        {"0"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d", "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0"},
        {"1"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]GHZ", "=", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"x1", "[", 
      RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"\[Sigma]0", "+", 
        RowBox[{"a1", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
           "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
           "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
            "\[Sigma]3"}]}], ")"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"y2", "[", 
      RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"\[Sigma]0", "+", 
        RowBox[{"b1", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
           "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
           "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
            "\[Sigma]3"}]}], ")"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zR31", "[", 
      RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c1", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"c1", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zR32", "[", 
      RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c2", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"c2", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zR33", "[", 
      RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c3", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"c3", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zR34", "[", 
      RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c4", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"c4", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zR35", "[", 
      RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "+", "\[Lambda]5"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c5", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "-", "\[Lambda]5"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"c5", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
      "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"x1", "[", 
           RowBox[{"i1", ",", "a1"}], "]"}], ",", 
          RowBox[{"y2", "[", 
           RowBox[{"j2", ",", "b1"}], "]"}], ",", 
          RowBox[{"zR31", "[", 
           RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", 
       "\[Rho]GHZ", ".", 
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"x1", "[", 
           RowBox[{"i1", ",", "a1"}], "]"}], ",", 
          RowBox[{"y2", "[", 
           RowBox[{"j2", ",", "b1"}], "]"}], ",", 
          RowBox[{"zR31", "[", 
           RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", 
       ",", "c1_", ",", "c2_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR32", "[", 
           RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
       RowBox[{"\[Rho]ABC1", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], "]"}],
        ".", 
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR32", "[", 
           RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", 
       ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR33", "[", 
           RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
       RowBox[{"\[Rho]ABC2", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
         "c1", ",", "c2"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR33", "[", 
           RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", 
       "c4_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR34", "[", 
           RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
       RowBox[{"\[Rho]ABC3", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
         "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR34", "[", 
           RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", 
       "c3_", ",", "c4_", ",", "c5_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR35", "[", 
           RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
       RowBox[{"\[Rho]ABC4", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}],
        ".", 
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR35", "[", 
           RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.788505542371722*^9, 
  3.788505605029366*^9}, {3.788505642928162*^9, 3.7885057368340693`*^9}, {
  3.78850579391327*^9, 3.788505806595009*^9}, {3.788505890359621*^9, 
  3.7885058904771748`*^9}, {3.788505951296496*^9, 3.788505954015854*^9}, {
  3.7885072816982727`*^9, 3.7885072830730047`*^9}, {3.7885078381511087`*^9, 
  3.7885078473793573`*^9}, {3.788526350589307*^9, 3.78852646328999*^9}, {
  3.788527735676673*^9, 3.788527853571287*^9}, {3.788528330826366*^9, 
  3.788528373028413*^9}, {3.7885293082994843`*^9, 3.788529319073097*^9}, {
  3.78913328387868*^9, 3.7891332968518763`*^9}, {3.7891965320218477`*^9, 
  3.789196539338902*^9}},
 ExpressionUUID -> "b0be8cd5-2d2e-4e6f-ac1b-74c53686f4fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.789131074462988*^9},
 ExpressionUUID -> "ff9e4b7b-3739-4d2a-97b7-f2e5aa1aa8fa"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]BC5", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", 
       "c3_", ",", "c4_", ",", "c5_"}], "]"}], ":=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"TraceSystem", "[", 
       RowBox[{
        RowBox[{"\[Rho]ABC5", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
          "c4", ",", "c5"}], "]"}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]C5", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", 
       "c3_", ",", "c4_", ",", "c5_"}], "]"}], ":=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"TraceSystem", "[", 
       RowBox[{
        RowBox[{"\[Rho]BC5", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
          "c4", ",", "c5"}], "]"}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"z36", "[", 
      RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Lambda]6", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c6", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Lambda]6"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P5", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c6_"}], "]"}], 
     ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"z36", "[", 
           RowBox[{"k36", ",", "c6"}], "]"}], ".", 
          RowBox[{"\[Rho]C5", "[", 
           RowBox[{
           "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", 
            ",", "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3",
             ",", "c4", ",", "c5"}], "]"}]}], "]"}], ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"c1", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c2", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c3", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c4", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c5", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Cq5", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "k36_"}], "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"a1", "*", "b1", "*", "c6", "*", 
        RowBox[{"P5", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c6"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"a1", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b1", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c6", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cqa5", "[", 
     RowBox[{"i1_", ",", "j2_", ",", "k36_"}], "]"}], ":=", 
    RowBox[{
     FractionBox["1", "32"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "1", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "1", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "0", 
         ",", "k36"}], "]"}], "+", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", 
         ",", "k36"}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.789133324180932*^9, 3.789133594576436*^9}, {
   3.789133649072295*^9, 3.789133786176893*^9}, {3.789133859006772*^9, 
   3.7891338599195623`*^9}, 3.789133998990376*^9, {3.789134111251547*^9, 
   3.789134112017708*^9}},
 ExpressionUUID -> "257abe9b-e931-4eb9-a931-30bb0bc4200a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]6", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", ".7237"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", ".6399"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", ".5778"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", ".5359"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa5", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa5", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa5", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa5", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa5", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa5", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa5", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa5", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]36", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]36", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]36", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]36", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]36", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]36", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]36", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]36", "[", "1", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7891295918724337`*^9, 3.789129614184042*^9}, {
  3.789129648751705*^9, 3.7891297072878428`*^9}, {3.789130966787888*^9, 
  3.789130993011643*^9}},
 ExpressionUUID -> "18c1dc2b-4432-46f7-8c0e-e2b81363d0c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.3024707826695794`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]36", "[", "0", "]"}], "\[Rule]", 
      "1.5694994873924717`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]36", "[", "0", "]"}], "\[Rule]", "1.5712296742410834`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]36", "[", "1", "]"}], "\[Rule]", 
      "1.5702222457551471`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]36", "[", "1", "]"}], "\[Rule]", 
      "3.141139765757086`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.789134221141021*^9, 3.789196512871078*^9, 
  3.7891966709404697`*^9},
 ExpressionUUID -> "a833fac5-bf6c-4213-adca-255fc67a3eb0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]5", "=", ".7237"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", ".6399"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", ".5778"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", ".5359"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "1.5707963077751086`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "1.5707963102540259`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "1.5707963047692408`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "3.141592616929849`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa5", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa5", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cqa5", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa5", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cqa5", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa5", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa5", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa5", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
   3.772497498585828*^9, 3.7724974998972387`*^9}, 3.786951827168229*^9, {
   3.786952027605308*^9, 3.786952028120904*^9}, {3.788417977574526*^9, 
   3.788418005292028*^9}, {3.788505016828611*^9, 3.788505040850543*^9}, {
   3.788505347529038*^9, 3.788505387256744*^9}, {3.788507619185297*^9, 
   3.788507648252692*^9}, {3.788507684220276*^9, 3.7885077214691772`*^9}, {
   3.788507868300164*^9, 3.7885078865728292`*^9}, {3.78850810106927*^9, 
   3.788508105479485*^9}, {3.78852518365519*^9, 3.788525247917734*^9}, {
   3.788525287512992*^9, 3.788525291032343*^9}, 3.788526044406982*^9, {
   3.788526129122316*^9, 3.788526150362542*^9}, {3.788527357013254*^9, 
   3.788527425793359*^9}, {3.788527528334896*^9, 3.788527538093656*^9}, {
   3.78852882073094*^9, 3.7885288663222523`*^9}, {3.788529044845997*^9, 
   3.78852904685413*^9}, {3.789134303851954*^9, 3.78913433798516*^9}},
 ExpressionUUID -> "1b88c73a-0d70-4f33-95cf-d69196c9b35f"],

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"3.3024727676373877`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "\[Lambda]6"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.7885289630170527`*^9, 3.788529154284326*^9, 
  3.7885294786060457`*^9, 3.788606088526307*^9, 3.789134489557469*^9},
 ExpressionUUID -> "0239d94f-f99d-44dc-870b-64cde6f96905"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "7", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{3.789134520774382*^9},
 ExpressionUUID -> "2b77d486-babc-4cf7-9b2f-b312cebf0e62"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
       "c4", ",", "c5"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.789134517362254*^9, 3.789134517710101*^9}, {
  3.789187678806168*^9, 3.789187833832885*^9}, {3.7891967033315*^9, 
  3.789196711008957*^9}, {3.7891973520229197`*^9, 3.78919736265625*^9}},
 ExpressionUUID -> "60db60f0-d67e-47a9-9dbc-cc1ced66ad66"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.789131074462988*^9},
 ExpressionUUID -> "ff9e4b7b-3739-4d2a-97b7-f2e5aa1aa8fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC6", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
        "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC6", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
        "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z37", "[", 
    RowBox[{"k37_", ",", "c7_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]7", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]6"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}], ".", 
        RowBox[{"\[Rho]C6", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",",
           "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c6", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c7", "*", 
      RowBox[{"P6", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c7"}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c7", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa6", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k37_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "64"], 
    RowBox[{"(", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Cq6", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "k35", ",", "k36", ",", "k37"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k36", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.789133324180932*^9, 3.789133594576436*^9}, {
   3.789133649072295*^9, 3.789133786176893*^9}, {3.789133859006772*^9, 
   3.7891338599195623`*^9}, 3.789133998990376*^9, {3.789134111251547*^9, 
   3.789134112017708*^9}, {3.7891878739003153`*^9, 3.789187924341144*^9}, {
   3.789195477998372*^9, 3.789195740139311*^9}, {3.789195787459426*^9, 
   3.789195802733355*^9}, {3.7891958612415257`*^9, 3.789195861742977*^9}, {
   3.789196737698279*^9, 3.789196766154516*^9}, {3.789197272428116*^9, 
   3.789197318382045*^9}},
 ExpressionUUID -> "257abe9b-e931-4eb9-a931-30bb0bc4200a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]7", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]6", "=", ".8565"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", ".7237"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", ".6399"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", ".5778"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", ".5359"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "\[Pi]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "1.5707962669258666`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "3.1415926319484364`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", "1.5707963077751086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "3.1415926319484364"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa6", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa6", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa6", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa6", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cqa6", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa6", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa6", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa6", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]37", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]37", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]37", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]37", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]37", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]37", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]37", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]37", "[", "1", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7891958717324867`*^9, 3.789195878630331*^9}, {
   3.789195922867941*^9, 3.7891960289598*^9}, 3.789196309359455*^9, {
   3.7891974475824537`*^9, 3.789197470656755*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.50351562388479`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]37", "[", "0", "]"}], "\[Rule]", 
      "1.5694994873924717`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]37", "[", "0", "]"}], "\[Rule]", "1.5712296742410834`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]37", "[", "1", "]"}], "\[Rule]", 
      "1.5702222457551471`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]37", "[", "1", "]"}], "\[Rule]", 
      "3.141139765757086`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.789196032595972*^9, 3.7891960448776293`*^9}, 
   3.789197214353155*^9, 3.789197896942819*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Mermin", " ", "inequality", " ", 
  RowBox[{"(", 
   RowBox[{"1", "SDI"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.7724980892249603`*^9, 3.7724980984561377`*^9}, {
  3.772622619043507*^9, 3.772622619844865*^9}, {3.7884040929491053`*^9, 
  3.7884041063966618`*^9}, {3.790077531305091*^9, 3.790077546082127*^9}},
 ExpressionUUID -> "19fa0dcd-855d-4860-94ba-2c16468d413c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "1"}], " ", "*)"}]], "Input",ExpressionUUID->\
"7ec02596-0ac4-408f-90b2-72f5b33f1482"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z31", "[", 
    RowBox[{"k3_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]1", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]1"}], ")"}], "\[Sigma]0"}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"x1", "[", 
        RowBox[{"i1", ",", "a1"}], "]"}], ",", 
       RowBox[{"y2", "[", 
        RowBox[{"j2", ",", "b1"}], "]"}], ",", 
       RowBox[{"z31", "[", 
        RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ".", "\[Rho]GHZ"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k3_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c1", "*", 
      RowBox[{"P", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cq", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cq", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}]}], "Input",
 CellChangeTimes->{{3.77249821646313*^9, 3.7724982615591297`*^9}, {
   3.772498326927515*^9, 3.772498378903017*^9}, 3.772515431709477*^9, 
   3.7725179566695127`*^9, {3.772621601812951*^9, 3.7726216119893436`*^9}, 
   3.7726221478638973`*^9, {3.7726224611983147`*^9, 3.7726224843115273`*^9}, {
   3.788404396037445*^9, 3.788404475851364*^9}, {3.788405683985794*^9, 
   3.788405684328183*^9}, {3.78840610603273*^9, 3.788406112071198*^9}, {
   3.788418787114934*^9, 3.7884188075987167`*^9}},
 ExpressionUUID -> "f22a83cd-730f-4699-bc79-c30eb71807e6"],

Cell[BoxData[
 RowBox[{"\[Lambda]1", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.772622485169671*^9, 3.772622544923791*^9, 3.7726227382322607`*^9, {
   3.7726228325300837`*^9, 3.772622855076285*^9}, 3.772786702420631*^9, {
   3.772789587565178*^9, 3.7727896079387207`*^9}, 3.772794226237019*^9, 
   3.788404515900132*^9, 3.788404575124097*^9, 3.7884057027490664`*^9, 
   3.788406112696308*^9, 3.788418819215728*^9, 3.790074109436862*^9, 
   3.790077219322894*^9},
 ExpressionUUID -> "fd178a15-a111-4fc9-96f7-b08df7977489"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]2", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]2", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]2", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]2", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]1", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]1", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]1", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]1", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", "\[Lambda]1", "\[LessEqual]", "1"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]1", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]1", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]1", "[", "1", "]"}], ",", 
     RowBox[{"\[Theta]2", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]2", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]2", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]2", "[", "1", "]"}], ",", 
     RowBox[{"\[Theta]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]31", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "1", "]"}], ",", "\[Lambda]1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.790077222702572*^9, 3.790077368875183*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.9999999999999964`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]1", "[", "0", "]"}], "\[Rule]", 
      "1.5707963034830772`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]1", "[", "0", "]"}], "\[Rule]", "2.673512388571978`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]1", "[", "1", "]"}], "\[Rule]", 
      "1.5707963034840278`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]1", "[", "1", "]"}], "\[Rule]", "1.1027160855022464`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "0", "]"}], "\[Rule]", 
      "1.5707963034838648`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "0", "]"}], "\[Rule]", "2.377006456108183`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "1", "]"}], "\[Rule]", 
      "1.5707963034839716`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "1", "]"}], "\[Rule]", "0.8062101639548164`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[Rule]", 
      "1.570796303480799`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[Rule]", "2.8034627373204626`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[Rule]", 
      "1.5707963015441673`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[Rule]", "1.2326664233264781`"}],
      ",", 
     RowBox[{"\[Lambda]1", "\[Rule]", "1.`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.79007746705367*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "2.673512376641986`"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", "1.1027160855022464`"}], 
  ";"}], "\n", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]2", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]2", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]2", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]2", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]2", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]2", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]2", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]2", "[", "1", "]"}], ",", 
     RowBox[{"\[Theta]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]31", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "1", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"\[Lambda]1", ",", 
   RowBox[{"\[Theta]1", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]1", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]1", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]1", "[", "1", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.78840459892087*^9, 3.788404606432736*^9}, {
  3.788404664130967*^9, 3.788404679549321*^9}, {3.788405716203868*^9, 
  3.788405731585127*^9}, {3.790077160001299*^9, 3.79007718845403*^9}, {
  3.790077446207488*^9, 3.7900774745332212`*^9}},
 ExpressionUUID -> "95566020-e947-45e2-8efc-18b7763c65b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.999999999999998`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]2", "[", "0", "]"}], "\[Rule]", 
      "1.5707963050875973`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "0", "]"}], "\[Rule]", "2.481214463027986`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "1", "]"}], "\[Rule]", 
      "1.5707963017628122`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "1", "]"}], "\[Rule]", "0.9104181180031905`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[Rule]", 
      "1.5707963161284482`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[Rule]", "2.6992547712159434`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[Rule]", 
      "1.5707963043034694`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[Rule]", 
      "1.128458445034426`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.788404682413925*^9, 3.7884057327494297`*^9, 
  3.790074119558981*^9, 3.7900771902328377`*^9, 3.790077475961832*^9},
 ExpressionUUID -> "a36f0058-bd73-49b4-83b9-596fa72f38b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"\[Lambda]1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Lambda]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
       ")"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]31", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "1", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]1", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]1", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]1", "[", "1", "]"}], ",", 
   RowBox[{"\[Theta]2", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]2", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]2", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]2", "[", "1", "]"}], ",", 
   RowBox[{"\[Theta]31", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]31", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]31", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]31", "[", "1", "]"}], ",", "\[Lambda]1"}], "]"}]}], "Input",\

 CellChangeTimes->{{3.772622354157689*^9, 3.772622376252776*^9}, {
  3.772622522285799*^9, 3.7726225335324497`*^9}, {3.7726227209900293`*^9, 
  3.772622734117029*^9}, {3.772622821181335*^9, 3.772622840997213*^9}, {
  3.772789570998803*^9, 3.7727895964308434`*^9}, {3.7884047056257553`*^9, 
  3.788404788097951*^9}, {3.788404867514967*^9, 3.788404868926124*^9}, {
  3.7884049411511917`*^9, 3.788404967748184*^9}, {3.788405005032954*^9, 
  3.78840500910767*^9}, {3.788405819228973*^9, 3.7884059886727333`*^9}, {
  3.788418883211781*^9, 
  3.788419065562502*^9}},ExpressionUUID->"b4cb408e-37d4-4195-9f90-\
46f896bd4ab0"],

Cell[BoxData[
 RowBox[{"4", " ", "\[Lambda]1"}]], "Output",
 CellChangeTimes->{
  3.772622422852728*^9, 3.7726224996406193`*^9, 3.788404841670538*^9, 
   3.788404872611307*^9, {3.788404944947702*^9, 3.78840497213763*^9}, 
   3.788405014106427*^9, {3.788405894036092*^9, 3.78840590697775*^9}, 
   3.78840593741039*^9, {3.7884059720128393`*^9, 3.7884059900014067`*^9}, 
   3.788419001079917*^9, 
   3.7884190677464457`*^9},ExpressionUUID->"40c52c75-0151-4e3e-8303-\
4e28c947834f"],

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"4", " ", "\[Lambda]1"}], ",", "True", ",", "False", ",", "True",
      ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["\[Pi]", "2"], ",", 
     RowBox[{"-", 
      FractionBox["\[Pi]", "2"]}], ",", 
     FractionBox["\[Pi]", "2"], ",", "0"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.772622422852728*^9, 3.7726224996406193`*^9, 3.788404841670538*^9, 
   3.788404872611307*^9, {3.788404944947702*^9, 3.78840497213763*^9}, 
   3.788405014106427*^9, {3.788405894036092*^9, 3.78840590697775*^9}, 
   3.78840593741039*^9, {3.7884059720128393`*^9, 3.7884059900014067`*^9}, 
   3.788419001079917*^9, 
   3.788419067813614*^9},ExpressionUUID->"003358ae-37b2-41ab-8bc5-\
9943879aa53f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "4"}]], "Input",
 CellChangeTimes->{{3.79007755747184*^9, 3.7900775765392838`*^9}}],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"2", " ", 
   SqrtBox["2"]}]]], "Output",
 CellChangeTimes->{3.7900775776607037`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "2", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.772446609960565*^9, 
  3.77244663048814*^9}},ExpressionUUID->"cbd8ac55-e055-42b6-8d06-\
ab5ae9da21a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k3_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7724396794898357`*^9, 3.7724397060260468`*^9}, {
  3.772440724815703*^9, 3.772440742543221*^9}, {3.7724409586980553`*^9, 
  3.77244096752039*^9}, {3.772444178684898*^9, 3.772444211812797*^9}, {
  3.772444537327029*^9, 3.7724445533573008`*^9}, {3.772444588189095*^9, 
  3.772444606004141*^9}, {3.772444671189715*^9, 3.772444702020938*^9}, {
  3.772444995707638*^9, 3.7724450008014936`*^9}, {3.7724453428234167`*^9, 
  3.772445360766842*^9}, {3.772445426351858*^9, 3.7724454327582607`*^9}, {
  3.7884056603763523`*^9, 3.788405668477664*^9}},
 ExpressionUUID -> "3701a4b7-6d14-4728-8a52-714e1f12ed2f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.77228212089924*^9, 3.7722822685852947`*^9}, {
  3.772282331266062*^9, 3.7722823318570957`*^9}, {3.772283463545506*^9, 
  3.77228349209052*^9}, {3.772283973641814*^9, 3.772283974411016*^9}},
 ExpressionUUID -> "edb0369a-8727-48be-abea-1505c1db6015"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]2", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]2"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c2_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}], ".", 
        RowBox[{"\[Rho]C", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
         "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq1", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k3_", ",", "k32_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c2", "*", 
      RowBox[{"P1", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k3", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c2"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k32_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq1", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "k32"}], "]"}], "+", 
      RowBox[{"Cq1", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "k32"}], "]"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7722839012647943`*^9, 3.772283977561111*^9}, {
   3.772284048121008*^9, 3.772284054048564*^9}, {3.772284087168202*^9, 
   3.772284088034628*^9}, {3.772284118360495*^9, 3.7722842019765167`*^9}, {
   3.772284253521983*^9, 3.7722843123126793`*^9}, {3.7722843547692547`*^9, 
   3.772284497593048*^9}, {3.7722845668810177`*^9, 3.772284648655345*^9}, {
   3.772284698048359*^9, 3.7722847759044867`*^9}, {3.772285010010169*^9, 
   3.772285045658825*^9}, {3.7722850761293716`*^9, 3.7722850960199213`*^9}, 
   3.772285178523724*^9, {3.77236447619662*^9, 3.7723645043822403`*^9}, {
   3.772364551064343*^9, 3.772364556213101*^9}, {3.772364601277505*^9, 
   3.772364614932653*^9}, {3.772364721701075*^9, 3.772364745892701*^9}, {
   3.7723654726780863`*^9, 3.7723656214619417`*^9}, 3.772365682158434*^9, {
   3.772368149215102*^9, 3.772368149564683*^9}, {3.772368990526123*^9, 
   3.772369009502626*^9}, {3.772369152968285*^9, 3.772369191208866*^9}, {
   3.772369270426837*^9, 3.7723692825048933`*^9}, {3.772370920799974*^9, 
   3.772370991798862*^9}, {3.772371046990074*^9, 3.772371068092149*^9}, {
   3.772371621786759*^9, 3.772371624106864*^9}, {3.772371947539008*^9, 
   3.772372102130176*^9}, {3.772376543946974*^9, 3.772376565306912*^9}, {
   3.772376674553438*^9, 3.772376690540468*^9}, {3.77237673847546*^9, 
   3.7723767616748953`*^9}, {3.772376828676401*^9, 3.772376910123201*^9}, {
   3.772436966608683*^9, 3.772436991934647*^9}, {3.772437088384615*^9, 
   3.7724371779271383`*^9}, {3.772437263415668*^9, 3.772437271287508*^9}, {
   3.772438707944784*^9, 3.7724389669530373`*^9}, {3.7724389991700687`*^9, 
   3.7724390125135593`*^9}, {3.7724393895462713`*^9, 3.772439398305973*^9}, {
   3.772439675603006*^9, 3.7724397014515657`*^9}, {3.7724397922900877`*^9, 
   3.772439795707053*^9}, 3.77244017684429*^9, {3.772440377162609*^9, 
   3.7724404581790733`*^9}, {3.7724455967282953`*^9, 3.772445640254805*^9}},
 ExpressionUUID -> "bfa20299-4c52-4234-9877-c822317e2240"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   FractionBox["1", 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "]"}]}], "Input",
 CellChangeTimes->{{3.772364525316143*^9, 3.77236452609298*^9}, {
   3.772372396937315*^9, 3.772372415001383*^9}, 3.77237311796066*^9, {
   3.7723737007755613`*^9, 3.7723737188240967`*^9}, {3.7723737525118113`*^9, 
   3.772373756559065*^9}, {3.772374940164611*^9, 3.7723749406118917`*^9}, {
   3.772375107172915*^9, 3.772375113276558*^9}, {3.772375341936801*^9, 
   3.772375342736553*^9}, {3.772375380288937*^9, 3.772375390719099*^9}, {
   3.772375893528729*^9, 3.7723759026335583`*^9}, {3.772376296394185*^9, 
   3.7723763437138243`*^9}, {3.7723763970667267`*^9, 3.772376404770289*^9}, {
   3.772377406392981*^9, 3.772377416216053*^9}, {3.772377466377136*^9, 
   3.772377490000616*^9}, {3.772377650720331*^9, 3.772377652744091*^9}, {
   3.7724405909234343`*^9, 3.772440591298102*^9}, {3.7724463631857977`*^9, 
   3.772446363385128*^9}, {3.772446401881209*^9, 3.7724464062492533`*^9}, {
   3.772446499817471*^9, 3.772446502425023*^9}, {3.772794315281715*^9, 
   3.772794316648402*^9}, {3.788405127987102*^9, 3.788405166488482*^9}, {
   3.788405466461115*^9, 3.7884054733897448`*^9}, {3.788405510697042*^9, 
   3.788405537658779*^9}, {3.788406040239809*^9, 3.788406044805222*^9}, {
   3.78841916147596*^9, 3.788419172812961*^9}, 3.790077642224515*^9},
 ExpressionUUID -> "00634496-db5b-49d4-8b38-5881f809137c"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{"4", "+", 
    SqrtBox["14"]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]32", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]32", "[", "1", "]"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]32", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]32", "[", "0", "]"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.7884051681544847`*^9, 3.788405381680544*^9, 
  3.7884054807098293`*^9, 3.7884055466966*^9, 3.7884060492807426`*^9, 
  3.788419178137855*^9, 3.790077695179167*^9, 3.790079596630979*^9},
 ExpressionUUID -> "b93b552a-fa17-4b0d-9fa2-eb0135d5408d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.7388107285038412`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]32", "[", "0", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]32", "[", "0", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1.50000082672093`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]32", "[", "1", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]32", "[", "1", "]"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1.0593196314266704`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]32", "[", "0", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]32", "[", "0", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.7388115378600488`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]32", "[", "1", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]32", "[", "1", "]"}], "]"}]}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]32", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]32", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]32", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]32", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]32", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]32", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]32", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]32", "[", "1", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.772372354097027*^9, 3.77237236233624*^9}, {
   3.772372443194384*^9, 3.772372474312592*^9}, {3.7723731354007673`*^9, 
   3.772373151055459*^9}, {3.7723732098316793`*^9, 3.772373229199974*^9}, {
   3.772375054196787*^9, 3.772375060108384*^9}, {3.772375288094521*^9, 
   3.77237529634181*^9}, 3.772793923819684*^9, 3.788405205384755*^9, 
   3.78840606547785*^9},ExpressionUUID->"ed6d4ba3-3890-419d-8b4c-\
59dcd177fac0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1.672078038844904`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]32", "[", "0", "]"}], "\[Rule]", 
      "5.863377320745637`*^-13"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]32", "[", "0", "]"}], "\[Rule]", "1.9994100755403412`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]32", "[", "1", "]"}], "\[Rule]", 
      "1.5707810945852645`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]32", "[", "1", "]"}], "\[Rule]", 
      "0.4576624253192309`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.772372229656629*^9, 3.772372427272305*^9, 3.772372475519308*^9, 
   3.7723732602921667`*^9, 3.772373482983139*^9, {3.772373704251555*^9, 
   3.772373721980921*^9}, 3.772373761250647*^9, 3.772374945591619*^9, 
   3.772375079772977*^9, 3.7723752442666407`*^9, {3.772375334703947*^9, 
   3.772375394957336*^9}, 3.772375957103389*^9, 3.772376359270447*^9, 
   3.772376919121994*^9, 3.77237709215241*^9, 3.772436894880805*^9, 
   3.7724370010461493`*^9, 3.772437194065012*^9, {3.772438480686203*^9, 
   3.772438502038825*^9}, 3.7724390377592154`*^9, 3.772441650660499*^9, {
   3.772444252492063*^9, 3.772444281576799*^9}, 3.772444872222376*^9, {
   3.7724450183494797`*^9, 3.7724450242489843`*^9}, 3.7724461857781763`*^9, 
   3.772446304043872*^9, 3.772446369438727*^9, 3.772446440792738*^9, 
   3.772793926006649*^9, 3.788405208098178*^9, 3.788405483973918*^9, 
   3.788405561865431*^9, 
   3.7884060681636963`*^9},ExpressionUUID->"b8e0f991-bf50-4ea7-aa65-\
1515dc0cd310"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   FractionBox["1", 
    RowBox[{"2", " ", 
     SqrtBox["2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Cqa", "[", 
    RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
   RowBox[{"Cqa", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
   RowBox[{"Cqa", "[", 
    RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
   RowBox[{"Cqa", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]1", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]1", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]1", "[", "1", "]"}], ",", 
   RowBox[{"\[Theta]2", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]2", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]2", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]2", "[", "1", "]"}], ",", 
   RowBox[{"\[Theta]31", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]31", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]31", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]31", "[", "1", "]"}], ",", "\[Lambda]1", ",", 
   RowBox[{"\[Theta]32", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]32", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]32", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]32", "[", "1", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.772436873702003*^9, 3.7724368822296553`*^9}, {
   3.7724468352123613`*^9, 3.772446844388261*^9}, {3.772447111884777*^9, 
   3.7724471174607687`*^9}, {3.7724978712333593`*^9, 3.772497912648322*^9}, {
   3.7727940695529537`*^9, 3.7727940788806667`*^9}, {3.7727943765611763`*^9, 
   3.772794378369184*^9}, {3.788405226594735*^9, 3.7884052489401817`*^9}, {
   3.788405349121408*^9, 3.78840536448907*^9}, 3.788405435458991*^9, {
   3.7884191948987303`*^9, 3.788419260073286*^9}, {3.7884193560211*^9, 
   3.788419356197452*^9}, 3.790077673806246*^9},
 ExpressionUUID -> "a331b03d-9eb1-4338-9019-d9a1eaa005e0"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"4", "+", 
    SqrtBox["14"]}], ")"}], " ", "\[Lambda]2"}]], "Output",
 CellChangeTimes->{
  3.772446491779024*^9, {3.772446882367187*^9, 3.7724468972375097`*^9}, {
   3.772447140969679*^9, 3.772447157688938*^9}, 3.772497897854624*^9, {
   3.7884053048395576`*^9, 3.788405313638569*^9}, {3.78840535103691*^9, 
   3.7884053665580263`*^9}, 3.788405402242935*^9, 3.788405436892829*^9, 
   3.788405487800112*^9, 3.788405566910859*^9, 3.7884192611288977`*^9, 
   3.788419370692211*^9, 3.7900776776858997`*^9, 3.790079612607121*^9},
 ExpressionUUID -> "8b0c3925-bdf5-4fbc-8597-407905152f0e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SqrtBox["2"], "/", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"4", "+", 
       SqrtBox["14"]}], ")"}]}], ")"}]}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.790077713218268*^9, 3.790077737097767*^9}}],

Cell[BoxData["0.36535162736319904`"], "Output",
 CellChangeTimes->{{3.7900777234800367`*^9, 3.7900777382082357`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "3", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 
  3.772446673256187*^9}},ExpressionUUID->"44bdfaa7-2034-4cdc-9cc0-\
1fd3ae0fa3ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.790077957706533*^9, 
  3.790077981006238*^9}, {3.79007802728638*^9, 3.790078033867193*^9}, {
  3.7900795596094437`*^9, 3.790079559744341*^9}},
 ExpressionUUID -> "6a75a2d7-557a-4ebc-ae27-cd2ba24d7cca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 ExpressionUUID -> "2f65458a-442e-4deb-8af4-df78c28c1c1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]3", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]3"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}], ".", 
        RowBox[{"\[Rho]C2", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
          "c1", ",", "c2"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq2", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_"}], "]"}],
    ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c3", "*", 
      RowBox[{"P2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c3"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa2", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k33_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "4"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "0", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "1", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "0", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "1", ",", "k33"}], "]"}]}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
  3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
  3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
  3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
  3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
  3.772497266889743*^9, 3.772497283714591*^9}},
 ExpressionUUID -> "9ae88656-bcd2-44c9-b741-6716ba1d5ea8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa2", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa2", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa2", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa2", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}]], "Input",
 CellChangeTimes->{{3.772794890937742*^9, 3.772794903009264*^9}, {
  3.788405612474547*^9, 3.788405642954401*^9}, {3.788419428072308*^9, 
  3.7884194393140163`*^9}},
 ExpressionUUID -> "db3c644a-7f48-421e-84ae-691ce589cc94"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["\[Lambda]1", "2"]}]]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["\[Lambda]2", "2"]}]]}], ")"}], " ", "\[Lambda]3", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]33", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]33", "[", "1", "]"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]33", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Phi]33", "[", "0", "]"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.77279490808504*^9, 3.788419349580776*^9, 
  3.788419490198241*^9, 3.790078013979084*^9, 3.790079053103787*^9, 
  3.7900795676582823`*^9, 3.790079683057563*^9},
 ExpressionUUID -> "51c81dd5-3964-4bfa-8d17-26b8038addc1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.365"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   FractionBox["1", 
    RowBox[{"2", 
     SqrtBox["2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["\[Lambda]1", "2"]}]]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["\[Lambda]2", "2"]}]]}], ")"}], " ", "\[Lambda]3", " ", 
   
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]33", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]33", "[", "1", "]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]33", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]33", "[", "0", "]"}], "]"}]}]}], ")"}]}], "]"}], "\n", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Lambda]1", "2"]}]]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Lambda]2", "2"]}]]}], ")"}], " ", "\[Lambda]3", 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]33", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]33", "[", "1", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]33", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]33", "[", "0", "]"}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]33", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]33", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]33", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]33", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]33", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]33", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]33", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]33", "[", "1", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]1", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]1", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]1", "[", "1", "]"}], ",", 
   RowBox[{"\[Theta]2", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]2", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]2", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]2", "[", "1", "]"}], ",", 
   RowBox[{"\[Theta]31", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]31", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]31", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]31", "[", "1", "]"}], ",", "\[Lambda]1", ",", 
   RowBox[{"\[Theta]32", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]32", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]32", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]32", "[", "1", "]"}], ",", 
   RowBox[{"\[Theta]33", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]33", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]33", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]33", "[", "1", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
  3.772497498585828*^9, 3.7724974998972387`*^9}, {3.7884195276740513`*^9, 
  3.788419645143351*^9}, {3.790077778910358*^9, 3.790077793774374*^9}, {
  3.7900797094125137`*^9, 3.790079716209244*^9}},
 ExpressionUUID -> "c7c7fcd8-9e98-4f51-8983-5ea1949e869a"],

Cell[BoxData["3.737299655393928`"], "Output",
 CellChangeTimes->{{3.772497294585433*^9, 3.772497313149139*^9}, 
   3.772497506192107*^9, 3.772794930399794*^9, 3.788419587370554*^9, 
   3.7884196459242687`*^9, 3.7900778080813217`*^9, 3.790079719185051*^9},
 ExpressionUUID -> "9aa8d32c-7561-44f4-bd30-3da00f021265"],

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "3.737299655393928`", ",", "True", ",", "False", ",", "True", ",", 
     "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["\[Pi]", "2"], ",", 
     RowBox[{"-", 
      FractionBox["\[Pi]", "2"]}], ",", 
     FractionBox["\[Pi]", "2"], ",", "0"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.772497294585433*^9, 3.772497313149139*^9}, 
   3.772497506192107*^9, 3.772794930399794*^9, 3.788419587370554*^9, 
   3.7884196459242687`*^9, 3.7900778080813217`*^9, 3.790079719191327*^9},
 ExpressionUUID -> "9aa8d32c-7561-44f4-bd30-3da00f021265"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "3.7373"}]], "Input",
 CellChangeTimes->{{3.7900797251838417`*^9, 3.790079740639855*^9}}],

Cell[BoxData["0.3784051487365465`"], "Output",
 CellChangeTimes->{3.790079741690567*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "4", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 3.772446673256187*^9}, {
  3.790077854361677*^9, 3.790077854465417*^9}},
 ExpressionUUID -> "44bdfaa7-2034-4cdc-9cc0-1fd3ae0fa3ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.7900778971872*^9, 
  3.790077949676299*^9}, {3.7900794178871098`*^9, 3.790079510346031*^9}, {
  3.790079550925992*^9, 3.790079551053142*^9}, {3.790079759037628*^9, 
  3.7900798010964622`*^9}},
 ExpressionUUID -> "6a75a2d7-557a-4ebc-ae27-cd2ba24d7cca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 ExpressionUUID -> "2f65458a-442e-4deb-8af4-df78c28c1c1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]4", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]4"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}], ".", 
        RowBox[{"\[Rho]C3", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
          "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_"}], 
    "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c4", "*", 
      RowBox[{"P3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c4"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa3", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k34_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "8"], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Cq3", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34"}], 
        "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
  3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
  3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
  3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
  3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
  3.772497266889743*^9, 3.772497283714591*^9}, {3.7900798089769583`*^9, 
  3.790080076769886*^9}, {3.790080205954351*^9, 3.790080206027368*^9}, {
  3.790080263637293*^9, 3.790080264488681*^9}},
 ExpressionUUID -> "9ae88656-bcd2-44c9-b741-6716ba1d5ea8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.3783"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.365"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   FractionBox["1", 
    RowBox[{"2", 
     SqrtBox["2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa3", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa3", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa3", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa3", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
  3.772497498585828*^9, 3.7724974998972387`*^9}, {3.7884195276740513`*^9, 
  3.788419645143351*^9}, {3.790077778910358*^9, 3.790077793774374*^9}, {
  3.7900801014410343`*^9, 3.7900801057388*^9}, {3.790080143281793*^9, 
  3.790080188566566*^9}, {3.790080394520671*^9, 3.790080533289941*^9}},
 ExpressionUUID -> "c7c7fcd8-9e98-4f51-8983-5ea1949e869a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"3.598427300532963`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]4"}]}]], "Output",
 CellChangeTimes->{
  3.7900801629101133`*^9, {3.79008019587052*^9, 3.790080211387402*^9}, 
   3.7900802908141747`*^9, 3.790080410303771*^9, {3.790080442797963*^9, 
   3.7900804705182323`*^9}, 3.79008054811429*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "3.59843"}]], "Input",
 CellChangeTimes->{{3.790080555410633*^9, 3.7900805617349787`*^9}}],

Cell[BoxData["0.39300849603107335`"], "Output",
 CellChangeTimes->{3.790080562544379*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "5", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 3.772446673256187*^9}, {
  3.790077854361677*^9, 3.790077854465417*^9}, {3.790080587583514*^9, 
  3.790080587695286*^9}},
 ExpressionUUID -> "44bdfaa7-2034-4cdc-9cc0-1fd3ae0fa3ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.7900778971872*^9, 
  3.790077949676299*^9}, {3.7900794178871098`*^9, 3.790079510346031*^9}, {
  3.790079550925992*^9, 3.790079551053142*^9}, {3.790079759037628*^9, 
  3.7900798010964622`*^9}, {3.790080595648635*^9, 3.7900807432255707`*^9}},
 ExpressionUUID -> "6a75a2d7-557a-4ebc-ae27-cd2ba24d7cca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 ExpressionUUID -> "2f65458a-442e-4deb-8af4-df78c28c1c1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]5", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]5"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}], ".", 
        RowBox[{"\[Rho]C4", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], 
         "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c5", "*", 
      RowBox[{"P4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "a1", ",", "b1", ",", "c5"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa4", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k35_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "16"], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Cq4", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "k35"}], "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
  3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
  3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
  3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
  3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
  3.772497266889743*^9, 3.772497283714591*^9}, {3.7900798089769583`*^9, 
  3.790080076769886*^9}, {3.790080205954351*^9, 3.790080206027368*^9}, {
  3.790080263637293*^9, 3.790080264488681*^9}, {3.790080755820983*^9, 
  3.790080935354841*^9}},
 ExpressionUUID -> "9ae88656-bcd2-44c9-b741-6716ba1d5ea8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.3783"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.365"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   FractionBox["1", 
    RowBox[{"2", 
     SqrtBox["2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa4", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa4", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa4", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa4", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
  3.772497498585828*^9, 3.7724974998972387`*^9}, {3.7884195276740513`*^9, 
  3.788419645143351*^9}, {3.790077778910358*^9, 3.790077793774374*^9}, {
  3.7900801014410343`*^9, 3.7900801057388*^9}, {3.790080143281793*^9, 
  3.790080188566566*^9}, {3.790080394520671*^9, 3.790080533289941*^9}, {
  3.79008094097538*^9, 3.790080951824465*^9}, {3.790080986729002*^9, 
  3.790080998977569*^9}, {3.79008106721671*^9, 3.7900810755459414`*^9}, {
  3.790081509199184*^9, 3.790081509261342*^9}},
 ExpressionUUID -> "c7c7fcd8-9e98-4f51-8983-5ea1949e869a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"3.453659819578225`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]5"}]}]], "Output",
 CellChangeTimes->{3.790080972390471*^9, 3.7900810144199743`*^9, 
  3.790081181350524*^9, 3.790081582488268*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "3.45366"}]], "Input",
 CellChangeTimes->{{3.7900816005189123`*^9, 3.790081610823968*^9}}],

Cell[BoxData["0.4094825670080711`"], "Output",
 CellChangeTimes->{3.7900816116818457`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "6", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 3.772446673256187*^9}, {
  3.790077854361677*^9, 3.790077854465417*^9}, {3.790080587583514*^9, 
  3.790080587695286*^9}, {3.7900815977042637`*^9, 3.7900815977771072`*^9}},
 ExpressionUUID -> "44bdfaa7-2034-4cdc-9cc0-1fd3ae0fa3ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.7900778971872*^9, 
  3.790077949676299*^9}, {3.7900794178871098`*^9, 3.790079510346031*^9}, {
  3.790079550925992*^9, 3.790079551053142*^9}, {3.790079759037628*^9, 
  3.7900798010964622`*^9}, {3.790080595648635*^9, 3.7900807432255707`*^9}, {
  3.7900816455424232`*^9, 3.790081734822332*^9}, {3.7900825096511087`*^9, 
  3.790082547842538*^9}},
 ExpressionUUID -> "6a75a2d7-557a-4ebc-ae27-cd2ba24d7cca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 ExpressionUUID -> "2f65458a-442e-4deb-8af4-df78c28c1c1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
        "c4", ",", "c5"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
        "c4", ",", "c5"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]6", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]6"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}], ".", 
        RowBox[{"\[Rho]C5", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
          "c4", ",", "c5"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c6", "*", 
      RowBox[{"P5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c6"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c6", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa5", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k36_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "32"], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Cq5", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "k35", ",", "k36"}], "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
  3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
  3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
  3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
  3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
  3.772497266889743*^9, 3.772497283714591*^9}, {3.7900798089769583`*^9, 
  3.790080076769886*^9}, {3.790080205954351*^9, 3.790080206027368*^9}, {
  3.790080263637293*^9, 3.790080264488681*^9}, {3.790080755820983*^9, 
  3.790080935354841*^9}, {3.790081744020109*^9, 3.790081931618359*^9}},
 ExpressionUUID -> "9ae88656-bcd2-44c9-b741-6716ba1d5ea8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.41"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.3783"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.365"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   FractionBox["1", 
    RowBox[{"2", 
     SqrtBox["2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa5", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa5", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa5", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa5", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
  3.772497498585828*^9, 3.7724974998972387`*^9}, {3.7884195276740513`*^9, 
  3.788419645143351*^9}, {3.790077778910358*^9, 3.790077793774374*^9}, {
  3.7900801014410343`*^9, 3.7900801057388*^9}, {3.790080143281793*^9, 
  3.790080188566566*^9}, {3.790080394520671*^9, 3.790080533289941*^9}, {
  3.79008094097538*^9, 3.790080951824465*^9}, {3.790080986729002*^9, 
  3.790080998977569*^9}, {3.79008106721671*^9, 3.7900810755459414`*^9}, {
  3.790081509199184*^9, 3.790081509261342*^9}, {3.790081623292841*^9, 
  3.790081633245781*^9}, {3.790081941959125*^9, 3.790081968660961*^9}},
 ExpressionUUID -> "c7c7fcd8-9e98-4f51-8983-5ea1949e869a"],

Cell[BoxData[
 RowBox[{"1.4131902891568071`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.7900822227406893`*^9, 3.790082538605074*^9, 
  3.7900827889769773`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "3.30185"}]], "Input",
 CellChangeTimes->{{3.790082229691801*^9, 3.7900822352294273`*^9}}],

Cell[BoxData["0.4283094514811682`"], "Output",
 CellChangeTimes->{3.7900822372320337`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "7", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 3.772446673256187*^9}, {
  3.790077854361677*^9, 3.790077854465417*^9}, {3.790080587583514*^9, 
  3.790080587695286*^9}, {3.7900815977042637`*^9, 3.7900815977771072`*^9}, {
  3.7900820939851313`*^9, 3.790082094041512*^9}},
 ExpressionUUID -> "44bdfaa7-2034-4cdc-9cc0-1fd3ae0fa3ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
       "c4", ",", "c5"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
   3.772496126716131*^9, 3.772496322458699*^9}, {3.7900778971872*^9, 
   3.790077949676299*^9}, {3.7900794178871098`*^9, 3.790079510346031*^9}, {
   3.790079550925992*^9, 3.790079551053142*^9}, {3.790079759037628*^9, 
   3.7900798010964622`*^9}, {3.790080595648635*^9, 3.7900807432255707`*^9}, {
   3.7900816455424232`*^9, 3.790081734822332*^9}, {3.7900821032493134`*^9, 
   3.790082189992128*^9}, {3.7900825638800297`*^9, 3.790082567695109*^9}, 
   3.790082813020763*^9, 3.7900841760467176`*^9},
 ExpressionUUID -> "6a75a2d7-557a-4ebc-ae27-cd2ba24d7cca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 ExpressionUUID -> "2f65458a-442e-4deb-8af4-df78c28c1c1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC6", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
        "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC6", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
        "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z37", "[", 
    RowBox[{"k37_", ",", "c7_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]7", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]7"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}], ".", 
        RowBox[{"\[Rho]C6", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",",
           "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c6", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c7", "*", 
      RowBox[{"P6", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c7"}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c7", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa6", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k37_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "64"], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Cq6", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "k35", ",", "k36", ",", "k37"}], "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k36", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
  3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
  3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
  3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
  3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
  3.772497266889743*^9, 3.772497283714591*^9}, {3.7900798089769583`*^9, 
  3.790080076769886*^9}, {3.790080205954351*^9, 3.790080206027368*^9}, {
  3.790080263637293*^9, 3.790080264488681*^9}, {3.790080755820983*^9, 
  3.790080935354841*^9}, {3.790081744020109*^9, 3.790081931618359*^9}, {
  3.790082195597015*^9, 3.790082221892827*^9}, {3.790082256129196*^9, 
  3.790082418753173*^9}},
 ExpressionUUID -> "9ae88656-bcd2-44c9-b741-6716ba1d5ea8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]6", "=", "0.428"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.41"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.3783"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.365"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   FractionBox["1", 
    RowBox[{"2", 
     SqrtBox["2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]37", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]37", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]37", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]37", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa6", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa6", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa6", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa6", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
  3.772497498585828*^9, 3.7724974998972387`*^9}, {3.7884195276740513`*^9, 
  3.788419645143351*^9}, {3.790077778910358*^9, 3.790077793774374*^9}, {
  3.7900801014410343`*^9, 3.7900801057388*^9}, {3.790080143281793*^9, 
  3.790080188566566*^9}, {3.790080394520671*^9, 3.790080533289941*^9}, {
  3.79008094097538*^9, 3.790080951824465*^9}, {3.790080986729002*^9, 
  3.790080998977569*^9}, {3.79008106721671*^9, 3.7900810755459414`*^9}, {
  3.790081509199184*^9, 3.790081509261342*^9}, {3.790081623292841*^9, 
  3.790081633245781*^9}, {3.790081941959125*^9, 3.790081968660961*^9}, {
  3.790082438402691*^9, 3.790082471468823*^9}, {3.7900840892688637`*^9, 
  3.790084104919691*^9}},
 ExpressionUUID -> "c7c7fcd8-9e98-4f51-8983-5ea1949e869a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"3.142992546224397`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]7"}]}]], "Output",
 CellChangeTimes->{3.7900824845951967`*^9, 3.790083868826191*^9, 
  3.790085163389224*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", 
  RowBox[{"(", "3.14299", ")"}]}]], "Input",
 CellChangeTimes->{{3.7900841145814466`*^9, 3.790084124110462*^9}, {
  3.790085539866358*^9, 3.7900855419845037`*^9}}],

Cell[BoxData["0.44995802162052534`"], "Output",
 CellChangeTimes->{3.790084125497102*^9, 3.790085543410605*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "8", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 3.772446673256187*^9}, {
  3.790077854361677*^9, 3.790077854465417*^9}, {3.790080587583514*^9, 
  3.790080587695286*^9}, {3.7900815977042637`*^9, 3.7900815977771072`*^9}, {
  3.7900820939851313`*^9, 3.790082094041512*^9}, {3.7900842331516743`*^9, 
  3.790084233255723*^9}},
 ExpressionUUID -> "44bdfaa7-2034-4cdc-9cc0-1fd3ae0fa3ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR37", "[", 
    RowBox[{"k37_", ",", "c7_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
       "c4", ",", "c5"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC6", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
       "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
   3.772496126716131*^9, 3.772496322458699*^9}, {3.7900778971872*^9, 
   3.790077949676299*^9}, {3.7900794178871098`*^9, 3.790079510346031*^9}, {
   3.790079550925992*^9, 3.790079551053142*^9}, {3.790079759037628*^9, 
   3.7900798010964622`*^9}, {3.790080595648635*^9, 3.7900807432255707`*^9}, {
   3.7900816455424232`*^9, 3.790081734822332*^9}, {3.7900821032493134`*^9, 
   3.790082189992128*^9}, {3.7900825638800297`*^9, 3.790082567695109*^9}, 
   3.790082813020763*^9, 3.7900841760467176`*^9, {3.790084242341694*^9, 
   3.790084344920484*^9}},
 ExpressionUUID -> "6a75a2d7-557a-4ebc-ae27-cd2ba24d7cca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 ExpressionUUID -> "2f65458a-442e-4deb-8af4-df78c28c1c1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
     "c7_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC7", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", ",", 
        "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC7", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", ",", 
        "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z38", "[", 
    RowBox[{"k38_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]8", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]8"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
     "b1_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z38", "[", 
         RowBox[{"k38", ",", "c8"}], "]"}], ".", 
        RowBox[{"\[Rho]C7", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", 
          ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], 
         "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c6", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c7", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c8", "*", 
      RowBox[{"P7", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", "b1", ",", 
        "c8"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c8", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa7", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k38_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "128"], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Cq7", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "k35", ",", "k36", ",", "k37", ",", "k38"}], "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k36", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k37", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
  3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
  3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
  3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
  3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
  3.772497266889743*^9, 3.772497283714591*^9}, {3.7900798089769583`*^9, 
  3.790080076769886*^9}, {3.790080205954351*^9, 3.790080206027368*^9}, {
  3.790080263637293*^9, 3.790080264488681*^9}, {3.790080755820983*^9, 
  3.790080935354841*^9}, {3.790081744020109*^9, 3.790081931618359*^9}, {
  3.790082195597015*^9, 3.790082221892827*^9}, {3.790082256129196*^9, 
  3.790082418753173*^9}, {3.790084349174499*^9, 3.7900845494007473`*^9}},
 ExpressionUUID -> "9ae88656-bcd2-44c9-b741-6716ba1d5ea8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]7", "=", "0.45"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]6", "=", "0.428"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.41"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.3783"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.365"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   FractionBox["1", 
    RowBox[{"2", 
     SqrtBox["2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]37", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]37", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]37", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]37", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]38", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]38", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]38", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]38", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa7", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa7", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa7", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa7", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
  3.772497498585828*^9, 3.7724974998972387`*^9}, {3.7884195276740513`*^9, 
  3.788419645143351*^9}, {3.790077778910358*^9, 3.790077793774374*^9}, {
  3.7900801014410343`*^9, 3.7900801057388*^9}, {3.790080143281793*^9, 
  3.790080188566566*^9}, {3.790080394520671*^9, 3.790080533289941*^9}, {
  3.79008094097538*^9, 3.790080951824465*^9}, {3.790080986729002*^9, 
  3.790080998977569*^9}, {3.79008106721671*^9, 3.7900810755459414`*^9}, {
  3.790081509199184*^9, 3.790081509261342*^9}, {3.790081623292841*^9, 
  3.790081633245781*^9}, {3.790081941959125*^9, 3.790081968660961*^9}, {
  3.790082438402691*^9, 3.790082471468823*^9}, {3.7900840892688637`*^9, 
  3.790084104919691*^9}, {3.790084559843549*^9, 3.790084590673517*^9}, {
  3.790085561280011*^9, 3.790085567140563*^9}},
 ExpressionUUID -> "c7c7fcd8-9e98-4f51-8983-5ea1949e869a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.974887319037535`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]8"}]}]], "Output",
 CellChangeTimes->{3.790089545876055*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "2.97489"}]], "Input",
 CellChangeTimes->{{3.790089867006811*^9, 3.790089874170038*^9}}],

Cell[BoxData["0.4753834805230093`"], "Output",
 CellChangeTimes->{3.790089874973565*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "9", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 3.772446673256187*^9}, {
  3.790077854361677*^9, 3.790077854465417*^9}, {3.790080587583514*^9, 
  3.790080587695286*^9}, {3.7900815977042637`*^9, 3.7900815977771072`*^9}, {
  3.7900820939851313`*^9, 3.790082094041512*^9}, {3.7900842331516743`*^9, 
  3.790084233255723*^9}, {3.790132989314939*^9, 3.7901329898423223`*^9}},
 ExpressionUUID -> "44bdfaa7-2034-4cdc-9cc0-1fd3ae0fa3ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR37", "[", 
    RowBox[{"k37_", ",", "c7_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR38", "[", 
    RowBox[{"k38_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]8"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]8"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
       "c4", ",", "c5"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC6", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
       "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC8", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
     "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", 
     "c6_", ",", "c7_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR38", "[", 
         RowBox[{"k38", ",", "c8"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC7", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", ",", 
       "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR38", "[", 
         RowBox[{"k38", ",", "c8"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
   3.772496126716131*^9, 3.772496322458699*^9}, {3.7900778971872*^9, 
   3.790077949676299*^9}, {3.7900794178871098`*^9, 3.790079510346031*^9}, {
   3.790079550925992*^9, 3.790079551053142*^9}, {3.790079759037628*^9, 
   3.7900798010964622`*^9}, {3.790080595648635*^9, 3.7900807432255707`*^9}, {
   3.7900816455424232`*^9, 3.790081734822332*^9}, {3.7900821032493134`*^9, 
   3.790082189992128*^9}, {3.7900825638800297`*^9, 3.790082567695109*^9}, 
   3.790082813020763*^9, 3.7900841760467176`*^9, {3.790084242341694*^9, 
   3.790084344920484*^9}, {3.790133016452248*^9, 3.7901331036455317`*^9}},
 ExpressionUUID -> "6a75a2d7-557a-4ebc-ae27-cd2ba24d7cca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 ExpressionUUID -> "2f65458a-442e-4deb-8af4-df78c28c1c1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC8", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
     "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", 
     "c6_", ",", "c7_", ",", "c8_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC8", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", 
        "c7", ",", "c8"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C8", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
     "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", 
     "c6_", ",", "c7_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC8", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", 
        "c7", ",", "c8"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z39", "[", 
    RowBox[{"k39_", ",", "c9_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]9", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c9", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]9"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P8", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "a1_", ",", "b1_", ",", "c9_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z39", "[", 
         RowBox[{"k39", ",", "c9"}], "]"}], ".", 
        RowBox[{"\[Rho]C8", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", "b1", 
          ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", 
          ",", "c7", ",", "c8"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c6", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c7", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c8", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq8", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_"}], "]"}],
    ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c9", "*", 
      RowBox[{"P8", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "a1", ",",
         "b1", ",", "c9"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c9", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa8", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k39_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "256"], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Cq8", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39"}], "]"}], 
       ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k36", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k37", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k38", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
  3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
  3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
  3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
  3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
  3.772497266889743*^9, 3.772497283714591*^9}, {3.7900798089769583`*^9, 
  3.790080076769886*^9}, {3.790080205954351*^9, 3.790080206027368*^9}, {
  3.790080263637293*^9, 3.790080264488681*^9}, {3.790080755820983*^9, 
  3.790080935354841*^9}, {3.790081744020109*^9, 3.790081931618359*^9}, {
  3.790082195597015*^9, 3.790082221892827*^9}, {3.790082256129196*^9, 
  3.790082418753173*^9}, {3.790084349174499*^9, 3.7900845494007473`*^9}, {
  3.790133117897291*^9, 3.790133305596467*^9}, {3.7901385932582207`*^9, 
  3.7901385938593616`*^9}},
 ExpressionUUID -> "9ae88656-bcd2-44c9-b741-6716ba1d5ea8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]8", "=", "0.475"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]7", "=", "0.45"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]6", "=", "0.428"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.41"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.3783"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.365"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   FractionBox["1", 
    RowBox[{"2", 
     SqrtBox["2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]37", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]37", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]37", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]37", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]38", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]38", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]38", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]38", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]39", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]39", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]39", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]39", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa8", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa8", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa8", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa8", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQfWZOxMxy6TeO37YvnwOipfYHnQbRettqwPSViV8t
rlm+cQydtsQdRC9XjH313+aN45rjFm9A9BeZdTyMtm8cHZaY84LoYpaXgiDa
X3GSOIgOWxlgCKKN3Fc6gegAs/mlIJol6VcZiP4THF4Nou097teAaK/3aa0g
OqqisA1Eb49ftgdEv4pZAaa/xL08BaIL7qqfAdHqG/d9AtEz1ES/gegbj84Y
MAHpmQzvTUB0xyyN/yBaJk+WkRlk7r9fliC6pPeqLYi+9VVjO4iuq38Cpie6
rH8gBaStrv15CKKln0/gkAbp+9zODaIBpaCMAw==
  "],
 ExpressionUUID -> "c7c7fcd8-9e98-4f51-8983-5ea1949e869a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.7963729512636837`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]9"}]}]], "Output",
 CellChangeTimes->{3.790133392057746*^9, 3.790153855118012*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "2.79637"}]], "Input",
 CellChangeTimes->{{3.790163342306553*^9, 3.790163348801673*^9}}],

Cell[BoxData["0.5057319175835441`"], "Output",
 CellChangeTimes->{3.7901633499316483`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "10", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 3.772446673256187*^9}, {
  3.790077854361677*^9, 3.790077854465417*^9}, {3.790080587583514*^9, 
  3.790080587695286*^9}, {3.7900815977042637`*^9, 3.7900815977771072`*^9}, {
  3.7900820939851313`*^9, 3.790082094041512*^9}, {3.7900842331516743`*^9, 
  3.790084233255723*^9}, {3.790132989314939*^9, 3.7901329898423223`*^9}, {
  3.7901633748284893`*^9, 3.790163375170744*^9}},
 ExpressionUUID -> "44bdfaa7-2034-4cdc-9cc0-1fd3ae0fa3ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR37", "[", 
    RowBox[{"k37_", ",", "c7_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR38", "[", 
    RowBox[{"k38_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]8"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]8"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR39", "[", 
    RowBox[{"k39_", ",", "c9_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]9"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c9", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]9"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c9", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
       "c4", ",", "c5"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC6", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
       "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC8", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
     "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", 
     "c6_", ",", "c7_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR38", "[", 
         RowBox[{"k38", ",", "c8"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC7", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", ",", 
       "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR38", "[", 
         RowBox[{"k38", ",", "c8"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC9", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", 
     "c5_", ",", "c6_", ",", "c7_", ",", "c8_", ",", "c9_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR39", "[", 
         RowBox[{"k39", ",", "c9"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC8", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7",
        ",", "c8"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR39", "[", 
         RowBox[{"k39", ",", "c9"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
   3.772496126716131*^9, 3.772496322458699*^9}, {3.7900778971872*^9, 
   3.790077949676299*^9}, {3.7900794178871098`*^9, 3.790079510346031*^9}, {
   3.790079550925992*^9, 3.790079551053142*^9}, {3.790079759037628*^9, 
   3.7900798010964622`*^9}, {3.790080595648635*^9, 3.7900807432255707`*^9}, {
   3.7900816455424232`*^9, 3.790081734822332*^9}, {3.7900821032493134`*^9, 
   3.790082189992128*^9}, {3.7900825638800297`*^9, 3.790082567695109*^9}, 
   3.790082813020763*^9, 3.7900841760467176`*^9, {3.790084242341694*^9, 
   3.790084344920484*^9}, {3.790133016452248*^9, 3.7901331036455317`*^9}, {
   3.790163383055498*^9, 3.790163488372281*^9}},
 ExpressionUUID -> "6a75a2d7-557a-4ebc-ae27-cd2ba24d7cca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 ExpressionUUID -> "2f65458a-442e-4deb-8af4-df78c28c1c1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC9", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", 
     "c5_", ",", "c6_", ",", "c7_", ",", "c8_", ",", "c9_"}], "]"}], ":=", 
   " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC9", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "a1", ",",
         "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", 
        "c6", ",", "c7", ",", "c8", ",", "c9"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C9", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", 
     "c5_", ",", "c6_", ",", "c7_", ",", "c8_", ",", "c9_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC9", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "a1", ",",
         "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", 
        "c6", ",", "c7", ",", "c8", ",", "c9"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z310", "[", 
    RowBox[{"k310_", ",", "c10_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]10", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c10", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]10"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P9", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "k310_", ",", "a1_", ",", "b1_", ",", "c10_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z310", "[", 
         RowBox[{"k310", ",", "c10"}], "]"}], ".", 
        RowBox[{"\[Rho]C9", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "a1", 
          ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", 
          ",", "c6", ",", "c7", ",", "c8", ",", "c9"}], "]"}]}], "]"}], ")"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c6", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c7", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c8", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c9", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq9", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "k310_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c10", "*", 
      RowBox[{"P9", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "k310", 
        ",", "a1", ",", "b1", ",", "c10"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c10", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa9", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k310_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "512"], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Cq9", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "k310"}],
         "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k36", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k37", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k38", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k39", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQXeEwx75c+o3j4cc74kB0ZOyiNBD9YOHiDBBdd0wj
H0S7LGsuAtFR8gvLQPR7RrkaEP2pelMjiO77WdMEoovK73SDaI7gg5PA+i3S
l4Do+/6Jy0D0sYqYdSD63d2yDSDazln+BYPtG8cXi2ZwMgJp7q59kiDa+MEB
ML0l5YsCiHZbzK8Ioutcq+JA9J2o1yUges8ShlsgeubJ4o8ger9UsRATkOaa
tEcURCcosUiB6H+SEXogun7qUnlmIP3m0hoLED1n2573UkDaScyYXRpIRzhr
zJEF0k/qrcH0tGk/jmoCae/IRw9BNACkBYje
  "],
 ExpressionUUID -> "9ae88656-bcd2-44c9-b741-6716ba1d5ea8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]9", "=", "0.506"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]8", "=", "0.475"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]7", "=", "0.45"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]6", "=", "0.428"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.41"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.3783"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.365"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   FractionBox["1", 
    RowBox[{"2", 
     SqrtBox["2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]37", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]37", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]37", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]37", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]38", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]38", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]38", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]38", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]39", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]39", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]39", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]39", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]310", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]310", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]310", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]310", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa9", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa9", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa9", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa9", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQfWZOxMxy6TeO37YvnwOipfYHnQbRettqwPSViV8t
rlm+cQydtsQdRC9XjH313+aN45rjFm9A9BeZdTyMtm8cHZaY84LoYpaXgiDa
X3GSOIgOWxlgCKKN3Fc6gegAs/mlIJol6VcZiP4THF4Nou097teAaK/3aa0g
OqqisA1Eb49ftgdEv4pZAaa/xL08BaIL7qqfAdHqG/d9AtEz1ES/gegbj84Y
MAHpmQzvTUB0xyyN/yBaJk+WkRlk7r9fliC6pPeqLYi+9VVjO4iuq38Cpie6
rH8gBaStrv15CKKln0/gkAbp+9zODaJ7+BQeawLpHa+2vADRAKbelAU=
  "],
 ExpressionUUID -> "c7c7fcd8-9e98-4f51-8983-5ea1949e869a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.604169118807465`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]10"}]}]], "Output",
 CellChangeTimes->{3.790226203322072*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "2.60417"}]], "Input",
 CellChangeTimes->{{3.790243940264028*^9, 3.790243947455138*^9}}],

Cell[BoxData["0.5430573128379081`"], "Output",
 CellChangeTimes->{3.790243948451312*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "11", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 3.772446673256187*^9}, {
  3.790077854361677*^9, 3.790077854465417*^9}, {3.790080587583514*^9, 
  3.790080587695286*^9}, {3.7900815977042637`*^9, 3.7900815977771072`*^9}, {
  3.7900820939851313`*^9, 3.790082094041512*^9}, {3.7900842331516743`*^9, 
  3.790084233255723*^9}, {3.790132989314939*^9, 3.7901329898423223`*^9}, {
  3.7901633748284893`*^9, 3.790163375170744*^9}, {3.790244569676385*^9, 
  3.790244569786532*^9}},
 ExpressionUUID -> "44bdfaa7-2034-4cdc-9cc0-1fd3ae0fa3ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]5"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]6"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR37", "[", 
    RowBox[{"k37_", ",", "c7_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]7"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR38", "[", 
    RowBox[{"k38_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]8"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]8"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR39", "[", 
    RowBox[{"k39_", ",", "c9_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]9"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c9", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]9"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c9", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR310", "[", 
    RowBox[{"k310_", ",", "c10_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]10"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c10", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k310", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]10"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c10", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]310", "[", "k310", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
       "c4", ",", "c5"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC6", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
       "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC8", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
     "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", 
     "c6_", ",", "c7_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR38", "[", 
         RowBox[{"k38", ",", "c8"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC7", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", ",", 
       "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR38", "[", 
         RowBox[{"k38", ",", "c8"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC9", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", 
     "c5_", ",", "c6_", ",", "c7_", ",", "c8_", ",", "c9_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR39", "[", 
         RowBox[{"k39", ",", "c9"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC8", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7",
        ",", "c8"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR39", "[", 
         RowBox[{"k39", ",", "c9"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC10", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "k310_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",",
      "c4_", ",", "c5_", ",", "c6_", ",", "c7_", ",", "c8_", ",", "c9_", ",", 
     "c10_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR310", "[", 
         RowBox[{"k310", ",", "c10"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC9", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6",
        ",", "c7", ",", "c8", ",", "c9"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR310", "[", 
         RowBox[{"k310", ",", "c10"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
   3.772496126716131*^9, 3.772496322458699*^9}, {3.7900778971872*^9, 
   3.790077949676299*^9}, {3.7900794178871098`*^9, 3.790079510346031*^9}, {
   3.790079550925992*^9, 3.790079551053142*^9}, {3.790079759037628*^9, 
   3.7900798010964622`*^9}, {3.790080595648635*^9, 3.7900807432255707`*^9}, {
   3.7900816455424232`*^9, 3.790081734822332*^9}, {3.7900821032493134`*^9, 
   3.790082189992128*^9}, {3.7900825638800297`*^9, 3.790082567695109*^9}, 
   3.790082813020763*^9, 3.7900841760467176`*^9, {3.790084242341694*^9, 
   3.790084344920484*^9}, {3.790133016452248*^9, 3.7901331036455317`*^9}, {
   3.790163383055498*^9, 3.790163488372281*^9}, {3.7902445778863277`*^9, 
   3.79024467933925*^9}},
 ExpressionUUID -> "6a75a2d7-557a-4ebc-ae27-cd2ba24d7cca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 ExpressionUUID -> "2f65458a-442e-4deb-8af4-df78c28c1c1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC10", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "k310_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",",
      "c4_", ",", "c5_", ",", "c6_", ",", "c7_", ",", "c8_", ",", "c9_", ",", 
     "c10_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC10", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "k310", 
        ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",",
         "c5", ",", "c6", ",", "c7", ",", "c8", ",", "c9", ",", "c10"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C10", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "k310_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",",
      "c4_", ",", "c5_", ",", "c6_", ",", "c7_", ",", "c8_", ",", "c9_", ",", 
     "c10_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC10", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "k310", 
        ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",",
         "c5", ",", "c6", ",", "c7", ",", "c8", ",", "c9", ",", "c10"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z311", "[", 
    RowBox[{"k311_", ",", "c11_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]11", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c11", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]311", "[", "k311", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]311", "[", "k311", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]311", "[", "k311", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]311", "[", "k311", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]311", "[", "k311", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]11"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P10", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "k310_", ",", "k311_", ",", "a1_", ",", "b1_", ",", "c11_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z311", "[", 
         RowBox[{"k311", ",", "c11"}], "]"}], ".", 
        RowBox[{"\[Rho]C10", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "k310",
           ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4", 
          ",", "c5", ",", "c6", ",", "c7", ",", "c8", ",", "c9", ",", "c10"}],
          "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c6", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c7", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c8", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c9", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c10", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq10", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
     "k310_", ",", "k311_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c11", "*", 
      RowBox[{"P10", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "k310", 
        ",", "k311", ",", "a1", ",", "b1", ",", "c11"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c11", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa10", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k311_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "1024"], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Cq10", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "k310", 
         ",", "k311"}], "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k36", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k37", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k38", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k39", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k310", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQXeEwx75c+o3j4cc74kB0ZOyiNBD9YOHiDBBdd0wj
H0S7LGsuAtFR8gvLQPR7RrkaEP2pelMjiO77WdMEoovK73SDaI7gg5PA+i3S
l4Do+/6Jy0D0sYqYdSD63d2yDSDazln+BYPtG8cXi2ZwMgJp7q59kiDa+MEB
ML0l5YsCiHZbzK8Ioutcq+JA9J2o1yUges8ShlsgeubJ4o8ger9UsRATkOaa
tEcURCcosUiB6H+SEXogun7qUnlmIP3m0hoLED1n2573UkDaScyYXRpIRzhr
zJEF0k/qrcH0tGk/jmoCae/IRw9B9L+LvFmBQPoAy4JmEA0AeFaQgg==
  "],
 ExpressionUUID -> "9ae88656-bcd2-44c9-b741-6716ba1d5ea8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]10", "=", "0.54"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]9", "=", "0.506"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]8", "=", "0.475"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]7", "=", "0.45"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]6", "=", "0.428"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.41"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.393"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.3783"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.365"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", 
   FractionBox["1", 
    RowBox[{"2", 
     SqrtBox["2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]37", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]37", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]37", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]37", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]38", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]38", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]38", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]38", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]39", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]39", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]39", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]39", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]310", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]310", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]310", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]310", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]311", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]311", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Theta]311", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";", 
  RowBox[{
   RowBox[{"\[Phi]311", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa10", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa10", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa10", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa10", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQfWZOxMxy6TeO37YvnwOipfYHnQbRettqwPSViV8t
rlm+cQydtsQdRC9XjH313+aN45rjFm9A9BeZdTyMtm8cHZaY84LoYpaXgiDa
X3GSOIgOWxlgCKKN3Fc6gegAs/mlIJol6VcZiP4THF4Nou097teAaK/3aa0g
OqqisA1Eb49ftgdEv4pZAaa/xL08BaIL7qqfAdHqG/d9AtEz1ES/gegbj84Y
MAHpmQzvTUB0xyyN/yBaJk+WkRlk7r9fliC6pPeqLYi+9VVjO4iuq38Cpie6
rH8gBaStrv15CKKln0/gkAbp+9zODaJ7+BQeawLpHa+2vADRYg5lLYEg8x69
6ALRACNUm5Q=
  "],
 ExpressionUUID -> "c7c7fcd8-9e98-4f51-8983-5ea1949e869a"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.7902575005512114`*^9}]
}, Open  ]]
},
WindowSize->{1535, 845},
WindowMargins->{{-10, Automatic}, {Automatic, -7}},
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.5, 1.5 Inherited],
FrontEndVersion->"8.0 for Linux x86 (64-bit) (February 23, 2011)",
StyleDefinitions->"Default.nb",
PrivateNotebookOptions -> {
 "VersionedStylesheet" -> {"Default.nb"[8.] -> False}}
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 380, 9, 43, "Input"],
Cell[941, 31, 210, 4, 43, "Input"],
Cell[1154, 37, 7894, 210, 682, "Input"],
Cell[CellGroupData[{
Cell[9073, 251, 4347, 100, 314, "Input"],
Cell[13423, 353, 1257, 27, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14717, 385, 2919, 81, 368, "Input"],
Cell[17639, 468, 545, 8, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18221, 481, 249, 7, 60, "Input"],
Cell[18473, 490, 141, 2, 43, "Output"]
}, Open  ]],
Cell[18629, 495, 248, 6, 43, "Input"],
Cell[18880, 503, 6906, 196, 684, "Input"],
Cell[25789, 701, 9787, 240, 557, "Input"],
Cell[35579, 943, 5836, 143, 317, "Input"],
Cell[41418, 1088, 4132, 103, 465, "Input"],
Cell[CellGroupData[{
Cell[45575, 1195, 2195, 52, 98, "Input"],
Cell[47773, 1249, 1511, 31, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49321, 1285, 3704, 106, 547, "Input"],
Cell[53028, 1393, 216, 3, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53281, 1401, 123, 2, 43, "Input"],
Cell[53407, 1405, 90, 1, 43, "Output"]
}, Open  ]],
Cell[53512, 1409, 251, 6, 43, "Input"],
Cell[53766, 1417, 9589, 276, 899, "Input"],
Cell[63358, 1695, 9549, 236, 530, "Input"],
Cell[72910, 1933, 4869, 136, 371, "Input"],
Cell[CellGroupData[{
Cell[77804, 2073, 5027, 133, 654, "Input"],
Cell[82834, 2208, 1027, 24, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83898, 2237, 121, 2, 43, "Input"],
Cell[84022, 2241, 88, 1, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84147, 2247, 3969, 119, 708, "Input"],
Cell[88119, 2368, 168, 2, 43, "Output"]
}, Open  ]],
Cell[88302, 2373, 299, 7, 43, "Input"],
Cell[88604, 2382, 12903, 365, 1114, "Input"],
Cell[101510, 2749, 9549, 236, 530, "Input"],
Cell[111062, 2987, 6221, 159, 482, "Input"],
Cell[CellGroupData[{
Cell[117308, 3150, 5779, 154, 816, "Input"],
Cell[123090, 3306, 725, 20, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123852, 3331, 122, 2, 43, "Input"],
Cell[123977, 3335, 90, 1, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124104, 3341, 4454, 136, 816, "Input"],
Cell[128561, 3479, 195, 3, 43, "Output"]
}, Open  ]],
Cell[128771, 3485, 249, 6, 43, "Input"],
Cell[129023, 3493, 16019, 452, 1383, "Input"],
Cell[145045, 3947, 9549, 236, 530, "Input"],
Cell[154597, 4185, 7902, 209, 563, "Input"],
Cell[CellGroupData[{
Cell[162524, 4398, 6332, 171, 1386, "Input"],
Cell[168859, 4571, 809, 20, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169705, 4596, 123, 2, 64, "Input"],
Cell[169831, 4600, 87, 1, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169955, 4606, 5035, 154, 951, "Input"],
Cell[174993, 4762, 195, 3, 43, "Output"]
}, Open  ]],
Cell[175203, 4768, 297, 7, 43, "Input"],
Cell[175503, 4777, 20464, 547, 1652, "Input"],
Cell[195970, 5326, 9591, 237, 795, "Input"],
Cell[205564, 5565, 10466, 270, 1249, "Input"],
Cell[CellGroupData[{
Cell[216055, 5839, 6182, 179, 1588, "Input"],
Cell[222240, 6020, 717, 19, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222994, 6044, 120, 2, 64, "Input"],
Cell[223117, 6048, 88, 1, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[223242, 6054, 6498, 184, 1629, "Input"],
Cell[229743, 6240, 553, 13, 64, "Output"]
}, Open  ]],
Cell[230311, 6256, 225, 6, 64, "Input"],
Cell[230539, 6264, 22022, 622, 2800, "Input"],
Cell[252564, 6888, 9591, 237, 795, "Input"],
Cell[262158, 7127, 6473, 165, 763, "Input"],
Cell[CellGroupData[{
Cell[268656, 7296, 6763, 197, 1791, "Input"],
Cell[275422, 7495, 731, 19, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[276190, 7519, 121, 2, 64, "Input"],
Cell[276314, 7523, 88, 1, 64, "Output"]
}, Open  ]],
Cell[276417, 7527, 273, 6, 64, "Input"],
Cell[276693, 7535, 25249, 710, 3163, "Input"],
Cell[301945, 8247, 9591, 237, 795, "Input"],
Cell[311539, 8486, 6923, 175, 763, "Input"],
Cell[CellGroupData[{
Cell[318487, 8665, 7515, 217, 1993, "Input"],
Cell[326005, 8884, 599, 15, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[326641, 8904, 197, 4, 64, "Input"],
Cell[326841, 8910, 88, 1, 64, "Output"]
}, Open  ]],
Cell[326944, 8914, 325, 7, 43, "Input"],
Cell[327272, 8923, 28585, 800, 2351, "Input"],
Cell[355860, 9725, 9591, 237, 530, "Input"],
Cell[365454, 9964, 7355, 183, 536, "Input"],
Cell[CellGroupData[{
Cell[372834, 10151, 8050, 235, 2196, "Input"],
Cell[380887, 10388, 736, 19, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[381660, 10412, 159, 3, 64, "Input"],
Cell[381822, 10417, 88, 1, 64, "Output"]
}, Open  ]],
Cell[381925, 10421, 378, 8, 64, "Input"],
Cell[382306, 10431, 31962, 889, 3930, "Input"],
Cell[414271, 11322, 9591, 237, 795, "Input"],
Cell[423865, 11561, 7861, 191, 1006, "Input"],
Cell[CellGroupData[{
Cell[431751, 11756, 8836, 255, 2398, "Input"],
Cell[440590, 12013, 791, 20, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[441418, 12038, 121, 2, 64, "Input"],
Cell[441542, 12042, 88, 1, 64, "Output"]
}, Open  ]],
Cell[441645, 12046, 424, 8, 64, "Input"],
Cell[442072, 12056, 35434, 980, 4569, "Input"],
Cell[477509, 13038, 9591, 237, 795, "Input"],
Cell[487103, 13277, 8430, 201, 725, "Input"],
Cell[CellGroupData[{
Cell[495558, 13482, 9032, 268, 1788, "Input"],
Cell[504593, 13752, 791, 20, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[505421, 13777, 121, 2, 43, "Input"],
Cell[505545, 13781, 88, 1, 43, "Output"]
}, Open  ]],
Cell[505648, 13785, 426, 9, 43, "Input"],
Cell[506077, 13796, 210, 4, 43, "Input"],
Cell[506290, 13802, 7894, 210, 682, "Input"],
Cell[CellGroupData[{
Cell[514209, 14016, 5172, 115, 341, "Input"],
Cell[519384, 14133, 1779, 40, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[521200, 14178, 2956, 82, 368, "Input"],
Cell[524159, 14262, 567, 8, 96, "Output"]
}, Closed]],
Cell[524741, 14273, 247, 5, 32, "Input"],
Cell[524991, 14280, 6906, 196, 684, "Input"],
Cell[531900, 14478, 9787, 240, 557, "Input"],
Cell[541690, 14720, 5836, 143, 317, "Input"],
Cell[CellGroupData[{
Cell[547551, 14867, 3974, 98, 449, "Input"],
Cell[551528, 14967, 1430, 33, 117, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[552995, 15005, 2195, 52, 147, "Input"],
Cell[555193, 15059, 1486, 30, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[556716, 15094, 3564, 101, 795, "Input"],
Cell[560283, 15197, 480, 12, 64, "Output"]
}, Open  ]],
Cell[560778, 15212, 250, 5, 43, "Input"],
Cell[561031, 15219, 9589, 276, 899, "Input"],
Cell[570623, 15497, 9549, 236, 530, "Input"],
Cell[580175, 15735, 4869, 136, 371, "Input"],
Cell[CellGroupData[{
Cell[585069, 15875, 4895, 129, 638, "Input"],
Cell[589967, 16006, 1005, 24, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[591009, 16035, 3835, 114, 1038, "Input"],
Cell[594847, 16151, 457, 12, 64, "Output"]
}, Open  ]],
Cell[595319, 16166, 298, 6, 43, "Input"],
Cell[595620, 16174, 12903, 365, 1114, "Input"],
Cell[608526, 16541, 9549, 236, 530, "Input"],
Cell[618078, 16779, 6221, 159, 482, "Input"],
Cell[CellGroupData[{
Cell[624324, 16942, 5647, 150, 800, "Input"],
Cell[629974, 17094, 695, 19, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[630706, 17118, 4342, 131, 800, "Input"],
Cell[635051, 17251, 480, 12, 43, "Output"]
}, Open  ]],
Cell[635546, 17266, 248, 5, 43, "Input"],
Cell[635797, 17273, 16019, 452, 1383, "Input"],
Cell[651819, 17727, 9549, 236, 530, "Input"],
Cell[661371, 17965, 7902, 209, 563, "Input"],
Cell[CellGroupData[{
Cell[669298, 18178, 6200, 167, 908, "Input"],
Cell[675501, 18347, 786, 20, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[676324, 18372, 4923, 149, 935, "Input"],
Cell[681250, 18523, 482, 12, 43, "Output"]
}, Open  ]],
Cell[681747, 18538, 296, 6, 43, "Input"],
Cell[682046, 18546, 20464, 547, 1652, "Input"],
Cell[702513, 19095, 9591, 237, 530, "Input"],
Cell[712107, 19334, 10466, 270, 833, "Input"],
Cell[CellGroupData[{
Cell[722598, 19608, 6049, 175, 1043, "Input"],
Cell[728650, 19785, 696, 19, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[729383, 19809, 6383, 179, 1070, "Input"],
Cell[735769, 19990, 553, 13, 43, "Output"]
}, Open  ]],
Cell[736337, 20006, 224, 5, 43, "Input"],
Cell[736564, 20013, 21971, 621, 1867, "Input"],
Cell[758538, 20636, 9591, 237, 530, "Input"],
Cell[768132, 20875, 6429, 165, 509, "Input"],
Cell[CellGroupData[{
Cell[774586, 21044, 6601, 192, 1178, "Input"],
Cell[781190, 21238, 660, 18, 43, "Output"]
}, Open  ]],
Cell[781865, 21259, 394, 7, 43, "Input"],
Cell[782262, 21268, 142, 3, 43, "Input"],
Cell[CellGroupData[{
Cell[782429, 21275, 6625, 189, 682, "Input"],
Cell[789057, 21466, 8071, 203, 287, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[797165, 21674, 10758, 247, 449, "Input"],
Cell[807926, 21923, 1481, 42, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[809444, 21970, 11063, 260, 584, "Input"],
Cell[820510, 22232, 1162, 31, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[821709, 22268, 19822, 487, 1097, "Input"],
Cell[841534, 22757, 478, 9, 43, "Output"],
Cell[842015, 22768, 811, 20, 65, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[842863, 22793, 128, 3, 60, "Input"],
Cell[842994, 22798, 128, 4, 77, "Output"]
}, Open  ]],
Cell[843137, 22805, 248, 6, 43, "Input"],
Cell[843388, 22813, 6957, 197, 684, "Input"],
Cell[850348, 23012, 9787, 240, 557, "Input"],
Cell[860138, 23254, 5836, 143, 317, "Input"],
Cell[CellGroupData[{
Cell[865999, 23401, 3547, 88, 500, "Input"],
Cell[869549, 23491, 797, 21, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[870383, 23517, 2789, 64, 125, "Input"],
Cell[873175, 23583, 1626, 34, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[874838, 23622, 3986, 108, 605, "Input"],
Cell[878827, 23732, 667, 13, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[879531, 23750, 296, 10, 78, "Input"],
Cell[879830, 23762, 117, 1, 43, "Output"]
}, Open  ]],
Cell[879962, 23766, 251, 6, 43, "Input"],
Cell[880216, 23774, 9635, 277, 899, "Input"],
Cell[889854, 24053, 9549, 236, 530, "Input"],
Cell[899406, 24291, 4869, 136, 371, "Input"],
Cell[CellGroupData[{
Cell[904300, 24431, 629, 15, 43, "Input"],
Cell[904932, 24448, 987, 28, 69, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[905956, 24481, 6675, 192, 917, "Input"],
Cell[912634, 24675, 314, 4, 43, "Output"],
Cell[912951, 24681, 650, 16, 65, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[913638, 24702, 134, 3, 60, "Input"],
Cell[913775, 24707, 88, 1, 43, "Output"]
}, Open  ]],
Cell[913878, 24711, 299, 6, 43, "Input"],
Cell[914180, 24719, 12702, 363, 1114, "Input"],
Cell[926885, 25084, 9549, 236, 530, "Input"],
Cell[936437, 25322, 5274, 142, 425, "Input"],
Cell[CellGroupData[{
Cell[941736, 25468, 3583, 106, 338, "Input"],
Cell[945322, 25576, 535, 13, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[945894, 25594, 135, 3, 60, "Input"],
Cell[946032, 25599, 89, 1, 43, "Output"]
}, Open  ]],
Cell[946136, 25603, 348, 7, 43, "Input"],
Cell[946487, 25612, 15820, 449, 1383, "Input"],
Cell[962310, 26063, 9549, 236, 530, "Input"],
Cell[971862, 26301, 5723, 153, 479, "Input"],
Cell[CellGroupData[{
Cell[977610, 26458, 4279, 125, 392, "Input"],
Cell[981892, 26585, 433, 11, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[982362, 26601, 135, 3, 60, "Input"],
Cell[982500, 26606, 90, 1, 43, "Output"]
}, Open  ]],
Cell[982605, 26610, 398, 7, 43, "Input"],
Cell[983006, 26619, 19047, 538, 1625, "Input"],
Cell[1002056, 27159, 9549, 236, 530, "Input"],
Cell[1011608, 27397, 6139, 158, 509, "Input"],
Cell[CellGroupData[{
Cell[1017772, 27559, 4876, 142, 446, "Input"],
Cell[1022651, 27703, 218, 4, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1022906, 27712, 135, 3, 60, "Input"],
Cell[1023044, 27717, 90, 1, 43, "Output"]
}, Open  ]],
Cell[1023149, 27721, 449, 8, 43, "Input"],
Cell[1023601, 27731, 22326, 626, 1867, "Input"],
Cell[1045930, 28359, 9549, 236, 530, "Input"],
Cell[1055482, 28597, 6620, 168, 509, "Input"],
Cell[CellGroupData[{
Cell[1062127, 28769, 5479, 160, 500, "Input"],
Cell[1067609, 28931, 411, 11, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1068057, 28947, 209, 5, 60, "Input"],
Cell[1068269, 28954, 111, 1, 43, "Output"]
}, Open  ]],
Cell[1068395, 28958, 500, 9, 43, "Input"],
Cell[1068898, 28969, 25605, 715, 2109, "Input"],
Cell[1094506, 29686, 9549, 236, 530, "Input"],
Cell[1104058, 29924, 7063, 177, 509, "Input"],
Cell[CellGroupData[{
Cell[1111146, 30105, 6076, 177, 554, "Input"],
Cell[1117225, 30284, 362, 10, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1117624, 30299, 133, 3, 60, "Input"],
Cell[1117760, 30304, 88, 1, 43, "Output"]
}, Open  ]],
Cell[1117863, 30308, 548, 9, 43, "Input"],
Cell[1118414, 30319, 28936, 804, 2351, "Input"],
Cell[1147353, 31125, 9549, 236, 530, "Input"],
Cell[1156905, 31363, 7545, 186, 536, "Input"],
Cell[CellGroupData[{
Cell[1164475, 31553, 6125, 189, 608, "Input"],
Cell[1170603, 31744, 385, 10, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1171025, 31759, 133, 3, 60, "Input"],
Cell[1171161, 31764, 90, 1, 43, "Output"]
}, Open  ]],
Cell[1171266, 31768, 600, 10, 43, "Input"],
Cell[1171869, 31780, 32319, 894, 2620, "Input"],
Cell[1204191, 32676, 9549, 236, 530, "Input"],
Cell[1213743, 32914, 7442, 188, 671, "Input"],
Cell[CellGroupData[{
Cell[1221210, 33106, 6648, 205, 662, "Input"],
Cell[1227861, 33313, 363, 10, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1228261, 33328, 133, 3, 60, "Input"],
Cell[1228397, 33333, 88, 1, 43, "Output"]
}, Open  ]],
Cell[1228500, 33337, 649, 11, 43, "Input"],
Cell[1229152, 33350, 35792, 985, 3046, "Input"],
Cell[1264947, 34337, 9549, 236, 530, "Input"],
Cell[1274499, 34575, 7881, 196, 725, "Input"],
Cell[CellGroupData[{
Cell[1282405, 34775, 7176, 222, 716, "Input"],
Cell[1289584, 34999, 79, 1, 43, "Output"]
}, Open  ]]
}
]
*)

