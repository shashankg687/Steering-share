(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    834984,      22259]
NotebookOptionsPosition[    826207,      21992]
NotebookOutlinePosition[    826577,      22008]
CellTagsIndexPosition[    826534,      22005]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Svelitchny", " ", "inequality"}], "*)"}]], "Input",
 CellChangeTimes->{{3.772498109410095*^9, 3.772498118192129*^9}, {
  3.786950390488312*^9, 3.7869503994395742`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "1"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.772446638561953*^9, 3.772446646056519*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]w", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z31", "[", 
    RowBox[{"k3_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]1", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]1"}], ")"}], "\[Sigma]0"}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"x1", "[", 
        RowBox[{"i1", ",", "a1"}], "]"}], ",", 
       RowBox[{"y2", "[", 
        RowBox[{"j2", ",", "b1"}], "]"}], ",", 
       RowBox[{"z31", "[", 
        RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ".", "\[Rho]w"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k3_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c1", "*", 
      RowBox[{"P", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Cq", "[", 
    RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
   RowBox[{"Cq", "[", 
    RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
   RowBox[{"Cq", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
   RowBox[{"Cq", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
   RowBox[{"Cq", "[", 
    RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
   RowBox[{"Cq", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
   RowBox[{"Cq", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
   RowBox[{"Cq", "[", 
    RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.772249304786038*^9, 3.772249354497417*^9}, {
   3.77224949108958*^9, 3.7722495229535418`*^9}, {3.772249629057231*^9, 
   3.772249703745123*^9}, {3.7722498511526957`*^9, 3.7722499324246893`*^9}, {
   3.772250062745041*^9, 3.772250215826823*^9}, {3.772250732542162*^9, 
   3.772250769421821*^9}, {3.772250822806221*^9, 3.772251074295411*^9}, {
   3.7722511125279703`*^9, 3.772251121807487*^9}, {3.7722670603525257`*^9, 
   3.7722670859434032`*^9}, {3.772267914142321*^9, 3.772267916862372*^9}, {
   3.7722681477508593`*^9, 3.772268160286553*^9}, {3.772268281246937*^9, 
   3.7722683946062183`*^9}, {3.772270190310521*^9, 3.772270191852511*^9}, {
   3.772270281151112*^9, 3.772270358164688*^9}, {3.7722709870442057`*^9, 
   3.772271001203815*^9}, 3.772271458947505*^9, {3.7722720106598167`*^9, 
   3.7722720242355423`*^9}, 3.772273528346916*^9, {3.77227456708317*^9, 
   3.77227457745658*^9}, {3.77227585425636*^9, 3.772275855120398*^9}, {
   3.7722831618567123`*^9, 3.772283241096567*^9}, 3.772364438973338*^9, {
   3.7723692103922586`*^9, 3.7723692410165443`*^9}, {3.772376986154726*^9, 
   3.772377036306695*^9}, {3.7724367623101463`*^9, 3.7724367996877413`*^9}, {
   3.772438526534863*^9, 3.772438621567161*^9}, {3.7869366561363287`*^9, 
   3.786936731824226*^9}, {3.788417100149597*^9, 3.788417109273864*^9}, {
   3.788417141873987*^9, 3.788417157526743*^9}, {3.788568909695855*^9, 
   3.788569012515636*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "3"], " ", "\[Lambda]1", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
          
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
          
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
          
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "-", 
          
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], "-", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], ")"}]}], "-", 
       RowBox[{"3", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], "-", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], ")"}]}], "-", 
       RowBox[{"3", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.788417168558984*^9, 3.788417524255705*^9, 
  3.78850483378059*^9, 3.7885690432510967`*^9, 3.790385146517338*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "3"], " ", "\[Lambda]1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], 
               "+", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], 
               "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
            
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], 
               "+", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], 
               "-", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "-", 
            
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], "-", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], ")"}]}], "-", 
            
            RowBox[{"3", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], "+", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], ")"}]}], "+", 
            
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}]}], ")"}]}],
                "+", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}]}], ")"}]}],
                "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
           ")"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], "-", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], ")"}]}], "-", 
            
            RowBox[{"3", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], "+", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], ")"}]}], "+", 
            
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}]}], ")"}]}],
                "+", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}]}], ")"}]}],
                "-", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}], ")"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]1", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]1", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]1", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]1", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]2", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]2", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]2", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]2", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", "\[Lambda]1", "\[LessEqual]", "1"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]31", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "1", "]"}], ",", 
     RowBox[{"\[Theta]1", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]1", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]1", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]1", "[", "1", "]"}], ",", 
     RowBox[{"\[Theta]2", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]2", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]2", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]2", "[", "1", "]"}], ",", "\[Lambda]1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.788569106511047*^9, 3.788569430904539*^9}, {
  3.7885694817618923`*^9, 3.78856950343073*^9}, {3.788569556328356*^9, 
  3.788569565131555*^9}, {3.790385172096286*^9, 3.790385192648383*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.66666666666659`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[Rule]", 
      "0.7854868884670521`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[Rule]", "3.141592507843036`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[Rule]", 
      "0.7853110356987608`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[Rule]", 
      "9.509041270918986`*^-6"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]1", "[", "0", "]"}], "\[Rule]", 
      "0.7853092059210675`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]1", "[", "0", "]"}], "\[Rule]", "3.1415925242128275`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]1", "[", "1", "]"}], "\[Rule]", "0.78548504602611`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Phi]1", "[", "1", "]"}], "\[Rule]", 
      "9.520797414113055`*^-6"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "0", "]"}], "\[Rule]", 
      "1.5707963267948966`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "0", "]"}], "\[Rule]", 
      "9.507209946600776`*^-6"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "1", "]"}], "\[Rule]", 
      "1.5707963267948966`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "1", "]"}], "\[Rule]", "3.141592508102553`"}], 
     ",", 
     RowBox[{"\[Lambda]1", "\[Rule]", "1.`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.790385157070554*^9, 3.790385195568205*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", "0.7853"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "\[Pi]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   FractionBox["1", "3"], " ", "\[Lambda]1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], "-", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], ")"}]}], "-", 
        RowBox[{"3", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], 
           "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], 
           "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
       ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], "-", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], ")"}]}], "-", 
        RowBox[{"3", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], 
           "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], 
           "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"(*", 
         RowBox[{"Abs", "["}], "*)"}], 
        RowBox[{
         RowBox[{"Cq", "[", 
          RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
         RowBox[{"Cq", "[", 
          RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
         RowBox[{"Cq", "[", 
          RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
         RowBox[{"Cq", "[", 
          RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{"(*", 
         RowBox[{"Abs", "["}], "*)"}], 
        RowBox[{
         RowBox[{"Cq", "[", 
          RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
         RowBox[{"Cq", "[", 
          RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
         RowBox[{"Cq", "[", 
          RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
         RowBox[{"Cq", "[", 
          RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], ")"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]31", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "1", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]1", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]1", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]1", "[", "1", "]"}], ",", 
   RowBox[{"\[Theta]2", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]2", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]2", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]2", "[", "1", "]"}], ",", "\[Lambda]1", ",", 
   RowBox[{"\[Theta]31", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]31", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]31", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]31", "[", "1", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.772277240367087*^9, 3.772277241176442*^9}, {
   3.772277272472238*^9, 3.772277280256024*^9}, 3.772369044610169*^9, {
   3.772369074812305*^9, 3.772369076572365*^9}, {3.786936760375462*^9, 
   3.786936777080893*^9}, {3.786936857082547*^9, 3.786936864739764*^9}, {
   3.7869372995448647`*^9, 3.7869374655866127`*^9}, {3.7869375246943913`*^9, 
   3.7869375328124237`*^9}, {3.786937614399789*^9, 3.786937616230981*^9}, {
   3.786937744835943*^9, 3.7869377936489067`*^9}, {3.786937860480073*^9, 
   3.7869378720870333`*^9}, {3.7869382189377413`*^9, 3.786938233143304*^9}, {
   3.7884172004007883`*^9, 3.788417262642941*^9}, {3.7884173258049994`*^9, 
   3.788417340982079*^9}, {3.788417371630183*^9, 3.7884173763712473`*^9}, {
   3.7884174144023027`*^9, 3.7884175139503098`*^9}, {3.788417599472311*^9, 
   3.788417641833292*^9}, 3.788569635818087*^9, {3.790385236679216*^9, 
   3.790385245015607*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.7869376193427753`*^9, 3.7869377977922277`*^9, 3.7869378737268877`*^9, {
   3.786938224727763*^9, 3.786938238293248*^9}, 3.7884031881151342`*^9, 
   3.7884173438397503`*^9, 3.7884173775846767`*^9, {3.7884174313312798`*^9, 
   3.788417495331128*^9}, 3.788417534648202*^9, 3.788417643671256*^9, 
   3.7885048378626757`*^9, 3.788569639447901*^9}],

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cq", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], "+", 
      RowBox[{"Cq", "[", 
       RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
      RowBox[{"Cq", "[", 
       RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
      RowBox[{"Cq", "[", 
       RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
      RowBox[{"Cq", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}], "+", 
      RowBox[{"Cq", "[", 
       RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
      RowBox[{"Cq", "[", 
       RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
      RowBox[{"Cq", "[", 
       RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ",", "True", ",", "False", 
     ",", "True", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["\[Pi]", "2"], ",", 
     RowBox[{"-", 
      FractionBox["\[Pi]", "2"]}], ",", 
     FractionBox["\[Pi]", "2"], ",", "0"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.7869376193427753`*^9, 3.7869377977922277`*^9, 3.7869378737268877`*^9, {
   3.786938224727763*^9, 3.786938238293248*^9}, 3.7884031881151342`*^9, 
   3.7884173438397503`*^9, 3.7884173775846767`*^9, {3.7884174313312798`*^9, 
   3.788417495331128*^9}, 3.788417534648202*^9, 3.788417643671256*^9, 
   3.7885048378626757`*^9, 3.788569639522951*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"(*", 
     RowBox[{"Abs", "["}], "*)"}], 
    RowBox[{
     RowBox[{"Cq", "[", 
      RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
     RowBox[{"Cq", "[", 
      RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
     RowBox[{"Cq", "[", 
      RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
     RowBox[{"Cq", "[", 
      RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"(*", 
     RowBox[{"Abs", "["}], "*)"}], 
    RowBox[{
     RowBox[{"Cq", "[", 
      RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
     RowBox[{"Cq", "[", 
      RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
     RowBox[{"Cq", "[", 
      RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
     RowBox[{"Cq", "[", 
      RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.772271102181653*^9, 3.7722712123236637`*^9}, {
   3.7722712431075087`*^9, 3.772271330403552*^9}, {3.772271360748274*^9, 
   3.772271370994335*^9}, 3.772271442557098*^9, {3.772438684015664*^9, 
   3.772438690015732*^9}, {3.78693815054286*^9, 3.786938206805768*^9}, {
   3.786949964473905*^9, 3.786950003655738*^9}, 3.788417705662813*^9, 
   3.7885048466603117`*^9}],

Cell[BoxData[
 RowBox[{"4", " ", 
  SqrtBox["2"], " ", "\[Lambda]1"}]], "Output",
 CellChangeTimes->{{3.772271317019206*^9, 3.772271371608739*^9}, {
   3.7722714444306726`*^9, 3.7722714614577713`*^9}, {3.772377052184189*^9, 
   3.7723770678275757`*^9}, {3.7724386759228153`*^9, 
   3.7724386916198997`*^9}, {3.786938212130825*^9, 3.78693824175529*^9}, {
   3.786949974138298*^9, 3.786950004386189*^9}, 3.788403195265222*^9, 
   3.788417707637377*^9, 3.788504848582254*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "2", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.772446609960565*^9, 3.77244663048814*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k3_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7724396794898357`*^9, 3.7724397060260468`*^9}, {
  3.772440724815703*^9, 3.772440742543221*^9}, {3.7724409586980553`*^9, 
  3.77244096752039*^9}, {3.772444178684898*^9, 3.772444211812797*^9}, {
  3.772444537327029*^9, 3.7724445533573008`*^9}, {3.772444588189095*^9, 
  3.772444606004141*^9}, {3.772444671189715*^9, 3.772444702020938*^9}, {
  3.772444995707638*^9, 3.7724450008014936`*^9}, {3.7724453428234167`*^9, 
  3.772445360766842*^9}, {3.772445426351858*^9, 3.7724454327582607`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.77228212089924*^9, 3.7722822685852947`*^9}, {
  3.772282331266062*^9, 3.7722823318570957`*^9}, {3.772283463545506*^9, 
  3.77228349209052*^9}, {3.772283973641814*^9, 3.772283974411016*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]2", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]2"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c2_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}], ".", 
        RowBox[{"\[Rho]C", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
         "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq1", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k3_", ",", "k32_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c2", "*", 
      RowBox[{"P1", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k3", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c2"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k32_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq1", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "k32"}], "]"}], "+", 
      RowBox[{"Cq1", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "k32"}], "]"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7722839012647943`*^9, 3.772283977561111*^9}, {
   3.772284048121008*^9, 3.772284054048564*^9}, {3.772284087168202*^9, 
   3.772284088034628*^9}, {3.772284118360495*^9, 3.7722842019765167`*^9}, {
   3.772284253521983*^9, 3.7722843123126793`*^9}, {3.7722843547692547`*^9, 
   3.772284497593048*^9}, {3.7722845668810177`*^9, 3.772284648655345*^9}, {
   3.772284698048359*^9, 3.7722847759044867`*^9}, {3.772285010010169*^9, 
   3.772285045658825*^9}, {3.7722850761293716`*^9, 3.7722850960199213`*^9}, 
   3.772285178523724*^9, {3.77236447619662*^9, 3.7723645043822403`*^9}, {
   3.772364551064343*^9, 3.772364556213101*^9}, {3.772364601277505*^9, 
   3.772364614932653*^9}, {3.772364721701075*^9, 3.772364745892701*^9}, {
   3.7723654726780863`*^9, 3.7723656214619417`*^9}, 3.772365682158434*^9, {
   3.772368149215102*^9, 3.772368149564683*^9}, {3.772368990526123*^9, 
   3.772369009502626*^9}, {3.772369152968285*^9, 3.772369191208866*^9}, {
   3.772369270426837*^9, 3.7723692825048933`*^9}, {3.772370920799974*^9, 
   3.772370991798862*^9}, {3.772371046990074*^9, 3.772371068092149*^9}, {
   3.772371621786759*^9, 3.772371624106864*^9}, {3.772371947539008*^9, 
   3.772372102130176*^9}, {3.772376543946974*^9, 3.772376565306912*^9}, {
   3.772376674553438*^9, 3.772376690540468*^9}, {3.77237673847546*^9, 
   3.7723767616748953`*^9}, {3.772376828676401*^9, 3.772376910123201*^9}, {
   3.772436966608683*^9, 3.772436991934647*^9}, {3.772437088384615*^9, 
   3.7724371779271383`*^9}, {3.772437263415668*^9, 3.772437271287508*^9}, {
   3.772438707944784*^9, 3.7724389669530373`*^9}, {3.7724389991700687`*^9, 
   3.7724390125135593`*^9}, {3.7724393895462713`*^9, 3.772439398305973*^9}, {
   3.772439675603006*^9, 3.7724397014515657`*^9}, {3.7724397922900877`*^9, 
   3.772439795707053*^9}, 3.77244017684429*^9, {3.772440377162609*^9, 
   3.7724404581790733`*^9}, {3.7724455967282953`*^9, 3.772445640254805*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Lambda]2", "=", "1"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]1", "=", ".506"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"(*", 
       RowBox[{"Abs", "["}], "*)"}], 
      RowBox[{
       RowBox[{"Cq", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cq", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cq", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cq", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{"(*", 
       RowBox[{"Abs", "["}], "*)"}], 
      RowBox[{
       RowBox[{"Cq", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cq", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cq", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cq", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"(*", 
       RowBox[{"Abs", "["}], "*)"}], 
      RowBox[{
       RowBox[{"Cqa", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cqa", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{"(*", 
       RowBox[{"Abs", "["}], "*)"}], 
      RowBox[{
       RowBox[{"Cqa", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", 
    RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.772364525316143*^9, 3.77236452609298*^9}, {
   3.772372396937315*^9, 3.772372415001383*^9}, 3.77237311796066*^9, {
   3.7723737007755613`*^9, 3.7723737188240967`*^9}, {3.7723737525118113`*^9, 
   3.772373756559065*^9}, {3.772374940164611*^9, 3.7723749406118917`*^9}, {
   3.772375107172915*^9, 3.772375113276558*^9}, {3.772375341936801*^9, 
   3.772375342736553*^9}, {3.772375380288937*^9, 3.772375390719099*^9}, {
   3.772375893528729*^9, 3.7723759026335583`*^9}, {3.772376296394185*^9, 
   3.7723763437138243`*^9}, {3.7723763970667267`*^9, 3.772376404770289*^9}, {
   3.772377406392981*^9, 3.772377416216053*^9}, {3.772377466377136*^9, 
   3.772377490000616*^9}, {3.772377650720331*^9, 3.772377652744091*^9}, {
   3.7724405909234343`*^9, 3.772440591298102*^9}, {3.7724463631857977`*^9, 
   3.772446363385128*^9}, {3.772446401881209*^9, 3.7724464062492533`*^9}, {
   3.772446499817471*^9, 3.772446502425023*^9}, 3.786951480919549*^9, {
   3.786951537191986*^9, 3.786951538009397*^9}, 3.788417740188807*^9, {
   3.788417773965372*^9, 3.788417790324458*^9}, {3.7885048672307796`*^9, 
   3.7885048691674833`*^9}, {3.788505178119609*^9, 3.788505197999449*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"Cq", "[", 
    RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], "+", 
  RowBox[{"Cq", "[", 
   RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
  RowBox[{"Cq", "[", 
   RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
  RowBox[{"Cq", "[", 
   RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
  RowBox[{"Cq", "[", 
   RowBox[{"1", ",", "0", ",", "0"}], "]"}], "+", 
  RowBox[{"Cq", "[", 
   RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
  RowBox[{"Cq", "[", 
   RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
  RowBox[{"Cq", "[", 
   RowBox[{"1", ",", "1", ",", "1"}], "]"}]}]], "Output",
 CellChangeTimes->{3.786951539526147*^9, 3.788403283284645*^9, 
  3.788417753093202*^9, 3.788417792003619*^9, 3.788504876709836*^9, 
  3.788505198571817*^9, 3.788527914385002*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"5.268040208823253`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]2"}]}]], "Output",
 CellChangeTimes->{3.786951539526147*^9, 3.788403283284645*^9, 
  3.788417753093202*^9, 3.788417792003619*^9, 3.788504876709836*^9, 
  3.788505198571817*^9, 3.788527914649048*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"(*", 
        RowBox[{"Abs", "["}], "*)"}], 
       RowBox[{
        RowBox[{"Cqa", "[", 
         RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
        RowBox[{"Cqa", "[", 
         RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
        RowBox[{"Cqa", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
        RowBox[{"Cqa", "[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{"(*", 
        RowBox[{"Abs", "["}], "*)"}], 
       RowBox[{
        RowBox[{"Cqa", "[", 
         RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
        RowBox[{"Cqa", "[", 
         RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
        RowBox[{"Cqa", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
        RowBox[{"Cqa", "[", 
         RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]32", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]32", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]32", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]32", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]32", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]32", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]32", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]32", "[", "1", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.772372354097027*^9, 3.77237236233624*^9}, {
  3.772372443194384*^9, 3.772372474312592*^9}, {3.7723731354007673`*^9, 
  3.772373151055459*^9}, {3.7723732098316793`*^9, 3.772373229199974*^9}, {
  3.772375054196787*^9, 3.772375060108384*^9}, {3.772375288094521*^9, 
  3.77237529634181*^9}, {3.7869515679472923`*^9, 3.78695160437245*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2.4129478970416733`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]32", "[", "0", "]"}], "\[Rule]", 
      "0.0001537090825744934`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]32", "[", "0", "]"}], "\[Rule]", "3.1411817844943744`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]32", "[", "1", "]"}], "\[Rule]", 
      "1.5702081488088975`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]32", "[", "1", "]"}], "\[Rule]", 
      "0.0005165686469776674`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.772372229656629*^9, 3.772372427272305*^9, 3.772372475519308*^9, 
   3.7723732602921667`*^9, 3.772373482983139*^9, {3.772373704251555*^9, 
   3.772373721980921*^9}, 3.772373761250647*^9, 3.772374945591619*^9, 
   3.772375079772977*^9, 3.7723752442666407`*^9, {3.772375334703947*^9, 
   3.772375394957336*^9}, 3.772375957103389*^9, 3.772376359270447*^9, 
   3.772376919121994*^9, 3.77237709215241*^9, 3.772436894880805*^9, 
   3.7724370010461493`*^9, 3.772437194065012*^9, {3.772438480686203*^9, 
   3.772438502038825*^9}, 3.7724390377592154`*^9, 3.772441650660499*^9, {
   3.772444252492063*^9, 3.772444281576799*^9}, 3.772444872222376*^9, {
   3.7724450183494797`*^9, 3.7724450242489843`*^9}, 3.7724461857781763`*^9, 
   3.772446304043872*^9, 3.772446369438727*^9, 3.772446440792738*^9, 
   3.786951608251514*^9, 3.788403285562394*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".506"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"(*", 
     RowBox[{"Abs", "["}], "*)"}], 
    RowBox[{
     RowBox[{"Cqa", "[", 
      RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
     RowBox[{"Cqa", "[", 
      RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
     RowBox[{"Cqa", "[", 
      RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
     RowBox[{"Cqa", "[", 
      RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"(*", 
     RowBox[{"Abs", "["}], "*)"}], 
    RowBox[{
     RowBox[{"Cqa", "[", 
      RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
     RowBox[{"Cqa", "[", 
      RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
     RowBox[{"Cqa", "[", 
      RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
     RowBox[{"Cqa", "[", 
      RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "\[Lambda]1", "]"}]}], "Input",
 CellChangeTimes->{{3.772436873702003*^9, 3.7724368822296553`*^9}, {
  3.7724468352123613`*^9, 3.772446844388261*^9}, {3.772447111884777*^9, 
  3.7724471174607687`*^9}, {3.7724978712333593`*^9, 3.772497912648322*^9}, {
  3.78695169401723*^9, 3.786951733669908*^9}, {3.788417850822073*^9, 
  3.788417875162993*^9}, {3.7885048984081087`*^9, 3.78850490022124*^9}, {
  3.7885049637432623`*^9, 3.788504971943903*^9}}],

Cell[BoxData[
 RowBox[{"5.268040208823253`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.786951740225604*^9, 3.7884033247144423`*^9, 
  3.788417883632435*^9, 3.788504901441094*^9, 3.788504973001864*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{
   RowBox[{"Cqa", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], "+", 
   RowBox[{"Cqa", "[", 
    RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
   RowBox[{"Cqa", "[", 
    RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
   RowBox[{"Cqa", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.772446482286983*^9, 3.772446490824416*^9}, {
  3.772446878973234*^9, 3.772446896140106*^9}, {3.7724471557730427`*^9, 
  3.772447156812763*^9}}],

Cell[BoxData["2.83231263816441`"], "Output",
 CellChangeTimes->{
  3.772446491779024*^9, {3.772446882367187*^9, 3.7724468972375097`*^9}, {
   3.772447140969679*^9, 3.772447157688938*^9}, 3.772497897854624*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "3", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 3.772446673256187*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.7885268286539927`*^9, 
  3.7885268367000723`*^9}, {3.788527947492606*^9, 3.788527998438003*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]3", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]3"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}], ".", 
        RowBox[{"\[Rho]C2", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
          "c1", ",", "c2"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq2", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_"}], "]"}],
    ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c3", "*", 
      RowBox[{"P2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c3"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa2", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k33_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "4"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "0", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "1", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "0", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "1", ",", "k33"}], "]"}]}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
  3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
  3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
  3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
  3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
  3.772497266889743*^9, 3.772497283714591*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Lambda]3", "=", "1"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]2", "=", ".543"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]1", "=", ".506"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]33", "[", "0", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]33", "[", "0", "]"}], "=", 
     RowBox[{
      RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]33", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"(*", 
       RowBox[{"Abs", "["}], "*)"}], 
      RowBox[{
       RowBox[{"Cqa2", "[", 
        RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{"(*", 
       RowBox[{"Abs", "["}], "*)"}], 
      RowBox[{
       RowBox[{"Cqa2", "[", 
        RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
       RowBox[{"Cqa2", "[", 
        RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NMaximize", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"(*", 
           RowBox[{"Abs", "["}], "*)"}], 
          RowBox[{
           RowBox[{"Cqa2", "[", 
            RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
           RowBox[{"Cqa2", "[", 
            RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
           RowBox[{"Cqa2", "[", 
            RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
           RowBox[{"Cqa2", "[", 
            RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{"(*", 
           RowBox[{"Abs", "["}], "*)"}], 
          RowBox[{
           RowBox[{"Cqa2", "[", 
            RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
           RowBox[{"Cqa2", "[", 
            RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
           RowBox[{"Cqa2", "[", 
            RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
           RowBox[{"Cqa2", "[", 
            RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], ",", 
        RowBox[{"0", "\[LessEqual]", 
         RowBox[{"\[Theta]33", "[", "0", "]"}], "\[LessEqual]", 
         RowBox[{"\[Pi]", "/", "2"}]}], ",", 
        RowBox[{"0", "\[LessEqual]", 
         RowBox[{"\[Phi]33", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
        
        RowBox[{"0", "\[LessEqual]", 
         RowBox[{"\[Theta]33", "[", "1", "]"}], "\[LessEqual]", 
         RowBox[{"\[Pi]", "/", "2"}]}], ",", 
        RowBox[{"0", "\[LessEqual]", 
         RowBox[{"\[Phi]33", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]33", "[", "0", "]"}], ",", 
        RowBox[{"\[Phi]33", "[", "0", "]"}], ",", 
        RowBox[{"\[Theta]33", "[", "1", "]"}], ",", 
        RowBox[{"\[Phi]33", "[", "1", "]"}]}], "}"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", 
    RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
   3.772497498585828*^9, 3.7724974998972387`*^9}, 3.786951827168229*^9, {
   3.786952027605308*^9, 3.786952028120904*^9}, {3.788417977574526*^9, 
   3.788418005292028*^9}, {3.788505016828611*^9, 3.788505040850543*^9}, {
   3.788505347529038*^9, 3.788505387256744*^9}, {3.7885075593287783`*^9, 
   3.788507563502396*^9}, {3.788525437822459*^9, 3.788525456217333*^9}, {
   3.788525604031497*^9, 3.788525609764406*^9}, {3.78852673271002*^9, 
   3.7885267373254757`*^9}, {3.788526877907447*^9, 3.788526878688282*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"4.875829297248398`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]3"}]}]], "Output",
 CellChangeTimes->{
  3.786952030445326*^9, 3.788403509990912*^9, 3.788418009243689*^9, 
   3.788505109315648*^9, 3.788505389461739*^9, 3.7885075669729567`*^9, 
   3.78852545903231*^9, {3.788525586124011*^9, 3.788525612342093*^9}, 
   3.78852673984638*^9, 3.788526857613781*^9, {3.7885268927658863`*^9, 
   3.788526909185995*^9}, 3.78852803314091*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"(*", 
        RowBox[{"Abs", "["}], "*)"}], 
       RowBox[{
        RowBox[{"Cqa2", "[", 
         RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
        RowBox[{"Cqa2", "[", 
         RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
        RowBox[{"Cqa2", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
        RowBox[{"Cqa2", "[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{"(*", 
        RowBox[{"Abs", "["}], "*)"}], 
       RowBox[{
        RowBox[{"Cqa2", "[", 
         RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
        RowBox[{"Cqa2", "[", 
         RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
        RowBox[{"Cqa2", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
        RowBox[{"Cqa2", "[", 
         RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]33", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]33", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]33", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]33", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]33", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]33", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]33", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]33", "[", "1", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.772497222504849*^9, 3.77249724303236*^9}, {
   3.772497306937887*^9, 3.772497311200631*^9}, {3.786951853488117*^9, 
   3.7869518565181437`*^9}, 3.7869519034059*^9, {3.786951960159471*^9, 
   3.786951974664564*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1.9669132043529312`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]33", "[", "0", "]"}], "\[Rule]", 
      "0.0018300340806828939`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]33", "[", "0", "]"}], "\[Rule]", "3.1415055274064785`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Theta]33", "[", "1", "]"}], "\[Rule]", 
      "1.5701918927199503`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]33", "[", "1", "]"}], "\[Rule]", 
      "0.0006153114127938712`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.788403796966476*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"2", 
   RowBox[{"\[Sqrt]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.772497391285776*^9, 3.772497396584642*^9}}],

Cell[BoxData["2.8284271247461903`"], "Output",
 CellChangeTimes->{3.7724973970352297`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "4", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 3.772446673256187*^9}, {
  3.78850552085009*^9, 3.788505521009758*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.788505542371722*^9, 
  3.788505605029366*^9}, {3.788505642928162*^9, 3.7885057368340693`*^9}, {
  3.78850579391327*^9, 3.788505806595009*^9}, {3.788505890359621*^9, 
  3.7885058904771748`*^9}, {3.788505951296496*^9, 3.788505954015854*^9}, {
  3.7885072816982727`*^9, 3.7885072830730047`*^9}, {3.7885078381511087`*^9, 
  3.7885078473793573`*^9}, {3.788528048196356*^9, 3.7885281019585457`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]4", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]4"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}], ".", 
        RowBox[{"\[Rho]C3", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
          "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_"}], 
    "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c4", "*", 
      RowBox[{"P3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c4"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa3", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k34_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "8"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "k34"}], 
       "]"}], "+", 
      RowBox[{"Cq3", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "k34"}], 
       "]"}]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
   3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
   3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
   3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
   3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
   3.772497266889743*^9, 3.772497283714591*^9}, {3.7885059332211246`*^9, 
   3.7885060376788197`*^9}, {3.788506090352417*^9, 3.788506124005931*^9}, {
   3.788506157241295*^9, 3.788506237809791*^9}, {3.7885063054913387`*^9, 
   3.788506309646616*^9}, {3.788506397431932*^9, 3.788506608133604*^9}, {
   3.788507413570815*^9, 3.788507476866868*^9}, {3.788507524353386*^9, 
   3.788507532318859*^9}, {3.78850775211344*^9, 3.788507819111685*^9}, 
   3.788525024995199*^9, {3.78852510891088*^9, 3.788525150041354*^9}, 
   3.788526026332473*^9, {3.788526935212297*^9, 3.788526945977172*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]3", "=", ".586"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", ".543"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".506"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(*", 
      RowBox[{"Abs", "["}], "*)"}], 
     RowBox[{
      RowBox[{"Cqa3", "[", 
       RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
      RowBox[{"Cqa3", "[", 
       RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
      RowBox[{"Cqa3", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
      RowBox[{"Cqa3", "[", 
       RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{"(*", 
      RowBox[{"Abs", "["}], "*)"}], 
     RowBox[{
      RowBox[{"Cqa3", "[", 
       RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
      RowBox[{"Cqa3", "[", 
       RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
      RowBox[{"Cqa3", "[", 
       RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
      RowBox[{"Cqa3", "[", 
       RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NMaximize", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{"Abs", "["}], "*)"}], 
         RowBox[{
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{"Abs", "["}], "*)"}], 
         RowBox[{
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"0", "\[LessEqual]", 
        RowBox[{"\[Theta]33", "[", "0", "]"}], "\[LessEqual]", 
        RowBox[{"\[Pi]", "/", "2"}]}], ",", 
       RowBox[{"0", "\[LessEqual]", 
        RowBox[{"\[Phi]33", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
       RowBox[{"0", "\[LessEqual]", 
        RowBox[{"\[Theta]33", "[", "1", "]"}], "\[LessEqual]", 
        RowBox[{"\[Pi]", "/", "2"}]}], ",", 
       RowBox[{"0", "\[LessEqual]", 
        RowBox[{"\[Phi]33", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]33", "[", "0", "]"}], ",", 
       RowBox[{"\[Phi]33", "[", "0", "]"}], ",", 
       RowBox[{"\[Theta]33", "[", "1", "]"}], ",", 
       RowBox[{"\[Phi]33", "[", "1", "]"}]}], "}"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3", ",", 
   RowBox[{"\[Theta]33", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]33", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]33", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]33", "[", "1", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
   3.772497498585828*^9, 3.7724974998972387`*^9}, 3.786951827168229*^9, {
   3.786952027605308*^9, 3.786952028120904*^9}, {3.788417977574526*^9, 
   3.788418005292028*^9}, {3.788505016828611*^9, 3.788505040850543*^9}, {
   3.788505347529038*^9, 3.788505387256744*^9}, {3.788507619185297*^9, 
   3.788507648252692*^9}, {3.788507684220276*^9, 3.7885077214691772`*^9}, {
   3.788507868300164*^9, 3.7885078865728292`*^9}, {3.78850810106927*^9, 
   3.788508105479485*^9}, {3.78852518365519*^9, 3.788525247917734*^9}, {
   3.788525287512992*^9, 3.788525291032343*^9}, 3.788526044406982*^9, {
   3.788526129122316*^9, 3.788526150362542*^9}, {3.788526767555501*^9, 
   3.788526807188422*^9}, {3.788526988003459*^9, 3.788526997686419*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"4.386286741563639`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]4"}]}]], "Output",
 CellChangeTimes->{3.788525298065632*^9, 3.788526075097197*^9, 
  3.788526164332095*^9, 3.788526812898288*^9, 3.788526973377186*^9, 
  3.78852700393223*^9, 3.788528127783493*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "5", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.788526338083778*^9, 3.788526339620455*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]GHZ", "=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]GHZ", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.788505542371722*^9, 
  3.788505605029366*^9}, {3.788505642928162*^9, 3.7885057368340693`*^9}, {
  3.78850579391327*^9, 3.788505806595009*^9}, {3.788505890359621*^9, 
  3.7885058904771748`*^9}, {3.788505951296496*^9, 3.788505954015854*^9}, {
  3.7885072816982727`*^9, 3.7885072830730047`*^9}, {3.7885078381511087`*^9, 
  3.7885078473793573`*^9}, {3.788526350589307*^9, 3.78852646328999*^9}, {
  3.788528161658049*^9, 3.788528278750496*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]5", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]5"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}], ".", 
        RowBox[{"\[Rho]C4", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], 
         "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c5", "*", 
      RowBox[{"P4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "a1", ",", "b1", ",", "c5"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa4", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k35_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "16"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "k35"}], 
       "]"}], "+", 
      RowBox[{"Cq4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "k35"}], 
       "]"}]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
   3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
   3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
   3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
   3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
   3.772497266889743*^9, 3.772497283714591*^9}, {3.7885059332211246`*^9, 
   3.7885060376788197`*^9}, {3.788506090352417*^9, 3.788506124005931*^9}, {
   3.788506157241295*^9, 3.788506237809791*^9}, {3.7885063054913387`*^9, 
   3.788506309646616*^9}, {3.788506397431932*^9, 3.788506608133604*^9}, {
   3.788507413570815*^9, 3.788507476866868*^9}, {3.788507524353386*^9, 
   3.788507532318859*^9}, {3.78850775211344*^9, 3.788507819111685*^9}, 
   3.788525024995199*^9, {3.78852510891088*^9, 3.788525150041354*^9}, 
   3.788526026332473*^9, {3.788526477828945*^9, 3.788526596457444*^9}, {
   3.788527079592304*^9, 3.7885273464525337`*^9}, {3.788527620600141*^9, 
   3.78852762070826*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.65"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", ".586"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", ".543"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".506"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(*", 
      RowBox[{"Abs", "["}], "*)"}], 
     RowBox[{
      RowBox[{"Cqa4", "[", 
       RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
      RowBox[{"Cqa4", "[", 
       RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
      RowBox[{"Cqa4", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
      RowBox[{"Cqa4", "[", 
       RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{"(*", 
      RowBox[{"Abs", "["}], "*)"}], 
     RowBox[{
      RowBox[{"Cqa4", "[", 
       RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
      RowBox[{"Cqa4", "[", 
       RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
      RowBox[{"Cqa4", "[", 
       RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
      RowBox[{"Cqa4", "[", 
       RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NMaximize", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{"Abs", "["}], "*)"}], 
         RowBox[{
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{"Abs", "["}], "*)"}], 
         RowBox[{
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"0", "\[LessEqual]", 
        RowBox[{"\[Theta]33", "[", "0", "]"}], "\[LessEqual]", 
        RowBox[{"\[Pi]", "/", "2"}]}], ",", 
       RowBox[{"0", "\[LessEqual]", 
        RowBox[{"\[Phi]33", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
       RowBox[{"0", "\[LessEqual]", 
        RowBox[{"\[Theta]33", "[", "1", "]"}], "\[LessEqual]", 
        RowBox[{"\[Pi]", "/", "2"}]}], ",", 
       RowBox[{"0", "\[LessEqual]", 
        RowBox[{"\[Phi]33", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]33", "[", "0", "]"}], ",", 
       RowBox[{"\[Phi]33", "[", "0", "]"}], ",", 
       RowBox[{"\[Theta]33", "[", "1", "]"}], ",", 
       RowBox[{"\[Phi]33", "[", "1", "]"}]}], "}"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
  "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3", ",", "\[Lambda]4"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
   3.772497498585828*^9, 3.7724974998972387`*^9}, 3.786951827168229*^9, {
   3.786952027605308*^9, 3.786952028120904*^9}, {3.788417977574526*^9, 
   3.788418005292028*^9}, {3.788505016828611*^9, 3.788505040850543*^9}, {
   3.788505347529038*^9, 3.788505387256744*^9}, {3.788507619185297*^9, 
   3.788507648252692*^9}, {3.788507684220276*^9, 3.7885077214691772`*^9}, {
   3.788507868300164*^9, 3.7885078865728292`*^9}, {3.78850810106927*^9, 
   3.788508105479485*^9}, {3.78852518365519*^9, 3.788525247917734*^9}, {
   3.788525287512992*^9, 3.788525291032343*^9}, 3.788526044406982*^9, {
   3.788526129122316*^9, 3.788526150362542*^9}, {3.788527357013254*^9, 
   3.788527425793359*^9}, {3.788527528334896*^9, 3.788527538093656*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"3.8597880405823286`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]5"}]}]], "Output",
 CellChangeTimes->{3.788527385584641*^9, 3.788527448082528*^9, 
  3.788527563169582*^9, 3.788527645336762*^9, 3.788528318045309*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "6", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.788526338083778*^9, 3.788526339620455*^9}, {
  3.788527725308695*^9, 3.78852772634177*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]0", "=", 
     RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]1", "=", 
     RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]2", "=", 
     RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]3", "=", 
     RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1"},
        {"0"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d", "=", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0"},
        {"1"}
       }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]GHZ", "=", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], ".", 
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"u", ",", "u", ",", "u"}], "]"}], "+", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"d", ",", "d", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"x1", "[", 
      RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"\[Sigma]0", "+", 
        RowBox[{"a1", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
           "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
           "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
            "\[Sigma]3"}]}], ")"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"y2", "[", 
      RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"\[Sigma]0", "+", 
        RowBox[{"b1", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
           "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
           "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
            "\[Sigma]3"}]}], ")"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zR31", "[", 
      RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c1", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"c1", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zR32", "[", 
      RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c2", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"c2", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zR33", "[", 
      RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "+", "\[Lambda]3"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c3", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "-", "\[Lambda]3"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"c3", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zR34", "[", 
      RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "+", "\[Lambda]4"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c4", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "-", "\[Lambda]4"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"c4", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zR35", "[", 
      RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "+", "\[Lambda]5"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c5", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        FractionBox[
         RowBox[{"1", "-", "\[Lambda]5"}], "2"], "]"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "-", 
           RowBox[{"c5", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
      "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"x1", "[", 
           RowBox[{"i1", ",", "a1"}], "]"}], ",", 
          RowBox[{"y2", "[", 
           RowBox[{"j2", ",", "b1"}], "]"}], ",", 
          RowBox[{"zR31", "[", 
           RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", 
       "\[Rho]GHZ", ".", 
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"x1", "[", 
           RowBox[{"i1", ",", "a1"}], "]"}], ",", 
          RowBox[{"y2", "[", 
           RowBox[{"j2", ",", "b1"}], "]"}], ",", 
          RowBox[{"zR31", "[", 
           RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", 
       ",", "c1_", ",", "c2_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR32", "[", 
           RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
       RowBox[{"\[Rho]ABC1", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], "]"}],
        ".", 
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR32", "[", 
           RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", 
       ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR33", "[", 
           RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
       RowBox[{"\[Rho]ABC2", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
         "c1", ",", "c2"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR33", "[", 
           RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", 
       "c4_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR34", "[", 
           RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
       RowBox[{"\[Rho]ABC3", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
         "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR34", "[", 
           RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", 
       "c3_", ",", "c4_", ",", "c5_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR35", "[", 
           RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
       RowBox[{"\[Rho]ABC4", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
         "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}],
        ".", 
       RowBox[{"(", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
          RowBox[{"zR35", "[", 
           RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.788505542371722*^9, 
  3.788505605029366*^9}, {3.788505642928162*^9, 3.7885057368340693`*^9}, {
  3.78850579391327*^9, 3.788505806595009*^9}, {3.788505890359621*^9, 
  3.7885058904771748`*^9}, {3.788505951296496*^9, 3.788505954015854*^9}, {
  3.7885072816982727`*^9, 3.7885072830730047`*^9}, {3.7885078381511087`*^9, 
  3.7885078473793573`*^9}, {3.788526350589307*^9, 3.78852646328999*^9}, {
  3.788527735676673*^9, 3.788527853571287*^9}, {3.788528330826366*^9, 
  3.788528373028413*^9}, {3.7885293082994843`*^9, 3.788529319073097*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
        "c4", ",", "c5"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
        "c4", ",", "c5"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]6", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]6"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}], ".", 
        RowBox[{"\[Rho]C5", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
          "c4", ",", "c5"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c6", "*", 
      RowBox[{"P5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c6"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c6", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa5", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k36_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "32"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "1", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "1", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "1", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "1", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "1", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "1", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "0", ",", "1", ",", "1", ",", "1", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "1", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "1", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "0", ",",
         "k36"}], "]"}], "+", 
      RowBox[{"Cq5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",",
         "k36"}], "]"}]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
   3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
   3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
   3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
   3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
   3.772497266889743*^9, 3.772497283714591*^9}, {3.7885059332211246`*^9, 
   3.7885060376788197`*^9}, {3.788506090352417*^9, 3.788506124005931*^9}, {
   3.788506157241295*^9, 3.788506237809791*^9}, {3.7885063054913387`*^9, 
   3.788506309646616*^9}, {3.788506397431932*^9, 3.788506608133604*^9}, {
   3.788507413570815*^9, 3.788507476866868*^9}, {3.788507524353386*^9, 
   3.788507532318859*^9}, {3.78850775211344*^9, 3.788507819111685*^9}, 
   3.788525024995199*^9, {3.78852510891088*^9, 3.788525150041354*^9}, 
   3.788526026332473*^9, {3.788526477828945*^9, 3.788526596457444*^9}, {
   3.788527079592304*^9, 3.7885273464525337`*^9}, {3.788527620600141*^9, 
   3.78852762070826*^9}, {3.7885284168810463`*^9, 3.788528814808003*^9}, {
   3.788529202296526*^9, 3.788529214758431*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.74"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.65"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", ".586"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", ".543"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".506"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", 
   RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"(*", 
      RowBox[{"Abs", "["}], "*)"}], 
     RowBox[{
      RowBox[{"Cqa5", "[", 
       RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
      RowBox[{"Cqa5", "[", 
       RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
      RowBox[{"Cqa5", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
      RowBox[{"Cqa5", "[", 
       RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{"(*", 
      RowBox[{"Abs", "["}], "*)"}], 
     RowBox[{
      RowBox[{"Cqa5", "[", 
       RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
      RowBox[{"Cqa5", "[", 
       RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
      RowBox[{"Cqa5", "[", 
       RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
      RowBox[{"Cqa5", "[", 
       RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NMaximize", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{"Abs", "["}], "*)"}], 
         RowBox[{
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{"Abs", "["}], "*)"}], 
         RowBox[{
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{"Cqa2", "[", 
           RowBox[{"0", ",", "0", ",", "0"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"0", "\[LessEqual]", 
        RowBox[{"\[Theta]33", "[", "0", "]"}], "\[LessEqual]", 
        RowBox[{"\[Pi]", "/", "2"}]}], ",", 
       RowBox[{"0", "\[LessEqual]", 
        RowBox[{"\[Phi]33", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
       RowBox[{"0", "\[LessEqual]", 
        RowBox[{"\[Theta]33", "[", "1", "]"}], "\[LessEqual]", 
        RowBox[{"\[Pi]", "/", "2"}]}], ",", 
       RowBox[{"0", "\[LessEqual]", 
        RowBox[{"\[Phi]33", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]33", "[", "0", "]"}], ",", 
       RowBox[{"\[Phi]33", "[", "0", "]"}], ",", 
       RowBox[{"\[Theta]33", "[", "1", "]"}], ",", 
       RowBox[{"\[Phi]33", "[", "1", "]"}]}], "}"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
  "\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3", ",", "\[Lambda]4", ",", 
   "\[Lambda]5"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
   3.772497498585828*^9, 3.7724974998972387`*^9}, 3.786951827168229*^9, {
   3.786952027605308*^9, 3.786952028120904*^9}, {3.788417977574526*^9, 
   3.788418005292028*^9}, {3.788505016828611*^9, 3.788505040850543*^9}, {
   3.788505347529038*^9, 3.788505387256744*^9}, {3.788507619185297*^9, 
   3.788507648252692*^9}, {3.788507684220276*^9, 3.7885077214691772`*^9}, {
   3.788507868300164*^9, 3.7885078865728292`*^9}, {3.78850810106927*^9, 
   3.788508105479485*^9}, {3.78852518365519*^9, 3.788525247917734*^9}, {
   3.788525287512992*^9, 3.788525291032343*^9}, 3.788526044406982*^9, {
   3.788526129122316*^9, 3.788526150362542*^9}, {3.788527357013254*^9, 
   3.788527425793359*^9}, {3.788527528334896*^9, 3.788527538093656*^9}, {
   3.78852882073094*^9, 3.7885288663222523`*^9}, {3.788529044845997*^9, 
   3.78852904685413*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7885289630170527`*^9, 3.788529154284326*^9, 
  3.7885294786060457`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Mermin", " ", "inequality", " ", "1", "SDI"}]], "Input",
 CellChangeTimes->{{3.7724980892249603`*^9, 3.7724980984561377`*^9}, {
  3.772622619043507*^9, 3.772622619844865*^9}, {3.7884040929491053`*^9, 
  3.7884041063966618`*^9}, {3.7903857206483*^9, 3.790385724808773*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "1"}], " ", "*)"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]w", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z31", "[", 
    RowBox[{"k3_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]1", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]1"}], ")"}], "\[Sigma]0"}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"x1", "[", 
        RowBox[{"i1", ",", "a1"}], "]"}], ",", 
       RowBox[{"y2", "[", 
        RowBox[{"j2", ",", "b1"}], "]"}], ",", 
       RowBox[{"z31", "[", 
        RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ".", "\[Rho]w"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k3_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c1", "*", 
      RowBox[{"P", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cq", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cq", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}]}], "Input",
 CellChangeTimes->{{3.77249821646313*^9, 3.7724982615591297`*^9}, {
   3.772498326927515*^9, 3.772498378903017*^9}, 3.772515431709477*^9, 
   3.7725179566695127`*^9, {3.772621601812951*^9, 3.7726216119893436`*^9}, 
   3.7726221478638973`*^9, {3.7726224611983147`*^9, 3.7726224843115273`*^9}, {
   3.788404396037445*^9, 3.788404475851364*^9}, {3.788405683985794*^9, 
   3.788405684328183*^9}, {3.78840610603273*^9, 3.788406112071198*^9}, {
   3.788418787114934*^9, 3.7884188075987167`*^9}, {3.79038532585987*^9, 
   3.790385327460775*^9}, 3.7903857988667707`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "3"], " ", "\[Lambda]1", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{"3", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
       RowBox[{"3", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.772622485169671*^9, 3.772622544923791*^9, 3.7726227382322607`*^9, {
   3.7726228325300837`*^9, 3.772622855076285*^9}, 3.772786702420631*^9, {
   3.772789587565178*^9, 3.7727896079387207`*^9}, 3.772794226237019*^9, 
   3.788404515900132*^9, 3.788404575124097*^9, 3.7884057027490664`*^9, 
   3.788406112696308*^9, 3.788418819215728*^9, 3.790385338689785*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]1", "=", "1"}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "3"], " ", "\[Lambda]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{"3", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]1", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]1", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"2", "\[Pi]"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]1", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]1", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]2", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]2", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"2", "\[Pi]"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]2", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]2", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"2", "\[Pi]"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]1", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]1", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]1", "[", "1", "]"}], ",", 
     RowBox[{"\[Theta]2", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]2", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]2", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]2", "[", "1", "]"}], ",", 
     RowBox[{"\[Theta]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]31", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "1", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "\[Lambda]1", "]"}]}], "Input",
 CellChangeTimes->{{3.78840459892087*^9, 3.788404606432736*^9}, {
  3.788404664130967*^9, 3.788404679549321*^9}, {3.788405716203868*^9, 
  3.788405731585127*^9}, {3.7903853632639236`*^9, 3.7903854852667847`*^9}, {
  3.790385524064426*^9, 3.7903855721667852`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.045956005991718`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]1", "[", "0", "]"}], "\[Rule]", "2.19856154815315`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Phi]1", "[", "0", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]1", "[", "1", "]"}], "\[Rule]", 
      "0.41703056249690973`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]1", "[", "1", "]"}], "\[Rule]", 
      "6.111854547101848`*^-7"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "0", "]"}], "\[Rule]", 
      "0.4170300286140882`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "0", "]"}], "\[Rule]", 
      "9.137427853266516`*^-8"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "1", "]"}], "\[Rule]", "0.943031829680821`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "1", "]"}], "\[Rule]", "3.1415926281211415`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[Rule]", 
      "2.1985614595287966`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[Rule]", "6.283185268798001`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[Rule]", 
      "0.4170305623627948`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[Rule]", "0.`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.788404682413925*^9, 3.7884057327494297`*^9, 
  3.790385451193465*^9, 3.790385486793395*^9, 3.790385544774786*^9, 
  3.790385577594673*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", "2.19856"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", "0.417031"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", "0.41703"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", "0.943"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", "\[Pi]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "2.19856"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "0.417"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   FractionBox["1", "3"], " ", "\[Lambda]1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{"3", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.772622354157689*^9, 3.772622376252776*^9}, {
  3.772622522285799*^9, 3.7726225335324497`*^9}, {3.7726227209900293`*^9, 
  3.772622734117029*^9}, {3.772622821181335*^9, 3.772622840997213*^9}, {
  3.772789570998803*^9, 3.7727895964308434`*^9}, {3.7884047056257553`*^9, 
  3.788404788097951*^9}, {3.788404867514967*^9, 3.788404868926124*^9}, {
  3.7884049411511917`*^9, 3.788404967748184*^9}, {3.788405005032954*^9, 
  3.78840500910767*^9}, {3.788405819228973*^9, 3.7884059886727333`*^9}, {
  3.788418883211781*^9, 3.788419065562502*^9}, {3.790385607249786*^9, 
  3.790385699736231*^9}}],

Cell[BoxData[
 RowBox[{"3.0459560052917523`", " ", "\[Lambda]1"}]], "Output",
 CellChangeTimes->{
  3.772622422852728*^9, 3.7726224996406193`*^9, 3.788404841670538*^9, 
   3.788404872611307*^9, {3.788404944947702*^9, 3.78840497213763*^9}, 
   3.788405014106427*^9, {3.788405894036092*^9, 3.78840590697775*^9}, 
   3.78840593741039*^9, {3.7884059720128393`*^9, 3.7884059900014067`*^9}, 
   3.788419001079917*^9, 3.7884190677464457`*^9, 3.7903857010833683`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "3.04596"}]], "Input",
 CellChangeTimes->{{3.790385757067608*^9, 3.790385762745504*^9}}],

Cell[BoxData["0.4642915738792023`"], "Output",
 CellChangeTimes->{3.7903857640198393`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "2", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.772446609960565*^9, 3.77244663048814*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]w", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k3_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]w", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7724396794898357`*^9, 3.7724397060260468`*^9}, {
  3.772440724815703*^9, 3.772440742543221*^9}, {3.7724409586980553`*^9, 
  3.77244096752039*^9}, {3.772444178684898*^9, 3.772444211812797*^9}, {
  3.772444537327029*^9, 3.7724445533573008`*^9}, {3.772444588189095*^9, 
  3.772444606004141*^9}, {3.772444671189715*^9, 3.772444702020938*^9}, {
  3.772444995707638*^9, 3.7724450008014936`*^9}, {3.7724453428234167`*^9, 
  3.772445360766842*^9}, {3.772445426351858*^9, 3.7724454327582607`*^9}, {
  3.7884056603763523`*^9, 3.788405668477664*^9}, {3.790385814889509*^9, 
  3.790385820104271*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.77228212089924*^9, 3.7722822685852947`*^9}, {
  3.772282331266062*^9, 3.7722823318570957`*^9}, {3.772283463545506*^9, 
  3.77228349209052*^9}, {3.772283973641814*^9, 3.772283974411016*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]2", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]2"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c2_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}], ".", 
        RowBox[{"\[Rho]C", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
         "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq1", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k3_", ",", "k32_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c2", "*", 
      RowBox[{"P1", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k3", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c2"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k32_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq1", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "k32"}], "]"}], "+", 
      RowBox[{"Cq1", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "k32"}], "]"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7722839012647943`*^9, 3.772283977561111*^9}, {
   3.772284048121008*^9, 3.772284054048564*^9}, {3.772284087168202*^9, 
   3.772284088034628*^9}, {3.772284118360495*^9, 3.7722842019765167`*^9}, {
   3.772284253521983*^9, 3.7722843123126793`*^9}, {3.7722843547692547`*^9, 
   3.772284497593048*^9}, {3.7722845668810177`*^9, 3.772284648655345*^9}, {
   3.772284698048359*^9, 3.7722847759044867`*^9}, {3.772285010010169*^9, 
   3.772285045658825*^9}, {3.7722850761293716`*^9, 3.7722850960199213`*^9}, 
   3.772285178523724*^9, {3.77236447619662*^9, 3.7723645043822403`*^9}, {
   3.772364551064343*^9, 3.772364556213101*^9}, {3.772364601277505*^9, 
   3.772364614932653*^9}, {3.772364721701075*^9, 3.772364745892701*^9}, {
   3.7723654726780863`*^9, 3.7723656214619417`*^9}, 3.772365682158434*^9, {
   3.772368149215102*^9, 3.772368149564683*^9}, {3.772368990526123*^9, 
   3.772369009502626*^9}, {3.772369152968285*^9, 3.772369191208866*^9}, {
   3.772369270426837*^9, 3.7723692825048933`*^9}, {3.772370920799974*^9, 
   3.772370991798862*^9}, {3.772371046990074*^9, 3.772371068092149*^9}, {
   3.772371621786759*^9, 3.772371624106864*^9}, {3.772371947539008*^9, 
   3.772372102130176*^9}, {3.772376543946974*^9, 3.772376565306912*^9}, {
   3.772376674553438*^9, 3.772376690540468*^9}, {3.77237673847546*^9, 
   3.7723767616748953`*^9}, {3.772376828676401*^9, 3.772376910123201*^9}, {
   3.772436966608683*^9, 3.772436991934647*^9}, {3.772437088384615*^9, 
   3.7724371779271383`*^9}, {3.772437263415668*^9, 3.772437271287508*^9}, {
   3.772438707944784*^9, 3.7724389669530373`*^9}, {3.7724389991700687`*^9, 
   3.7724390125135593`*^9}, {3.7724393895462713`*^9, 3.772439398305973*^9}, {
   3.772439675603006*^9, 3.7724397014515657`*^9}, {3.7724397922900877`*^9, 
   3.772439795707053*^9}, 3.77244017684429*^9, {3.772440377162609*^9, 
   3.7724404581790733`*^9}, {3.7724455967282953`*^9, 3.772445640254805*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Lambda]2", "=", "1"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]1", "=", ".464"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]1", "[", "0", "]"}], "=", "2.19856"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]1", "[", "1", "]"}], "=", "0.417031"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]1", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]2", "[", "0", "]"}], "=", "0.41703"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]2", "[", "1", "]"}], "=", "0.943"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]2", "[", "1", "]"}], "=", "\[Pi]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "2.19856"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "0.417"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "2.19856"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "0.417"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cqa", "[", 
       RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
      RowBox[{"Cqa", "[", 
       RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
      RowBox[{"Cqa", "[", 
       RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
      RowBox[{"Cqa", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", 
    RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.772364525316143*^9, 3.77236452609298*^9}, {
   3.772372396937315*^9, 3.772372415001383*^9}, 3.77237311796066*^9, {
   3.7723737007755613`*^9, 3.7723737188240967`*^9}, {3.7723737525118113`*^9, 
   3.772373756559065*^9}, {3.772374940164611*^9, 3.7723749406118917`*^9}, {
   3.772375107172915*^9, 3.772375113276558*^9}, {3.772375341936801*^9, 
   3.772375342736553*^9}, {3.772375380288937*^9, 3.772375390719099*^9}, {
   3.772375893528729*^9, 3.7723759026335583`*^9}, {3.772376296394185*^9, 
   3.7723763437138243`*^9}, {3.7723763970667267`*^9, 3.772376404770289*^9}, {
   3.772377406392981*^9, 3.772377416216053*^9}, {3.772377466377136*^9, 
   3.772377490000616*^9}, {3.772377650720331*^9, 3.772377652744091*^9}, {
   3.7724405909234343`*^9, 3.772440591298102*^9}, {3.7724463631857977`*^9, 
   3.772446363385128*^9}, {3.772446401881209*^9, 3.7724464062492533`*^9}, {
   3.772446499817471*^9, 3.772446502425023*^9}, {3.772794315281715*^9, 
   3.772794316648402*^9}, {3.788405127987102*^9, 3.788405166488482*^9}, {
   3.788405466461115*^9, 3.7884054733897448`*^9}, {3.788405510697042*^9, 
   3.788405537658779*^9}, {3.788406040239809*^9, 3.788406044805222*^9}, {
   3.78841916147596*^9, 3.788419172812961*^9}, {3.790385865196827*^9, 
   3.790385880293264*^9}, {3.790385995922737*^9, 3.790386005712973*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.8796948295078275`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]2"}]}]], "Output",
 CellChangeTimes->{3.7884051681544847`*^9, 3.788405381680544*^9, 
  3.7884054807098293`*^9, 3.7884055466966*^9, 3.7884060492807426`*^9, 
  3.788419178137855*^9, 3.790385885368998*^9, 3.79038600706754*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "2.87969"}]], "Input",
 CellChangeTimes->{{3.790386017706513*^9, 3.7903860271118317`*^9}}],

Cell[BoxData["0.4910992372002178`"], "Output",
 CellChangeTimes->{3.7903860277705383`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.7867656786263526`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "\[Lambda]2", 
       " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]32", "[", "0", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1.4364474476305071`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "\[Lambda]2", 
       " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]32", "[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1.0564882086664937`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "\[Lambda]2", 
       " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]32", "[", "0", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]32", "[", "0", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.6152345787038673`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "\[Lambda]2", 
       " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]32", "[", "1", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]32", "[", "1", "]"}], "]"}]}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]32", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]32", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"2", "\[Pi]"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]32", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]32", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"2", "\[Pi]"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", "\[Lambda]2", "\[LessEqual]", "1"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]32", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]32", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]32", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]32", "[", "1", "]"}], ",", "\[Lambda]2"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.772372354097027*^9, 3.77237236233624*^9}, {
   3.772372443194384*^9, 3.772372474312592*^9}, {3.7723731354007673`*^9, 
   3.772373151055459*^9}, {3.7723732098316793`*^9, 3.772373229199974*^9}, {
   3.772375054196787*^9, 3.772375060108384*^9}, {3.772375288094521*^9, 
   3.77237529634181*^9}, 3.772793923819684*^9, 3.788405205384755*^9, 
   3.78840606547785*^9, {3.790385917038891*^9, 3.790385979888339*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2.879913138949894`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]32", "[", "0", "]"}], "\[Rule]", 
      "2.2108961308158372`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]32", "[", "0", "]"}], "\[Rule]", "6.282532032978326`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]32", "[", "1", "]"}], "\[Rule]", 
      "0.4046648953449526`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]32", "[", "1", "]"}], "\[Rule]", 
      "0.002236134732724958`"}], ",", 
     RowBox[{"\[Lambda]2", "\[Rule]", "0.9999999949203163`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.772372229656629*^9, 3.772372427272305*^9, 3.772372475519308*^9, 
   3.7723732602921667`*^9, 3.772373482983139*^9, {3.772373704251555*^9, 
   3.772373721980921*^9}, 3.772373761250647*^9, 3.772374945591619*^9, 
   3.772375079772977*^9, 3.7723752442666407`*^9, {3.772375334703947*^9, 
   3.772375394957336*^9}, 3.772375957103389*^9, 3.772376359270447*^9, 
   3.772376919121994*^9, 3.77237709215241*^9, 3.772436894880805*^9, 
   3.7724370010461493`*^9, 3.772437194065012*^9, {3.772438480686203*^9, 
   3.772438502038825*^9}, 3.7724390377592154`*^9, 3.772441650660499*^9, {
   3.772444252492063*^9, 3.772444281576799*^9}, 3.772444872222376*^9, {
   3.7724450183494797`*^9, 3.7724450242489843`*^9}, 3.7724461857781763`*^9, 
   3.772446304043872*^9, 3.772446369438727*^9, 3.772446440792738*^9, 
   3.772793926006649*^9, 3.788405208098178*^9, 3.788405483973918*^9, 
   3.788405561865431*^9, 3.7884060681636963`*^9, {3.790385934186858*^9, 
   3.790385981155979*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "3", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 3.772446673256187*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]w", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]w", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.7903860490101757`*^9, 
  3.7903860579803*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]3", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]3"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}], ".", 
        RowBox[{"\[Rho]C2", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
          "c1", ",", "c2"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq2", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_"}], "]"}],
    ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c3", "*", 
      RowBox[{"P2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c3"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa2", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k33_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "4"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "0", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "1", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "0", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "1", ",", "k33"}], "]"}]}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
  3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
  3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
  3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
  3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
  3.772497266889743*^9, 3.772497283714591*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.49"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".464"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", "2.19856"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", "0.417031"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", "0.41703"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", "0.943"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", "\[Pi]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "2.19856"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "0.417"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "2.19856"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "0.417"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "2.19856"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "0.417"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa2", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa2", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa2", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa2", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]1", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]1", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]1", "[", "1", "]"}], ",", 
   RowBox[{"\[Theta]2", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]2", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]2", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]2", "[", "1", "]"}], ",", 
   RowBox[{"\[Theta]31", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]31", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]31", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]31", "[", "1", "]"}], ",", "\[Lambda]1", ",", 
   RowBox[{"\[Theta]32", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]32", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]32", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]32", "[", "1", "]"}], ",", 
   RowBox[{"\[Theta]33", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]33", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]33", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]33", "[", "1", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
  3.772497498585828*^9, 3.7724974998972387`*^9}, {3.7884195276740513`*^9, 
  3.788419645143351*^9}, {3.7903861006373453`*^9, 3.7903861628372583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "5.551115123125783`*^-17"}], "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.7132017010285927`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]3"}]}]], "Output",
 CellChangeTimes->{{3.772497294585433*^9, 3.772497313149139*^9}, 
   3.772497506192107*^9, 3.772794930399794*^9, 3.788419587370554*^9, 
   3.7884196459242687`*^9, 3.790386175278575*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "2.7132"}]], "Input",
 CellChangeTimes->{{3.790386180217023*^9, 3.790386186700212*^9}}],

Cell[BoxData["0.5212345431125959`"], "Output",
 CellChangeTimes->{3.7903861876865997`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "4", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.790386326726796*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]w", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]w", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]ABC3", "[", 
     RowBox[{
     "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", 
      ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
         RowBox[{"zR33", "[", 
          RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
      RowBox[{"\[Rho]ABC2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
         RowBox[{"zR33", "[", 
          RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], ";"}],
   "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"In", "[", "163", "]"}], ":=", 
  RowBox[{
   RowBox[{"SwapParts", "[", 
    RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{"#", ",", "#", ",", 
       RowBox[{"{", 
        RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
    "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.790386326726796*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"z34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]4"}], ")"}], "/", "2"}], " ", 
     "\[Sigma]0"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"P3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}], ".", 
        RowBox[{"\[Rho]C3", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
          "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_"}], 
    "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c4", "*", 
      RowBox[{"P3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c4"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa3", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k34_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "8"}], " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Cq3", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34"}], 
        "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.7903863671511793`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.52"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.49"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".464"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", "0.417031"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", "0.41703"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", "0.943"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", "\[Pi]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa3", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa3", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa3", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa3", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}], "\n"}], "Input",\

 CellChangeTimes->{{3.790386262933346*^9, 3.790386443525386*^9}, {
  3.7903864830739803`*^9, 3.7903864938179293`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.516096826712452`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]4"}]}]], "Output",
 CellChangeTimes->{{3.790386475863221*^9, 3.7903864968645144`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "2.5161"}]], "Input",
 CellChangeTimes->{{3.790386498922194*^9, 3.7903865054675207`*^9}}],

Cell[BoxData["0.5620657217014806`"], "Output",
 CellChangeTimes->{3.790386506614255*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"CHARLIE", " ", "5", " ", "Come", " ", "in", " ", "picture"}], 
   "*)"}], "\n"}]], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.7903863753838167`*^9}, {
  3.7903865129328833`*^9, 3.790386548993305*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]w", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]4"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]4"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]w", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]ABC4", "[", 
     RowBox[{
     "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
      ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", 
      "c4_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
         RowBox[{"zR34", "[", 
          RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
      RowBox[{"\[Rho]ABC3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
         RowBox[{"zR34", "[", 
          RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], ";"}],
   "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}], "\n"}], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.7903863753838167`*^9}, {
  3.7903865129328833`*^9, 3.790386548993305*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"z35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]5", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]5"}], ")"}], "/", "2"}], " ", 
     "\[Sigma]0"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"P4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}], ".", 
        RowBox[{"\[Rho]C4", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], 
         "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c5", "*", 
      RowBox[{"P4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "a1", ",", "b1", ",", "c5"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cqa4", "[", 
     RowBox[{"i1_", ",", "j2_", ",", "k35_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"1", "/", "16"}], " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cq4", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35"}], "]"}], ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.56"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.52"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.49"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".464"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", "0.417031"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", "0.41703"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", "0.943"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", "\[Pi]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa4", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa4", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa4", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa4", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.7903863753838167`*^9}, {
  3.7903865129328833`*^9, 3.790386623532679*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.3116328626602396`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]5"}]}]], "Output",
 CellChangeTimes->{3.790386634711175*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "2.31163"}]], "Input",
 CellChangeTimes->{{3.790386638875907*^9, 3.790386645806705*^9}}],

Cell[BoxData["0.611781973054985`"], "Output",
 CellChangeTimes->{3.790386646474576*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"CHARLIE", " ", "6", " ", "Come", " ", "in", " ", "picture"}], 
   "*)"}], "\n"}]], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.7903863753838167`*^9}, {
  3.7903865129328833`*^9, 3.7903867018728733`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]w", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]4"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]4"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]5"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]5"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]w", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.7903863753838167`*^9}, {
  3.7903865129328833`*^9, 3.7903867018728733`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
        "c4", ",", "c5"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
        "c4", ",", "c5"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"z36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]6", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]6"}], ")"}], "/", "2"}], " ", 
     "\[Sigma]0"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"P5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}], ".", 
        RowBox[{"\[Rho]C5", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
          "c4", ",", "c5"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c6", "*", 
      RowBox[{"P5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c6"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c6", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cqa5", "[", 
     RowBox[{"i1_", ",", "j2_", ",", "k36_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"1", "/", "32"}], " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cq5", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36"}], "]"}], ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.6117"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.56"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.52"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.49"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".464"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", "0.417031"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", "0.41703"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", "0.943"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", "\[Pi]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa5", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa5", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa5", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa5", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}]}], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.7903863753838167`*^9}, {
  3.7903865129328833`*^9, 3.790386774710412*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.083742170473158`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]6"}]}]], "Output",
 CellChangeTimes->{3.790386850871464*^9, 3.7903869338851757`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "2.08374"}]], "Input",
 CellChangeTimes->{{3.7903869732750874`*^9, 3.7903869822869473`*^9}}],

Cell[BoxData["0.6786900296452989`"], "Output",
 CellChangeTimes->{3.7903869833717546`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"CHARLIE", " ", "7", " ", "Come", " ", "in", " ", "picture"}], 
   "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.7903863753838167`*^9}, {
  3.7903865129328833`*^9, 3.790386821321089*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]w", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]4"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]4"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]5"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]5"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]6"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]6"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]w", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]ABC6", "[", 
     RowBox[{
     "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
      ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", 
      "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
         RowBox[{"zR36", "[", 
          RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}], ".", 
      RowBox[{"\[Rho]ABC5", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
        "c4", ",", "c5"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
         RowBox[{"zR36", "[", 
          RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}]}], ")"}]}], ";"}],
   "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.7903863753838167`*^9}, {
  3.7903865129328833`*^9, 3.790386821321089*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]BC6", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", 
       "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"TraceSystem", "[", 
       RowBox[{
        RowBox[{"\[Rho]ABC6", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",",
           "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]C6", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", 
       "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"TraceSystem", "[", 
       RowBox[{
        RowBox[{"\[Rho]BC6", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",",
           "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"z37", "[", 
      RowBox[{"k37_", ",", "c7_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Lambda]7", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c7", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Lambda]7"}], ")"}], "/", "2"}], " ", 
       "\[Sigma]0"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"P6", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
       "c7_"}], "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"z37", "[", 
           RowBox[{"k37", ",", "c7"}], "]"}], ".", 
          RowBox[{"\[Rho]C6", "[", 
           RowBox[{
           "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", 
            ",", "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", 
            "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}]}], 
         "]"}], ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"c1", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c2", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c3", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c4", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c5", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c6", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Cq6", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "k36_", ",", "k37_"}], "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"a1", "*", "b1", "*", "c7", "*", 
        RowBox[{"P6", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c7"}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"a1", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b1", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c7", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Cqa6", "[", 
      RowBox[{"i1_", ",", "j2_", ",", "k37_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"1", "/", "64"}], " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Cq6", "[", 
          RowBox[{
          "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", 
           ",", "k35", ",", "k36", ",", "k37"}], "]"}], ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k36", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"\[Lambda]6", "=", "0.68"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Lambda]5", "=", "0.6117"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Lambda]4", "=", "0.56"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Lambda]3", "=", "0.52"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]2", "=", "0.49"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]1", "=", ".464"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]1", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]1", "[", "1", "]"}], "=", "0.417031"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]1", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]2", "[", "0", "]"}], "=", "0.41703"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]2", "[", "1", "]"}], "=", "0.943"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]2", "[", "1", "]"}], "=", "\[Pi]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]36", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]36", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]36", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]37", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]37", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]37", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]37", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cqa6", "[", 
       RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
      RowBox[{"Cqa6", "[", 
       RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
      RowBox[{"Cqa6", "[", 
       RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
      RowBox[{"Cqa6", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.790386262933346*^9, 3.7903863753838167`*^9}, {
  3.7903865129328833`*^9, 3.7903868589333153`*^9}, {3.790386905081788*^9, 
  3.7903869175939827`*^9}, {3.7903869944426537`*^9, 3.790386995997109*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1.8227139532390817`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]7"}]}]], "Output",
 CellChangeTimes->{3.7903871909458237`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "1.82271"}]], "Input",
 CellChangeTimes->{{3.790387461197522*^9, 3.790387471522468*^9}}],

Cell[BoxData["0.7758851174202671`"], "Output",
 CellChangeTimes->{3.7903874725891323`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "8", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7903875081810703`*^9, 3.790387572936689*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]w", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]4"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]4"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]5"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]5"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]6"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]6"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR37", "[", 
    RowBox[{"k37_", ",", "c7_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]7"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]7"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]w", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
       "c4", ",", "c5"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]ABC7", "[", 
     RowBox[{
     "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
      ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
      "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
      "c7_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
         RowBox[{"zR37", "[", 
          RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}], ".", 
      RowBox[{"\[Rho]ABC6", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
        "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
         RowBox[{"zR37", "[", 
          RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}]}], ")"}]}], ";"}],
   "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7903875081810703`*^9, 3.790387572936689*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC7", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", ",", 
        "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC7", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", ",", 
        "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"z38", "[", 
    RowBox[{"k38_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]8", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]8"}], ")"}], "/", "2"}], " ", 
     "\[Sigma]0"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"P7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
     "b1_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z38", "[", 
         RowBox[{"k38", ",", "c8"}], "]"}], ".", 
        RowBox[{"\[Rho]C7", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", 
          ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], 
         "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c6", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c7", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c8", "*", 
      RowBox[{"P7", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", "b1", ",", 
        "c8"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c8", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cqa7", "[", 
     RowBox[{"i1_", ",", "j2_", ",", "k38_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"1", "/", "128"}], " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cq7", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "k37", ",", "k38"}], "]"}], ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k36", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k37", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"\[Lambda]7", "=", "0.776"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Lambda]6", "=", "0.68"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Lambda]5", "=", "0.6117"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.56"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.52"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.49"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".464"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", "0.417031"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", "0.41703"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", "0.943"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", "\[Pi]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]36", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]36", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]37", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]37", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]37", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]37", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]38", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]38", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]38", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]38", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cqa7", "[", 
      RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
     RowBox[{"Cqa7", "[", 
      RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
     RowBox[{"Cqa7", "[", 
      RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
     RowBox[{"Cqa7", "[", 
      RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7903875081810703`*^9, 3.790387653652933*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1.5087337688662075`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]8"}]}]], "Output",
 CellChangeTimes->{3.790388467338925*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "1.50873"}]], "Input",
 CellChangeTimes->{{3.790388495385236*^9, 3.790388511471719*^9}, {
  3.790388553464799*^9, 3.790388558416993*^9}}],

Cell[BoxData["0.9373536433776058`"], "Output",
 CellChangeTimes->{{3.790388498505094*^9, 3.790388503953805*^9}, 
   3.790388559371697*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"CHARLIE", " ", "9", " ", "Come", " ", "in", " ", "picture"}], 
   "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7903875081810703`*^9, 3.790387653652933*^9}, 
   3.790388821801855*^9, {3.7903889235161037`*^9, 3.7903889470961227`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]w", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]4"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]4"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]5"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]5"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR36", "[", 
    RowBox[{"k36_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]6"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]6"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c6", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]36", "[", "k36", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR37", "[", 
    RowBox[{"k37_", ",", "c7_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]7"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]7"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c7", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]37", "[", "k37", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR38", "[", 
    RowBox[{"k38_", ",", "c8_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]8"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]8"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c8", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]38", "[", "k38", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "w", ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC3", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
       "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC5", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", 
     ",", "c4_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC4", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC6", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_",
      ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC5", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", 
       "c4", ",", "c5"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR36", "[", 
         RowBox[{"k36", ",", "c6"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC7", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "k36_", ",", "k37_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", "c6_", ",", 
     "c7_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC6", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
       "k35", ",", "k36", ",", "a1", ",", "b1", ",", "c1", ",", "c2", ",", 
       "c3", ",", "c4", ",", "c5", ",", "c6"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR37", "[", 
         RowBox[{"k37", ",", "c7"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]ABC8", "[", 
     RowBox[{
     "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
      ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",", 
      "c6_", ",", "c7_", ",", "c8_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
         RowBox[{"zR38", "[", 
          RowBox[{"k38", ",", "c8"}], "]"}]}], "]"}], ")"}], ".", 
      RowBox[{"\[Rho]ABC7", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "k36", ",", "k37", ",", "a1", ",", "b1", ",", "c1", ",", 
        "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", ",", "c7"}], "]"}], 
      ".", 
      RowBox[{"(", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
         RowBox[{"zR38", "[", 
          RowBox[{"k38", ",", "c8"}], "]"}]}], "]"}], ")"}]}], ")"}]}], ";"}],
   "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7903875081810703`*^9, 3.790387653652933*^9}, 
   3.790388821801855*^9, {3.7903889235161037`*^9, 3.790388951696138*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]BC8", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
       "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",",
        "c6_", ",", "c7_", ",", "c8_"}], "]"}], ":=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"TraceSystem", "[", 
       RowBox[{
        RowBox[{"\[Rho]ABC8", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", "b1", 
          ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", 
          ",", "c7", ",", "c8"}], "]"}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Rho]C8", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "a1_", ",", 
       "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_", ",", "c5_", ",",
        "c6_", ",", "c7_", ",", "c8_"}], "]"}], ":=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"TraceSystem", "[", 
       RowBox[{
        RowBox[{"\[Rho]BC8", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", "b1", 
          ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", "c6", 
          ",", "c7", ",", "c8"}], "]"}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"z39", "[", 
      RowBox[{"k39_", ",", "c9_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Lambda]9", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[Sigma]0", "+", 
           RowBox[{"c9", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
               "\[Sigma]1"}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]39", "[", "k39", "]"}], "]"}], "*", 
               "\[Sigma]2"}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]39", "[", "k39", "]"}], "]"}], "*", 
               "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Lambda]9"}], ")"}], "/", "2"}], " ", 
       "\[Sigma]0"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"P8", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_", ",", 
       "a1_", ",", "b1_", ",", "c9_"}], "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Tr", "[", 
         RowBox[{
          RowBox[{"z39", "[", 
           RowBox[{"k39", ",", "c9"}], "]"}], ".", 
          RowBox[{"\[Rho]C8", "[", 
           RowBox[{
           "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", 
            ",", "k35", ",", "k36", ",", "k37", ",", "k38", ",", "a1", ",", 
            "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4", ",", "c5", ",", 
            "c6", ",", "c7", ",", "c8"}], "]"}]}], "]"}], ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"c1", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c2", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c3", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c4", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c5", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c6", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c7", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c8", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Cq8", "[", 
      RowBox[{
      "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
       ",", "k35_", ",", "k36_", ",", "k37_", ",", "k38_", ",", "k39_"}], 
      "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"a1", "*", "b1", "*", "c9", "*", 
        RowBox[{"P8", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39", ",", "a1", 
          ",", "b1", ",", "c9"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"a1", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b1", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c9", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Cqa8", "[", 
      RowBox[{"i1_", ",", "j2_", ",", "k39_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"1", "/", "256"}], " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Cq8", "[", 
          RowBox[{
          "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", 
           ",", "k35", ",", "k36", ",", "k37", ",", "k38", ",", "k39"}], 
          "]"}], ")"}], ",", 
        RowBox[{"{", 
         RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k35", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k36", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k37", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k38", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"\[Lambda]8", "=", "0.938"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Lambda]7", "=", "0.776"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Lambda]6", "=", "0.68"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Lambda]5", "=", "0.6117"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Lambda]4", "=", "0.56"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Lambda]3", "=", "0.52"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]2", "=", "0.49"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]1", "=", ".464"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]1", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]1", "[", "1", "]"}], "=", "0.417031"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]1", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]2", "[", "0", "]"}], "=", "0.41703"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]2", "[", "1", "]"}], "=", "0.943"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]2", "[", "1", "]"}], "=", "\[Pi]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]36", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]36", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]36", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]36", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]37", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]37", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]37", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]37", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]38", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]38", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]38", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]38", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]39", "[", "0", "]"}], "=", "2.19856"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]39", "[", "0", "]"}], "=", "0"}], ";", 
    RowBox[{
     RowBox[{"\[Theta]39", "[", "1", "]"}], "=", "0.417"}], ";", 
    RowBox[{
     RowBox[{"\[Phi]39", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cqa8", "[", 
       RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
      RowBox[{"Cqa8", "[", 
       RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
      RowBox[{"Cqa8", "[", 
       RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
      RowBox[{"Cqa8", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.7903875081810703`*^9, 3.790387653652933*^9}, 
   3.790388821801855*^9, {3.7903889235161037`*^9, 3.7903890160590763`*^9}}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.7903889301031303`*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.790388936112961*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.79637`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]9"}]}]], "Output",
 CellChangeTimes->{3.7903889361208897`*^9}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.790388936125619*^9}],

Cell[BoxData["0.505732`"], "Output",
 CellChangeTimes->{3.790388936129777*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Mermin", " ", "inequality", " ", "2", "SDI"}]], "Input",
 CellChangeTimes->{{3.7724980892249603`*^9, 3.7724980984561377`*^9}, {
  3.772622619043507*^9, 3.772622619844865*^9}, {3.7884040929491053`*^9, 
  3.7884041063966618`*^9}, {3.7903857206483*^9, 3.790385724808773*^9}, {
  3.790389131639634*^9, 3.7903891337196293`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "1"}], " ", "*)"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]w", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z31", "[", 
    RowBox[{"k3_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]1", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]1"}], ")"}], "\[Sigma]0"}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"KroneckerProduct", "[", 
      RowBox[{
       RowBox[{"x1", "[", 
        RowBox[{"i1", ",", "a1"}], "]"}], ",", 
       RowBox[{"y2", "[", 
        RowBox[{"j2", ",", "b1"}], "]"}], ",", 
       RowBox[{"z31", "[", 
        RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ".", "\[Rho]w"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k3_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c1", "*", 
      RowBox[{"P", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cq", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cq", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cq", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}]}], "Input",
 CellChangeTimes->{{3.77249821646313*^9, 3.7724982615591297`*^9}, {
   3.772498326927515*^9, 3.772498378903017*^9}, 3.772515431709477*^9, 
   3.7725179566695127`*^9, {3.772621601812951*^9, 3.7726216119893436`*^9}, 
   3.7726221478638973`*^9, {3.7726224611983147`*^9, 3.7726224843115273`*^9}, {
   3.788404396037445*^9, 3.788404475851364*^9}, {3.788405683985794*^9, 
   3.788405684328183*^9}, {3.78840610603273*^9, 3.788406112071198*^9}, {
   3.788418787114934*^9, 3.7884188075987167`*^9}, {3.79038532585987*^9, 
   3.790385327460775*^9}, 3.7903857988667707`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "3"], " ", "\[Lambda]1", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
       RowBox[{"3", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
       RowBox[{"3", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.772622485169671*^9, 3.772622544923791*^9, 3.7726227382322607`*^9, {
   3.7726228325300837`*^9, 3.772622855076285*^9}, 3.772786702420631*^9, {
   3.772789587565178*^9, 3.7727896079387207`*^9}, 3.772794226237019*^9, 
   3.788404515900132*^9, 3.788404575124097*^9, 3.7884057027490664`*^9, 
   3.788406112696308*^9, 3.788418819215728*^9, 3.790385338689785*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]1", "=", "1"}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]1", "[", "0", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]1", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Phi]1", "[", "1", "]"}], "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "3"], " ", "\[Lambda]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{"3", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]1", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]1", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"2", "\[Pi]"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]1", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]1", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]2", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]2", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"2", "\[Pi]"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]2", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]2", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"2", "\[Pi]"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]1", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]1", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]1", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]1", "[", "1", "]"}], ",", 
     RowBox[{"\[Theta]2", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]2", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]2", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]2", "[", "1", "]"}], ",", 
     RowBox[{"\[Theta]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]31", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]31", "[", "1", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "\[Lambda]1", "]"}]}], "Input",
 CellChangeTimes->{{3.78840459892087*^9, 3.788404606432736*^9}, {
  3.788404664130967*^9, 3.788404679549321*^9}, {3.788405716203868*^9, 
  3.788405731585127*^9}, {3.7903853632639236`*^9, 3.7903854852667847`*^9}, {
  3.790385524064426*^9, 3.7903855721667852`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.045956005991718`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]1", "[", "0", "]"}], "\[Rule]", "2.19856154815315`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Phi]1", "[", "0", "]"}], "\[Rule]", "0.`"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]1", "[", "1", "]"}], "\[Rule]", 
      "0.41703056249690973`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]1", "[", "1", "]"}], "\[Rule]", 
      "6.111854547101848`*^-7"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "0", "]"}], "\[Rule]", 
      "0.4170300286140882`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "0", "]"}], "\[Rule]", 
      "9.137427853266516`*^-8"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "[", "1", "]"}], "\[Rule]", "0.943031829680821`"}],
      ",", 
     RowBox[{
      RowBox[{"\[Phi]2", "[", "1", "]"}], "\[Rule]", "3.1415926281211415`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]31", "[", "0", "]"}], "\[Rule]", 
      "2.1985614595287966`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]31", "[", "0", "]"}], "\[Rule]", "6.283185268798001`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]31", "[", "1", "]"}], "\[Rule]", 
      "0.4170305623627948`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]31", "[", "1", "]"}], "\[Rule]", "0.`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.788404682413925*^9, 3.7884057327494297`*^9, 
  3.790385451193465*^9, 3.790385486793395*^9, 3.790385544774786*^9, 
  3.790385577594673*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", "2.19856"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", "0.417031"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", "0.41703"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", "0.943"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", "\[Pi]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "2.19856"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "0.417"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   FractionBox["1", "3"], " ", "\[Lambda]1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]1", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "[", "1", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "[", "0", "]"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "-", 
        RowBox[{"3", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "0", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]31", "[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "[", "0", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]31", "[", "1", "]"}], "]"}]}]}], ")"}]}]}], 
       ")"}]}]}], ")"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.772622354157689*^9, 3.772622376252776*^9}, {
  3.772622522285799*^9, 3.7726225335324497`*^9}, {3.7726227209900293`*^9, 
  3.772622734117029*^9}, {3.772622821181335*^9, 3.772622840997213*^9}, {
  3.772789570998803*^9, 3.7727895964308434`*^9}, {3.7884047056257553`*^9, 
  3.788404788097951*^9}, {3.788404867514967*^9, 3.788404868926124*^9}, {
  3.7884049411511917`*^9, 3.788404967748184*^9}, {3.788405005032954*^9, 
  3.78840500910767*^9}, {3.788405819228973*^9, 3.7884059886727333`*^9}, {
  3.788418883211781*^9, 3.788419065562502*^9}, {3.790385607249786*^9, 
  3.790385699736231*^9}}],

Cell[BoxData[
 RowBox[{"3.0459560052917523`", " ", "\[Lambda]1"}]], "Output",
 CellChangeTimes->{
  3.772622422852728*^9, 3.7726224996406193`*^9, 3.788404841670538*^9, 
   3.788404872611307*^9, {3.788404944947702*^9, 3.78840497213763*^9}, 
   3.788405014106427*^9, {3.788405894036092*^9, 3.78840590697775*^9}, 
   3.78840593741039*^9, {3.7884059720128393`*^9, 3.7884059900014067`*^9}, 
   3.788419001079917*^9, 3.7884190677464457`*^9, 3.7903857010833683`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "3.04596"}]], "Input",
 CellChangeTimes->{{3.790385757067608*^9, 3.790385762745504*^9}}],

Cell[BoxData["0.4642915738792023`"], "Output",
 CellChangeTimes->{3.7903857640198393`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "2", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.772446609960565*^9, 3.77244663048814*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]w", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k3_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]1"}],
             "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k3", "]"}], "]"}], "*", "\[Sigma]2"}],
             "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k3", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]w", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k3", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7724396794898357`*^9, 3.7724397060260468`*^9}, {
  3.772440724815703*^9, 3.772440742543221*^9}, {3.7724409586980553`*^9, 
  3.77244096752039*^9}, {3.772444178684898*^9, 3.772444211812797*^9}, {
  3.772444537327029*^9, 3.7724445533573008`*^9}, {3.772444588189095*^9, 
  3.772444606004141*^9}, {3.772444671189715*^9, 3.772444702020938*^9}, {
  3.772444995707638*^9, 3.7724450008014936`*^9}, {3.7724453428234167`*^9, 
  3.772445360766842*^9}, {3.772445426351858*^9, 3.7724454327582607`*^9}, {
  3.7884056603763523`*^9, 3.788405668477664*^9}, {3.790385814889509*^9, 
  3.790385820104271*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.77228212089924*^9, 3.7722822685852947`*^9}, {
  3.772282331266062*^9, 3.7722823318570957`*^9}, {3.772283463545506*^9, 
  3.77228349209052*^9}, {3.772283973641814*^9, 3.772283974411016*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC", "[", 
       RowBox[{"i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
       "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]2", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]2"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k3_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c2_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}], ".", 
        RowBox[{"\[Rho]C", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k3", ",", "a1", ",", "b1", ",", "c1"}], 
         "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq1", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k3_", ",", "k32_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c2", "*", 
      RowBox[{"P1", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k3", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c2"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k32_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq1", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "k32"}], "]"}], "+", 
      RowBox[{"Cq1", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "k32"}], "]"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7722839012647943`*^9, 3.772283977561111*^9}, {
   3.772284048121008*^9, 3.772284054048564*^9}, {3.772284087168202*^9, 
   3.772284088034628*^9}, {3.772284118360495*^9, 3.7722842019765167`*^9}, {
   3.772284253521983*^9, 3.7722843123126793`*^9}, {3.7722843547692547`*^9, 
   3.772284497593048*^9}, {3.7722845668810177`*^9, 3.772284648655345*^9}, {
   3.772284698048359*^9, 3.7722847759044867`*^9}, {3.772285010010169*^9, 
   3.772285045658825*^9}, {3.7722850761293716`*^9, 3.7722850960199213`*^9}, 
   3.772285178523724*^9, {3.77236447619662*^9, 3.7723645043822403`*^9}, {
   3.772364551064343*^9, 3.772364556213101*^9}, {3.772364601277505*^9, 
   3.772364614932653*^9}, {3.772364721701075*^9, 3.772364745892701*^9}, {
   3.7723654726780863`*^9, 3.7723656214619417`*^9}, 3.772365682158434*^9, {
   3.772368149215102*^9, 3.772368149564683*^9}, {3.772368990526123*^9, 
   3.772369009502626*^9}, {3.772369152968285*^9, 3.772369191208866*^9}, {
   3.772369270426837*^9, 3.7723692825048933`*^9}, {3.772370920799974*^9, 
   3.772370991798862*^9}, {3.772371046990074*^9, 3.772371068092149*^9}, {
   3.772371621786759*^9, 3.772371624106864*^9}, {3.772371947539008*^9, 
   3.772372102130176*^9}, {3.772376543946974*^9, 3.772376565306912*^9}, {
   3.772376674553438*^9, 3.772376690540468*^9}, {3.77237673847546*^9, 
   3.7723767616748953`*^9}, {3.772376828676401*^9, 3.772376910123201*^9}, {
   3.772436966608683*^9, 3.772436991934647*^9}, {3.772437088384615*^9, 
   3.7724371779271383`*^9}, {3.772437263415668*^9, 3.772437271287508*^9}, {
   3.772438707944784*^9, 3.7724389669530373`*^9}, {3.7724389991700687`*^9, 
   3.7724390125135593`*^9}, {3.7724393895462713`*^9, 3.772439398305973*^9}, {
   3.772439675603006*^9, 3.7724397014515657`*^9}, {3.7724397922900877`*^9, 
   3.772439795707053*^9}, 3.77244017684429*^9, {3.772440377162609*^9, 
   3.7724404581790733`*^9}, {3.7724455967282953`*^9, 3.772445640254805*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Lambda]2", "=", "1"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]1", "=", ".464"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]1", "[", "0", "]"}], "=", "2.19856"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]1", "[", "1", "]"}], "=", "0.417031"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]1", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]2", "[", "0", "]"}], "=", "0.41703"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]2", "[", "1", "]"}], "=", "0.943"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]2", "[", "1", "]"}], "=", "\[Pi]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "2.19856"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "0.417"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "2.19856"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "0.417"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cqa", "[", 
       RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
      RowBox[{"Cqa", "[", 
       RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
      RowBox[{"Cqa", "[", 
       RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
      RowBox[{"Cqa", "[", 
       RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", 
    RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.772364525316143*^9, 3.77236452609298*^9}, {
   3.772372396937315*^9, 3.772372415001383*^9}, 3.77237311796066*^9, {
   3.7723737007755613`*^9, 3.7723737188240967`*^9}, {3.7723737525118113`*^9, 
   3.772373756559065*^9}, {3.772374940164611*^9, 3.7723749406118917`*^9}, {
   3.772375107172915*^9, 3.772375113276558*^9}, {3.772375341936801*^9, 
   3.772375342736553*^9}, {3.772375380288937*^9, 3.772375390719099*^9}, {
   3.772375893528729*^9, 3.7723759026335583`*^9}, {3.772376296394185*^9, 
   3.7723763437138243`*^9}, {3.7723763970667267`*^9, 3.772376404770289*^9}, {
   3.772377406392981*^9, 3.772377416216053*^9}, {3.772377466377136*^9, 
   3.772377490000616*^9}, {3.772377650720331*^9, 3.772377652744091*^9}, {
   3.7724405909234343`*^9, 3.772440591298102*^9}, {3.7724463631857977`*^9, 
   3.772446363385128*^9}, {3.772446401881209*^9, 3.7724464062492533`*^9}, {
   3.772446499817471*^9, 3.772446502425023*^9}, {3.772794315281715*^9, 
   3.772794316648402*^9}, {3.788405127987102*^9, 3.788405166488482*^9}, {
   3.788405466461115*^9, 3.7884054733897448`*^9}, {3.788405510697042*^9, 
   3.788405537658779*^9}, {3.788406040239809*^9, 3.788406044805222*^9}, {
   3.78841916147596*^9, 3.788419172812961*^9}, {3.790385865196827*^9, 
   3.790385880293264*^9}, {3.790385995922737*^9, 3.790386005712973*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.8796948295078275`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]2"}]}]], "Output",
 CellChangeTimes->{3.7884051681544847`*^9, 3.788405381680544*^9, 
  3.7884054807098293`*^9, 3.7884055466966*^9, 3.7884060492807426`*^9, 
  3.788419178137855*^9, 3.790385885368998*^9, 3.79038600706754*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "2.87969"}]], "Input",
 CellChangeTimes->{{3.790386017706513*^9, 3.7903860271118317`*^9}}],

Cell[BoxData["0.4910992372002178`"], "Output",
 CellChangeTimes->{3.7903860277705383`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.`", "\[VeryThinSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.7867656786263526`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "\[Lambda]2", 
       " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]32", "[", "0", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1.4364474476305071`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "\[Lambda]2", 
       " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]32", "[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1.0564882086664937`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "\[Lambda]2", 
       " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]32", "[", "0", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]32", "[", "0", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.6152345787038673`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", "\[Lambda]2", 
       " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]32", "[", "1", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]32", "[", "1", "]"}], "]"}]}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]32", "[", "0", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]32", "[", "0", "]"}], "\[LessEqual]", 
      RowBox[{"2", "\[Pi]"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Theta]32", "[", "1", "]"}], "\[LessEqual]", "\[Pi]"}], ",", 
     RowBox[{"0", "\[LessEqual]", 
      RowBox[{"\[Phi]32", "[", "1", "]"}], "\[LessEqual]", 
      RowBox[{"2", "\[Pi]"}]}], ",", 
     RowBox[{"0", "\[LessEqual]", "\[Lambda]2", "\[LessEqual]", "1"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]32", "[", "0", "]"}], ",", 
     RowBox[{"\[Phi]32", "[", "0", "]"}], ",", 
     RowBox[{"\[Theta]32", "[", "1", "]"}], ",", 
     RowBox[{"\[Phi]32", "[", "1", "]"}], ",", "\[Lambda]2"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.772372354097027*^9, 3.77237236233624*^9}, {
   3.772372443194384*^9, 3.772372474312592*^9}, {3.7723731354007673`*^9, 
   3.772373151055459*^9}, {3.7723732098316793`*^9, 3.772373229199974*^9}, {
   3.772375054196787*^9, 3.772375060108384*^9}, {3.772375288094521*^9, 
   3.77237529634181*^9}, 3.772793923819684*^9, 3.788405205384755*^9, 
   3.78840606547785*^9, {3.790385917038891*^9, 3.790385979888339*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2.879913138949894`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]32", "[", "0", "]"}], "\[Rule]", 
      "2.2108961308158372`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]32", "[", "0", "]"}], "\[Rule]", "6.282532032978326`"}], 
     ",", 
     RowBox[{
      RowBox[{"\[Theta]32", "[", "1", "]"}], "\[Rule]", 
      "0.4046648953449526`"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]32", "[", "1", "]"}], "\[Rule]", 
      "0.002236134732724958`"}], ",", 
     RowBox[{"\[Lambda]2", "\[Rule]", "0.9999999949203163`"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.772372229656629*^9, 3.772372427272305*^9, 3.772372475519308*^9, 
   3.7723732602921667`*^9, 3.772373482983139*^9, {3.772373704251555*^9, 
   3.772373721980921*^9}, 3.772373761250647*^9, 3.772374945591619*^9, 
   3.772375079772977*^9, 3.7723752442666407`*^9, {3.772375334703947*^9, 
   3.772375394957336*^9}, 3.772375957103389*^9, 3.772376359270447*^9, 
   3.772376919121994*^9, 3.77237709215241*^9, 3.772436894880805*^9, 
   3.7724370010461493`*^9, 3.772437194065012*^9, {3.772438480686203*^9, 
   3.772438502038825*^9}, 3.7724390377592154`*^9, 3.772441650660499*^9, {
   3.772444252492063*^9, 3.772444281576799*^9}, 3.772444872222376*^9, {
   3.7724450183494797`*^9, 3.7724450242489843`*^9}, 3.7724461857781763`*^9, 
   3.772446304043872*^9, 3.772446369438727*^9, 3.772446440792738*^9, 
   3.772793926006649*^9, 3.788405208098178*^9, 3.788405483973918*^9, 
   3.788405561865431*^9, 3.7884060681636963`*^9, {3.790385934186858*^9, 
   3.790385981155979*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "3", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7724466727999983`*^9, 3.772446673256187*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"1"},
      {"0"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0"},
      {"1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]w", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]1"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "+", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      FractionBox[
       RowBox[{"1", "-", "\[Lambda]2"}], "2"], "]"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]w", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.772447942366523*^9, 3.772448169071465*^9}, {
  3.772496126716131*^9, 3.772496322458699*^9}, {3.7903860490101757`*^9, 
  3.7903860579803*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]3", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], " ", "+", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]3"}], ")"}], "2"], "\[Sigma]0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}], ".", 
        RowBox[{"\[Rho]C2", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
          "c1", ",", "c2"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq2", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_"}], "]"}],
    ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c3", "*", 
      RowBox[{"P2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c3"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa2", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k33_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "4"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "0", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "0", ",", "1", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "0", ",", "k33"}], "]"}], "+", 
      
      RowBox[{"Cq2", "[", 
       RowBox[{"i1", ",", "j2", ",", "1", ",", "1", ",", "k33"}], "]"}]}], 
     ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7724963808828697`*^9, 3.772496629777803*^9}, {
  3.772496693073895*^9, 3.77249670911351*^9}, {3.77249676127423*^9, 
  3.772496788114046*^9}, {3.772496821035077*^9, 3.772496864937736*^9}, {
  3.77249690957763*^9, 3.772496915905463*^9}, {3.7724969908895807`*^9, 
  3.7724970460413857`*^9}, {3.772497187225646*^9, 3.772497203041*^9}, {
  3.772497266889743*^9, 3.772497283714591*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.49"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".464"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", "2.19856"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", "0.417031"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", "0.41703"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", "0.943"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", "\[Pi]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "2.19856"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "0.417"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "2.19856"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "0.417"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "2.19856"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "0.417"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa2", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa2", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa2", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa2", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]1", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]1", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]1", "[", "1", "]"}], ",", 
   RowBox[{"\[Theta]2", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]2", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]2", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]2", "[", "1", "]"}], ",", 
   RowBox[{"\[Theta]31", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]31", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]31", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]31", "[", "1", "]"}], ",", "\[Lambda]1", ",", 
   RowBox[{"\[Theta]32", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]32", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]32", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]32", "[", "1", "]"}], ",", 
   RowBox[{"\[Theta]33", "[", "0", "]"}], ",", 
   RowBox[{"\[Phi]33", "[", "0", "]"}], ",", 
   RowBox[{"\[Theta]33", "[", "1", "]"}], ",", 
   RowBox[{"\[Phi]33", "[", "1", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7724970987691402`*^9, 3.772497125241206*^9}, {
  3.772497498585828*^9, 3.7724974998972387`*^9}, {3.7884195276740513`*^9, 
  3.788419645143351*^9}, {3.7903861006373453`*^9, 3.7903861628372583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "5.551115123125783`*^-17"}], "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.7132017010285927`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]3"}]}]], "Output",
 CellChangeTimes->{{3.772497294585433*^9, 3.772497313149139*^9}, 
   3.772497506192107*^9, 3.772794930399794*^9, 3.788419587370554*^9, 
   3.7884196459242687`*^9, 3.790386175278575*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "2.7132"}]], "Input",
 CellChangeTimes->{{3.790386180217023*^9, 3.790386186700212*^9}}],

Cell[BoxData["0.5212345431125959`"], "Output",
 CellChangeTimes->{3.7903861876865997`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"CHARLIE", " ", "4", " ", "Come", " ", "in", " ", "picture"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.790386326726796*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]w", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]w", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]ABC3", "[", 
     RowBox[{
     "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", 
      ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
         RowBox[{"zR33", "[", 
          RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
      RowBox[{"\[Rho]ABC2", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
        "c1", ",", "c2"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
         RowBox[{"zR33", "[", 
          RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], ";"}],
   "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"In", "[", "163", "]"}], ":=", 
  RowBox[{
   RowBox[{"SwapParts", "[", 
    RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{"#", ",", "#", ",", 
       RowBox[{"{", 
        RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
    "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.790386326726796*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"z34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]4"}], ")"}], "/", "2"}], " ", 
     "\[Sigma]0"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"P3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z34", "[", 
         RowBox[{"k34", ",", "c4"}], "]"}], ".", 
        RowBox[{"\[Rho]C3", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
          "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_"}], 
    "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c4", "*", 
      RowBox[{"P3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c4"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Cqa3", "[", 
    RowBox[{"i1_", ",", "j2_", ",", "k34_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "8"}], " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Cq3", "[", 
        RowBox[{
        "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34"}], 
        "]"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.7903863671511793`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.52"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.49"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".464"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", "0.417031"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", "0.41703"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", "0.943"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", "\[Pi]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa3", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa3", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa3", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa3", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], "]"}], "\n"}], "Input",\

 CellChangeTimes->{{3.790386262933346*^9, 3.790386443525386*^9}, {
  3.7903864830739803`*^9, 3.7903864938179293`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.516096826712452`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]4"}]}]], "Output",
 CellChangeTimes->{{3.790386475863221*^9, 3.7903864968645144`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "2.5161"}]], "Input",
 CellChangeTimes->{{3.790386498922194*^9, 3.7903865054675207`*^9}}],

Cell[BoxData["0.5620657217014806`"], "Output",
 CellChangeTimes->{3.790386506614255*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"CHARLIE", " ", "5", " ", "Come", " ", "in", " ", "picture"}], 
   "*)"}], "\n"}]], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.7903863753838167`*^9}, {
  3.7903865129328833`*^9, 3.790386548993305*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]0", "=", 
   RowBox[{"PauliMatrix", "[", "0", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]1", "=", 
   RowBox[{"PauliMatrix", "[", "1", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]2", "=", 
   RowBox[{"PauliMatrix", "[", "2", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Sigma]3", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"(", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Rho]w", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], ".", 
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"d", ",", "u", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "d", ",", "u"}], "]"}], "+", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"u", ",", "u", ",", "d"}], "]"}]}], ")"}], "]"}]}], 
     ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"x1", "[", 
    RowBox[{"i1_", ",", "a1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"a1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]1", "[", "i1", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", 
    RowBox[{"j2_", ",", "b1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Sigma]0", "+", 
      RowBox[{"b1", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]1"}], 
         "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]2"}], 
         "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]2", "[", "j2", "]"}], "]"}], "*", "\[Sigma]3"}]}],
         ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR31", "[", 
    RowBox[{"k31_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]1"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]31", "[", "k31", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR32", "[", 
    RowBox[{"k32_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]2"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]32", "[", "k32", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR33", "[", 
    RowBox[{"k33_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]3"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]33", "[", "k33", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zR34", "[", 
    RowBox[{"k34_", ",", "c4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Lambda]4"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]33", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Lambda]4"}], ")"}], "/", "2"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "-", 
         RowBox[{"c4", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]34", "[", "k34", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC1", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "a1_", ",", "b1_", ",", "c1_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}], ".", "\[Rho]w", 
     ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{
        RowBox[{"x1", "[", 
         RowBox[{"i1", ",", "a1"}], "]"}], ",", 
        RowBox[{"y2", "[", 
         RowBox[{"j2", ",", "b1"}], "]"}], ",", 
        RowBox[{"zR31", "[", 
         RowBox[{"k31", ",", "c1"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC2", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "a1_", ",", "b1_", ",", 
     "c1_", ",", "c2_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC1", "[", 
      RowBox[{"i1", ",", "j2", ",", "k31", ",", "a1", ",", "b1", ",", "c1"}], 
      "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR32", "[", 
         RowBox[{"k32", ",", "c2"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]ABC3", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "a1_", ",",
      "b1_", ",", "c1_", ",", "c2_", ",", "c3_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}], ".", 
     RowBox[{"\[Rho]ABC2", "[", 
      RowBox[{
      "i1", ",", "j2", ",", "k31", ",", "k32", ",", "a1", ",", "b1", ",", 
       "c1", ",", "c2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"KroneckerProduct", "[", 
       RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
        RowBox[{"zR33", "[", 
         RowBox[{"k33", ",", "c3"}], "]"}]}], "]"}], ")"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]ABC4", "[", 
     RowBox[{
     "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
      ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", 
      "c4_"}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
         RowBox[{"zR34", "[", 
          RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}], ".", 
      RowBox[{"\[Rho]ABC3", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "a1", ",", 
        "b1", ",", "c1", ",", "c2", ",", "c3"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]0", ",", "\[Sigma]0", ",", 
         RowBox[{"zR34", "[", 
          RowBox[{"k34", ",", "c4"}], "]"}]}], "]"}], ")"}]}], ")"}]}], ";"}],
   "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"SwapParts", "[", 
   RowBox[{"expr_", ",", "pos1_", ",", "pos2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"#", ",", "#", ",", 
      RowBox[{"{", 
       RowBox[{"pos1", ",", "pos2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pos2", ",", "pos1"}], "}"}]}], "]"}], "&"}], "[", "expr", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceSystem", "[", 
    RowBox[{"D_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qubits", "=", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Sort", "[", "s", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TrkM", "=", "D"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "Qubits", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"q", "=", "1"}], ",", 
       RowBox[{"q", "<", "z"}], ",", 
       RowBox[{"q", "++"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "TrkM", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", "TrkM"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{"Qubits", "[", 
          RowBox[{"[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "\[Equal]", "n"}], ",", 
          RowBox[{
           RowBox[{"TrkM", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"p", "=", "1"}], ",", 
             RowBox[{"p", "<", 
              RowBox[{
               RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"p", "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"TrkM", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"TrkM", ",", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                  
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                "]"}]}], ";"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "0"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}]}], ",", 
             RowBox[{"j", "++"}], ",", 
             RowBox[{
              RowBox[{"b", "=", 
               RowBox[{"{", "0", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "+", 
                    RowBox[{
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"n", "-", "j", "-", "1"}], "]"}], "]"}]}], ")"}], 
                    ",", "2"}], "]"}], ")"}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{"b", ",", "i"}], "]"}], "\[Equal]", "0"}]}], ",", 
                  
                  RowBox[{
                   RowBox[{"Permut", "=", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "}"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"c", "=", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", "^", "n"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"perm", "=", 
                    RowBox[{"SwapParts", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"SwapParts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"IntegerDigits", "[", 
                    RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "2", ",", "n"}], "]"}], 
                    ")"}], ",", 
                    RowBox[{"{", "n", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", "-", "j", "-", "1"}], "}"}]}], "]"}], ",", 
                    "2"}], "]"}], "+", "1"}], ")"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"M", "=", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"perm", ",", "perm"}], "]"}], "]"}]}], ";"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"TrkM", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"p", "=", "1"}], ",", 
                RowBox[{"p", "<", 
                 RowBox[{
                  RowBox[{"2", "^", "n"}], "+", "1"}]}], ",", 
                RowBox[{"p", "=", 
                 RowBox[{"p", "+", "2"}]}], ",", 
                RowBox[{
                 RowBox[{"TrkM", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"TrkM", ",", 
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"p", ",", "All"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}], "+", 
                    
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "+", "1"}], ",", "All"}], "]"}], "]"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "^", "n"}], ",", "2"}], "}"}]}], "]"}]}]}], 
                   "]"}]}], ";"}]}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
      "]"}], ";", 
     RowBox[{"Return", "[", "TrkM", "]"}]}], ")"}]}], ";"}], "\n"}], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.7903863753838167`*^9}, {
  3.7903865129328833`*^9, 3.790386548993305*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]BC4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]ABC4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]C4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "a1_", ",", "b1_", ",", "c1_", ",", "c2_", ",", "c3_", ",", "c4_"}],
     "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TraceSystem", "[", 
     RowBox[{
      RowBox[{"\[Rho]BC4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], "]"}], 
      ",", 
      RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"z35", "[", 
    RowBox[{"k35_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Lambda]5", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Sigma]0", "+", 
         RowBox[{"c5", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]1"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]2"}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]35", "[", "k35", "]"}], "]"}], "*", 
             "\[Sigma]3"}]}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Lambda]5"}], ")"}], "/", "2"}], " ", 
     "\[Sigma]0"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"P4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_", ",", "a1_", ",", "b1_", ",", "c5_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"z35", "[", 
         RowBox[{"k35", ",", "c5"}], "]"}], ".", 
        RowBox[{"\[Rho]C4", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "a1", ",", "b1", ",", "c1", ",", "c2", ",", "c3", ",", "c4"}], 
         "]"}]}], "]"}], ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c2", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c4", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Cq4", "[", 
    RowBox[{
    "i1_", ",", "j2_", ",", "k31_", ",", "k32_", ",", "k33_", ",", "k34_", 
     ",", "k35_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"a1", "*", "b1", "*", "c5", "*", 
      RowBox[{"P4", "[", 
       RowBox[{
       "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",", 
        "k35", ",", "a1", ",", "b1", ",", "c5"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c5", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Cqa4", "[", 
     RowBox[{"i1_", ",", "j2_", ",", "k35_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"1", "/", "16"}], " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cq4", "[", 
         RowBox[{
         "i1", ",", "j2", ",", "k31", ",", "k32", ",", "k33", ",", "k34", ",",
           "k35"}], "]"}], ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"k31", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k32", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k33", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k34", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}]}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]4", "=", "0.56"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Lambda]3", "=", "0.52"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]2", "=", "0.49"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", "=", ".464"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]1", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]1", "[", "1", "]"}], "=", "0.417031"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]1", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]2", "[", "0", "]"}], "=", "0.41703"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]2", "[", "1", "]"}], "=", "0.943"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]2", "[", "1", "]"}], "=", "\[Pi]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]31", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]31", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]31", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]32", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]32", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]32", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]33", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]33", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]33", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]34", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]34", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]34", "[", "1", "]"}], "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]35", "[", "0", "]"}], "=", "2.19856"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "0", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"\[Theta]35", "[", "1", "]"}], "=", "0.417"}], ";", 
  RowBox[{
   RowBox[{"\[Phi]35", "[", "1", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cqa4", "[", 
     RowBox[{"0", ",", "0", ",", "1"}], "]"}], "-", 
    RowBox[{"Cqa4", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
    RowBox[{"Cqa4", "[", 
     RowBox[{"0", ",", "1", ",", "0"}], "]"}], "+", 
    RowBox[{"Cqa4", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.790386262933346*^9, 3.7903863753838167`*^9}, {
  3.7903865129328833`*^9, 3.790386623532679*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2.3116328626602396`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   "\[Lambda]5"}]}]], "Output",
 CellChangeTimes->{3.790386634711175*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], "/", "2.31163"}]], "Input",
 CellChangeTimes->{{3.790386638875907*^9, 3.790386645806705*^9}}],

Cell[BoxData["0.611781973054985`"], "Output",
 CellChangeTimes->{3.790386646474576*^9}]
}, Open  ]]
},
WindowSize->{1535, 845},
WindowMargins->{{-10, Automatic}, {Automatic, -7}},
Magnification:>1.25 Inherited,
FrontEndVersion->"8.0 for Linux x86 (64-bit) (February 23, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 209, 4, 36, "Input"],
Cell[770, 26, 151, 3, 36, "Input"],
Cell[CellGroupData[{
Cell[946, 33, 7972, 212, 560, "Input"],
Cell[8921, 247, 22113, 537, 537, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31071, 789, 27338, 600, 815, "Input"],
Cell[58412, 1391, 1512, 42, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59961, 1438, 27551, 663, 1089, "Input"],
Cell[87515, 2103, 395, 6, 36, "Output"],
Cell[87913, 2111, 1404, 35, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89354, 2151, 2851, 82, 313, "Input"],
Cell[92208, 2235, 472, 8, 40, "Output"]
}, Open  ]],
Cell[92695, 2246, 188, 4, 36, "Input"],
Cell[92886, 2252, 6847, 195, 576, "Input"],
Cell[99736, 2449, 9728, 239, 474, "Input"],
Cell[109467, 2690, 5777, 142, 227, "Input"],
Cell[CellGroupData[{
Cell[115269, 2836, 5064, 129, 405, "Input"],
Cell[120336, 2967, 814, 21, 36, "Output"],
Cell[121153, 2990, 500, 12, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121690, 3007, 2118, 51, 60, "Input"],
Cell[123811, 3060, 1496, 31, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125344, 3096, 3563, 103, 451, "Input"],
Cell[128910, 3201, 259, 4, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129206, 3210, 529, 13, 36, "Input"],
Cell[129738, 3225, 209, 3, 36, "Output"]
}, Open  ]],
Cell[129962, 3231, 191, 4, 36, "Input"],
Cell[130156, 3237, 9530, 275, 746, "Input"],
Cell[139689, 3514, 9490, 235, 451, "Input"],
Cell[149182, 3751, 4810, 135, 227, "Input"],
Cell[CellGroupData[{
Cell[154017, 3890, 6693, 180, 658, "Input"],
Cell[160713, 4072, 672, 15, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161422, 4092, 2006, 50, 83, "Input"],
Cell[163431, 4144, 678, 19, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164146, 4168, 163, 4, 42, "Input"],
Cell[164312, 4174, 90, 1, 36, "Output"]
}, Open  ]],
Cell[164417, 4178, 239, 5, 36, "Input"],
Cell[164659, 4185, 12844, 364, 916, "Input"],
Cell[177506, 4551, 9490, 235, 451, "Input"],
Cell[186999, 4788, 6162, 158, 322, "Input"],
Cell[CellGroupData[{
Cell[193186, 4950, 7341, 200, 750, "Input"],
Cell[200530, 5152, 499, 12, 36, "Output"]
}, Open  ]],
Cell[201044, 5167, 189, 4, 36, "Input"],
Cell[201236, 5173, 15960, 451, 1086, "Input"],
Cell[217199, 5626, 9490, 235, 451, "Input"],
Cell[226692, 5863, 7843, 208, 414, "Input"],
Cell[CellGroupData[{
Cell[234560, 6075, 7785, 217, 865, "Input"],
Cell[242348, 6294, 454, 11, 36, "Output"]
}, Open  ]],
Cell[242817, 6308, 237, 5, 36, "Input"],
Cell[243057, 6315, 20304, 544, 1302, "Input"],
Cell[263364, 6861, 9490, 235, 451, "Input"],
Cell[272857, 7098, 10836, 276, 529, "Input"],
Cell[CellGroupData[{
Cell[283718, 7378, 7985, 221, 888, "Input"],
Cell[291706, 7601, 121, 2, 36, "Output"]
}, Open  ]],
Cell[291842, 7606, 296, 4, 36, "Input"],
Cell[292141, 7612, 85, 2, 36, "Input"],
Cell[CellGroupData[{
Cell[292251, 7618, 6833, 193, 560, "Input"],
Cell[299087, 7813, 12110, 291, 307, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[311234, 8109, 15990, 357, 629, "Input"],
Cell[327227, 8468, 1511, 42, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[328775, 8515, 13961, 342, 720, "Input"],
Cell[342739, 8859, 459, 7, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[343235, 8871, 133, 3, 60, "Input"],
Cell[343371, 8876, 90, 1, 36, "Output"]
}, Open  ]],
Cell[343476, 8880, 188, 4, 36, "Input"],
Cell[343667, 8886, 7143, 201, 599, "Input"],
Cell[350813, 9089, 9728, 239, 474, "Input"],
Cell[360544, 9330, 5777, 142, 227, "Input"],
Cell[CellGroupData[{
Cell[366346, 9476, 3928, 102, 474, "Input"],
Cell[370277, 9580, 526, 12, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[370840, 9597, 135, 3, 60, "Input"],
Cell[370978, 9602, 90, 1, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[371105, 9608, 2806, 65, 83, "Input"],
Cell[373914, 9675, 1684, 35, 36, "Output"]
}, Open  ]],
Cell[375613, 9713, 191, 4, 36, "Input"],
Cell[375807, 9719, 9676, 279, 769, "Input"],
Cell[385486, 10000, 9490, 235, 451, "Input"],
Cell[394979, 10237, 4810, 135, 227, "Input"],
Cell[CellGroupData[{
Cell[399814, 10376, 3991, 120, 589, "Input"],
Cell[403808, 10498, 527, 13, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[404372, 10516, 132, 3, 60, "Input"],
Cell[404507, 10521, 90, 1, 36, "Output"]
}, Open  ]],
Cell[404612, 10525, 189, 4, 36, "Input"],
Cell[404804, 10531, 22302, 606, 1088, "Input"],
Cell[427109, 11139, 4668, 134, 198, "Input"],
Cell[CellGroupData[{
Cell[431802, 11277, 2700, 78, 267, "Input"],
Cell[434505, 11357, 388, 10, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[434930, 11372, 134, 3, 60, "Input"],
Cell[435067, 11377, 88, 1, 36, "Output"]
}, Open  ]],
Cell[435170, 11381, 263, 6, 60, "Input"],
Cell[435436, 11389, 25385, 691, 1180, "Input"],
Cell[CellGroupData[{
Cell[460846, 12084, 8128, 233, 566, "Input"],
Cell[468977, 12319, 363, 10, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[469377, 12334, 133, 3, 60, "Input"],
Cell[469513, 12339, 87, 1, 36, "Output"]
}, Open  ]],
Cell[469615, 12343, 265, 6, 60, "Input"],
Cell[469883, 12351, 28508, 778, 1249, "Input"],
Cell[CellGroupData[{
Cell[498416, 13133, 8847, 248, 635, "Input"],
Cell[507266, 13383, 386, 10, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[507689, 13398, 137, 3, 60, "Input"],
Cell[507829, 13403, 90, 1, 36, "Output"]
}, Open  ]],
Cell[507934, 13407, 280, 6, 60, "Input"],
Cell[508217, 13415, 31767, 867, 1387, "Input"],
Cell[CellGroupData[{
Cell[540009, 14286, 10238, 270, 727, "Input"],
Cell[550250, 14558, 365, 10, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[550652, 14573, 133, 3, 60, "Input"],
Cell[550788, 14578, 90, 1, 36, "Output"]
}, Open  ]],
Cell[550893, 14582, 191, 4, 36, "Input"],
Cell[551087, 14588, 34990, 955, 1502, "Input"],
Cell[CellGroupData[{
Cell[586102, 15547, 10393, 288, 796, "Input"],
Cell[596498, 15837, 363, 10, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[596898, 15852, 182, 4, 60, "Input"],
Cell[597083, 15858, 138, 2, 36, "Output"]
}, Open  ]],
Cell[597236, 15863, 305, 6, 60, "Input"],
Cell[597544, 15871, 38380, 1045, 1617, "Input"],
Cell[CellGroupData[{
Cell[635949, 16920, 11740, 307, 819, "Input"],
Cell[647692, 17229, 78, 1, 36, "Output"],
Cell[647773, 17232, 77, 1, 36, "Output"],
Cell[647853, 17235, 354, 10, 36, "Output"],
Cell[648210, 17247, 76, 1, 36, "Output"],
Cell[648289, 17250, 78, 1, 36, "Output"]
}, Open  ]],
Cell[648382, 17254, 347, 5, 36, "Input"],
Cell[648732, 17261, 85, 2, 36, "Input"],
Cell[CellGroupData[{
Cell[648842, 17267, 6833, 193, 560, "Input"],
Cell[655678, 17462, 12110, 291, 307, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[667825, 17758, 15990, 357, 629, "Input"],
Cell[683818, 18117, 1511, 42, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[685366, 18164, 13961, 342, 720, "Input"],
Cell[699330, 18508, 459, 7, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[699826, 18520, 133, 3, 60, "Input"],
Cell[699962, 18525, 90, 1, 36, "Output"]
}, Open  ]],
Cell[700067, 18529, 188, 4, 36, "Input"],
Cell[700258, 18535, 7143, 201, 599, "Input"],
Cell[707404, 18738, 9728, 239, 474, "Input"],
Cell[717135, 18979, 5777, 142, 227, "Input"],
Cell[CellGroupData[{
Cell[722937, 19125, 3928, 102, 474, "Input"],
Cell[726868, 19229, 526, 12, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[727431, 19246, 135, 3, 60, "Input"],
Cell[727569, 19251, 90, 1, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[727696, 19257, 2806, 65, 83, "Input"],
Cell[730505, 19324, 1684, 35, 36, "Output"]
}, Open  ]],
Cell[732204, 19362, 191, 4, 36, "Input"],
Cell[732398, 19368, 9676, 279, 769, "Input"],
Cell[742077, 19649, 9490, 235, 451, "Input"],
Cell[751570, 19886, 4810, 135, 227, "Input"],
Cell[CellGroupData[{
Cell[756405, 20025, 3991, 120, 589, "Input"],
Cell[760399, 20147, 527, 13, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[760963, 20165, 132, 3, 60, "Input"],
Cell[761098, 20170, 90, 1, 36, "Output"]
}, Open  ]],
Cell[761203, 20174, 189, 4, 36, "Input"],
Cell[761395, 20180, 22302, 606, 1088, "Input"],
Cell[783700, 20788, 4668, 134, 198, "Input"],
Cell[CellGroupData[{
Cell[788393, 20926, 2700, 78, 267, "Input"],
Cell[791096, 21006, 388, 10, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[791521, 21021, 134, 3, 60, "Input"],
Cell[791658, 21026, 88, 1, 36, "Output"]
}, Open  ]],
Cell[791761, 21030, 263, 6, 60, "Input"],
Cell[792027, 21038, 25385, 691, 1180, "Input"],
Cell[CellGroupData[{
Cell[817437, 21733, 8128, 233, 566, "Input"],
Cell[825568, 21968, 363, 10, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[825968, 21983, 133, 3, 60, "Input"],
Cell[826104, 21988, 87, 1, 36, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
